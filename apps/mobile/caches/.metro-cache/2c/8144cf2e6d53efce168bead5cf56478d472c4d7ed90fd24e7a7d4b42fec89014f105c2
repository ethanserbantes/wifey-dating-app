{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":36,"index":36}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-navigation/native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":37},"end":{"line":2,"column":58,"index":95}}],"key":"yKhyWCfwa1gXEwEbMKnWHykYbZ4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useMessagesAutoRefresh = useMessagesAutoRefresh;\n  var _react = require(_dependencyMap[0]);\n  var _reactNavigationNative = require(_dependencyMap[1]);\n  function useMessagesAutoRefresh(_ref) {\n    var user = _ref.user,\n      closedRows = _ref.closedRows,\n      loadMatches = _ref.loadMatches,\n      markMatchesSeen = _ref.markMatchesSeen,\n      refreshCredits = _ref.refreshCredits,\n      hasCredits = _ref.hasCredits,\n      attemptRestoreCredits = _ref.attemptRestoreCredits;\n    // Refresh when returning to tab\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) return;\n\n      // Keep these cheap and non-blocking\n      markMatchesSeen(user.id);\n      loadMatches(user.id);\n      refreshCredits(user.id);\n\n      // NEW: if they're locked but they just completed a purchase,\n      // try a one-shot restore+claim here so they don't get stuck.\n      if (!hasCredits && typeof attemptRestoreCredits === \"function\") {\n        attemptRestoreCredits(user.id).catch(() => null);\n      }\n    }, [attemptRestoreCredits, hasCredits, loadMatches, markMatchesSeen, refreshCredits, user?.id]));\n\n    // Auto-refresh if we have terminal rows (so they auto-dismiss)\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) return;\n      var hasTerminal = (closedRows?.length || 0) > 0;\n      if (!hasTerminal) return;\n      var id = setTimeout(() => {\n        loadMatches(user.id);\n      }, 4000);\n      return () => clearTimeout(id);\n    }, [closedRows?.length, loadMatches, user?.id]));\n  }\n});","lineCount":45,"map":[[7,2,4,0,"exports"],[7,9,4,0],[7,10,4,0,"useMessagesAutoRefresh"],[7,32,4,0],[7,35,4,0,"useMessagesAutoRefresh"],[7,57,4,0],[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"require"],[8,22,1,0],[8,23,1,0,"_dependencyMap"],[8,37,1,0],[9,2,2,0],[9,6,2,0,"_reactNavigationNative"],[9,28,2,0],[9,31,2,0,"require"],[9,38,2,0],[9,39,2,0,"_dependencyMap"],[9,53,2,0],[10,2,4,7],[10,11,4,16,"useMessagesAutoRefresh"],[10,33,4,38,"useMessagesAutoRefresh"],[10,34,4,38,"_ref"],[10,38,4,38],[10,40,12,3],[11,4,12,3],[11,8,5,2,"user"],[11,12,5,6],[11,15,5,6,"_ref"],[11,19,5,6],[11,20,5,2,"user"],[11,24,5,6],[12,6,6,2,"closedRows"],[12,16,6,12],[12,19,6,12,"_ref"],[12,23,6,12],[12,24,6,2,"closedRows"],[12,34,6,12],[13,6,7,2,"loadMatches"],[13,17,7,13],[13,20,7,13,"_ref"],[13,24,7,13],[13,25,7,2,"loadMatches"],[13,36,7,13],[14,6,8,2,"markMatchesSeen"],[14,21,8,17],[14,24,8,17,"_ref"],[14,28,8,17],[14,29,8,2,"markMatchesSeen"],[14,44,8,17],[15,6,9,2,"refreshCredits"],[15,20,9,16],[15,23,9,16,"_ref"],[15,27,9,16],[15,28,9,2,"refreshCredits"],[15,42,9,16],[16,6,10,2,"hasCredits"],[16,16,10,12],[16,19,10,12,"_ref"],[16,23,10,12],[16,24,10,2,"hasCredits"],[16,34,10,12],[17,6,11,2,"attemptRestoreCredits"],[17,27,11,23],[17,30,11,23,"_ref"],[17,34,11,23],[17,35,11,2,"attemptRestoreCredits"],[17,56,11,23],[18,4,13,2],[19,4,14,2],[19,8,14,2,"useFocusEffect"],[19,30,14,16],[19,31,14,16,"useFocusEffect"],[19,45,14,16],[19,47,15,4],[19,51,15,4,"useCallback"],[19,57,15,15],[19,58,15,15,"useCallback"],[19,69,15,15],[19,71,15,16],[19,77,15,22],[20,6,16,6],[20,10,16,10],[20,11,16,11,"user"],[20,15,16,15],[20,17,16,17,"id"],[20,19,16,19],[20,21,16,21],[22,6,18,6],[23,6,19,6,"markMatchesSeen"],[23,21,19,21],[23,22,19,22,"user"],[23,26,19,26],[23,27,19,27,"id"],[23,29,19,29],[23,30,19,30],[24,6,20,6,"loadMatches"],[24,17,20,17],[24,18,20,18,"user"],[24,22,20,22],[24,23,20,23,"id"],[24,25,20,25],[24,26,20,26],[25,6,21,6,"refreshCredits"],[25,20,21,20],[25,21,21,21,"user"],[25,25,21,25],[25,26,21,26,"id"],[25,28,21,28],[25,29,21,29],[27,6,23,6],[28,6,24,6],[29,6,25,6],[29,10,25,10],[29,11,25,11,"hasCredits"],[29,21,25,21],[29,25,25,25],[29,32,25,32,"attemptRestoreCredits"],[29,53,25,53],[29,58,25,58],[29,68,25,68],[29,70,25,70],[30,8,26,8,"attemptRestoreCredits"],[30,29,26,29],[30,30,26,30,"user"],[30,34,26,34],[30,35,26,35,"id"],[30,37,26,37],[30,38,26,38],[30,39,26,39,"catch"],[30,44,26,44],[30,45,26,45],[30,51,26,51],[30,55,26,55],[30,56,26,56],[31,6,27,6],[32,4,28,4],[32,5,28,5],[32,7,28,7],[32,8,29,6,"attemptRestoreCredits"],[32,29,29,27],[32,31,30,6,"hasCredits"],[32,41,30,16],[32,43,31,6,"loadMatches"],[32,54,31,17],[32,56,32,6,"markMatchesSeen"],[32,71,32,21],[32,73,33,6,"refreshCredits"],[32,87,33,20],[32,89,34,6,"user"],[32,93,34,10],[32,95,34,12,"id"],[32,97,34,14],[32,98,35,5],[32,99,36,2],[32,100,36,3],[34,4,38,2],[35,4,39,2],[35,8,39,2,"useFocusEffect"],[35,30,39,16],[35,31,39,16,"useFocusEffect"],[35,45,39,16],[35,47,40,4],[35,51,40,4,"useCallback"],[35,57,40,15],[35,58,40,15,"useCallback"],[35,69,40,15],[35,71,40,16],[35,77,40,22],[36,6,41,6],[36,10,41,10],[36,11,41,11,"user"],[36,15,41,15],[36,17,41,17,"id"],[36,19,41,19],[36,21,41,21],[37,6,42,6],[37,10,42,12,"hasTerminal"],[37,21,42,23],[37,24,42,26],[37,25,42,27,"closedRows"],[37,35,42,37],[37,37,42,39,"length"],[37,43,42,45],[37,47,42,49],[37,48,42,50],[37,52,42,54],[37,53,42,55],[38,6,43,6],[38,10,43,10],[38,11,43,11,"hasTerminal"],[38,22,43,22],[38,24,43,24],[39,6,45,6],[39,10,45,12,"id"],[39,12,45,14],[39,15,45,17,"setTimeout"],[39,25,45,27],[39,26,45,28],[39,32,45,34],[40,8,46,8,"loadMatches"],[40,19,46,19],[40,20,46,20,"user"],[40,24,46,24],[40,25,46,25,"id"],[40,27,46,27],[40,28,46,28],[41,6,47,6],[41,7,47,7],[41,9,47,9],[41,13,47,13],[41,14,47,14],[42,6,49,6],[42,13,49,13],[42,19,49,19,"clearTimeout"],[42,31,49,31],[42,32,49,32,"id"],[42,34,49,34],[42,35,49,35],[43,4,50,4],[43,5,50,5],[43,7,50,7],[43,8,50,8,"closedRows"],[43,18,50,18],[43,20,50,20,"length"],[43,26,50,26],[43,28,50,28,"loadMatches"],[43,39,50,39],[43,41,50,41,"user"],[43,45,50,45],[43,47,50,47,"id"],[43,49,50,49],[43,50,50,50],[43,51,51,2],[43,52,51,3],[44,2,52,0],[45,0,52,1],[45,3]],"functionMap":{"names":["<global>","useMessagesAutoRefresh","useFocusEffect$argument_0","attemptRestoreCredits._catch$argument_0","setTimeout$argument_0","<anonymous>"],"mappings":"AAA;OCG;gBCW;6CCW,UD;KDE;gBCY;4BEK;OFE;aGE,sBH;KDC;CDE"},"hasCjsExports":false},"type":"js/module"}]}