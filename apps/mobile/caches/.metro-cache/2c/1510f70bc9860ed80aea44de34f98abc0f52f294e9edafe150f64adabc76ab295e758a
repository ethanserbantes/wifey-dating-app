{"dependencies":[{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useProfileSave = useProfileSave;\n  var _tanstackReactQuery = require(_dependencyMap[0], \"@tanstack/react-query\");\n  var _reactNativeWebDistExportsAlert = require(_dependencyMap[1], \"react-native-web/dist/exports/Alert\");\n  var Alert = _interopDefault(_reactNativeWebDistExportsAlert);\n  function useProfileSave({\n    data,\n    preferences,\n    displayName,\n    age,\n    gender,\n    bio,\n    photos,\n    location,\n    phoneNumber,\n    category,\n    basicHeight,\n    basicJobTitle,\n    basicCompany,\n    basicEducation,\n    basicLookingFor,\n    basicSexuality,\n    interests,\n    prompts,\n    voicePrompt,\n    videos,\n    normalizeVideoUrl\n  }) {\n    const queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    const saveMutation = (0, _tanstackReactQuery.useMutation)({\n      mutationFn: async () => {\n        const userId = data?.user?.id;\n        if (!userId) {\n          throw new Error(\"Missing user id\");\n        }\n        const ageTrimmed = String(age || \"\").trim();\n        const ageNum = ageTrimmed ? Number(ageTrimmed) : null;\n        if (ageNum !== null) {\n          const invalid = !Number.isFinite(ageNum) || ageNum < 18 || ageNum > 99;\n          if (invalid) {\n            throw new Error(\"Please enter a valid age (18â€“99). \");\n          }\n        }\n        const locationTrimmed = String(location || \"\").trim();\n        const genderTrimmed = String(gender || \"\").trim();\n        const phoneTrimmed = String(phoneNumber || \"\").trim();\n        const prevBasics = preferences?.basics && typeof preferences.basics === \"object\" ? preferences.basics : {};\n        const jobTitleTrimmed = String(basicJobTitle || \"\").trim();\n        const companyTrimmed = String(basicCompany || \"\").trim();\n        const workCombined = jobTitleTrimmed && companyTrimmed ? `${jobTitleTrimmed} at ${companyTrimmed}` : jobTitleTrimmed ? jobTitleTrimmed : companyTrimmed ? `Works at ${companyTrimmed}` : \"\";\n        const nextBasics = {\n          ...prevBasics,\n          height: String(basicHeight || \"\").trim(),\n          jobTitle: jobTitleTrimmed,\n          company: companyTrimmed,\n          // keep `work` for backward-compat across older UI\n          work: workCombined,\n          education: String(basicEducation || \"\").trim(),\n          lookingFor: String(basicLookingFor || \"\").trim(),\n          sexuality: String(basicSexuality || \"\").trim()\n        };\n        const nextPreferences = {\n          ...preferences,\n          category: String(category || \"\").trim(),\n          basics: nextBasics,\n          interests,\n          prompts,\n          voicePrompt,\n          // IMPORTANT: store videos as string URLs for compatibility across the app\n          videos: (Array.isArray(videos) ? videos : []).map(normalizeVideoUrl).filter(x => typeof x === \"string\" && x.length > 0).slice(0, 1)\n        };\n        const response = await fetch(\"/api/profile/me\", {\n          method: \"PUT\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            userId,\n            displayName,\n            age: ageNum,\n            gender: genderTrimmed ? genderTrimmed : null,\n            bio,\n            photos,\n            location: locationTrimmed ? locationTrimmed : null,\n            phoneNumber: phoneTrimmed ? phoneTrimmed : null,\n            preferences: nextPreferences\n          })\n        });\n        if (!response.ok) {\n          throw new Error(`When updating /api/profile/me, the response was [${response.status}] ${response.statusText}`);\n        }\n        return response.json();\n      },\n      onSuccess: async () => {\n        await queryClient.invalidateQueries({\n          queryKey: [\"profile\", \"me\"]\n        });\n      },\n      onError: e => {\n        console.error(e);\n        Alert.default.alert(\"Could not save\", e?.message || \"Something went wrong saving your profile.\");\n      }\n    });\n    return saveMutation;\n  }\n});","lineCount":116,"map":[[12,2,4,0,"exports"],[12,9,4,0],[12,10,4,0,"useProfileSave"],[12,24,4,0],[12,27,4,0,"useProfileSave"],[12,41,4,0],[13,2,1,0],[13,6,1,0,"_tanstackReactQuery"],[13,25,1,0],[13,28,1,0,"require"],[13,35,1,0],[13,36,1,0,"_dependencyMap"],[13,50,1,0],[14,2,1,68],[14,6,1,68,"_reactNativeWebDistExportsAlert"],[14,37,1,68],[14,40,1,68,"require"],[14,47,1,68],[14,48,1,68,"_dependencyMap"],[14,62,1,68],[15,2,1,68],[15,6,1,68,"Alert"],[15,11,1,68],[15,14,1,68,"_interopDefault"],[15,29,1,68],[15,30,1,68,"_reactNativeWebDistExportsAlert"],[15,61,1,68],[16,2,4,7],[16,11,4,16,"useProfileSave"],[16,25,4,30,"useProfileSave"],[16,26,4,31],[17,4,5,2,"data"],[17,8,5,6],[18,4,6,2,"preferences"],[18,15,6,13],[19,4,7,2,"displayName"],[19,15,7,13],[20,4,8,2,"age"],[20,7,8,5],[21,4,9,2,"gender"],[21,10,9,8],[22,4,10,2,"bio"],[22,7,10,5],[23,4,11,2,"photos"],[23,10,11,8],[24,4,12,2,"location"],[24,12,12,10],[25,4,13,2,"phoneNumber"],[25,15,13,13],[26,4,14,2,"category"],[26,12,14,10],[27,4,15,2,"basicHeight"],[27,15,15,13],[28,4,16,2,"basicJobTitle"],[28,17,16,15],[29,4,17,2,"basicCompany"],[29,16,17,14],[30,4,18,2,"basicEducation"],[30,18,18,16],[31,4,19,2,"basicLookingFor"],[31,19,19,17],[32,4,20,2,"basicSexuality"],[32,18,20,16],[33,4,21,2,"interests"],[33,13,21,11],[34,4,22,2,"prompts"],[34,11,22,9],[35,4,23,2,"voicePrompt"],[35,15,23,13],[36,4,24,2,"videos"],[36,10,24,8],[37,4,25,2,"normalizeVideoUrl"],[38,2,26,0],[38,3,26,1],[38,5,26,3],[39,4,27,2],[39,10,27,8,"queryClient"],[39,21,27,19],[39,24,27,22],[39,28,27,22,"useQueryClient"],[39,47,27,36],[39,48,27,36,"useQueryClient"],[39,62,27,36],[39,64,27,37],[39,65,27,38],[40,4,29,2],[40,10,29,8,"saveMutation"],[40,22,29,20],[40,25,29,23],[40,29,29,23,"useMutation"],[40,48,29,34],[40,49,29,34,"useMutation"],[40,60,29,34],[40,62,29,35],[41,6,30,4,"mutationFn"],[41,16,30,14],[41,18,30,16],[41,24,30,16,"mutationFn"],[41,25,30,16],[41,30,30,28],[42,8,31,6],[42,14,31,12,"userId"],[42,20,31,18],[42,23,31,21,"data"],[42,27,31,25],[42,29,31,27,"user"],[42,33,31,31],[42,35,31,33,"id"],[42,37,31,35],[43,8,32,6],[43,12,32,10],[43,13,32,11,"userId"],[43,19,32,17],[43,21,32,19],[44,10,33,8],[44,16,33,14],[44,20,33,18,"Error"],[44,25,33,23],[44,26,33,24],[44,43,33,41],[44,44,33,42],[45,8,34,6],[46,8,36,6],[46,14,36,12,"ageTrimmed"],[46,24,36,22],[46,27,36,25,"String"],[46,33,36,31],[46,34,36,32,"age"],[46,37,36,35],[46,41,36,39],[46,43,36,41],[46,44,36,42],[46,45,36,43,"trim"],[46,49,36,47],[46,50,36,48],[46,51,36,49],[47,8,37,6],[47,14,37,12,"ageNum"],[47,20,37,18],[47,23,37,21,"ageTrimmed"],[47,33,37,31],[47,36,37,34,"Number"],[47,42,37,40],[47,43,37,41,"ageTrimmed"],[47,53,37,51],[47,54,37,52],[47,57,37,55],[47,61,37,59],[48,8,38,6],[48,12,38,10,"ageNum"],[48,18,38,16],[48,23,38,21],[48,27,38,25],[48,29,38,27],[49,10,39,8],[49,16,39,14,"invalid"],[49,23,39,21],[49,26,39,24],[49,27,39,25,"Number"],[49,33,39,31],[49,34,39,32,"isFinite"],[49,42,39,40],[49,43,39,41,"ageNum"],[49,49,39,47],[49,50,39,48],[49,54,39,52,"ageNum"],[49,60,39,58],[49,63,39,61],[49,65,39,63],[49,69,39,67,"ageNum"],[49,75,39,73],[49,78,39,76],[49,80,39,78],[50,10,40,8],[50,14,40,12,"invalid"],[50,21,40,19],[50,23,40,21],[51,12,41,10],[51,18,41,16],[51,22,41,20,"Error"],[51,27,41,25],[51,28,41,26],[51,64,41,62],[51,65,41,63],[52,10,42,8],[53,8,43,6],[54,8,45,6],[54,14,45,12,"locationTrimmed"],[54,29,45,27],[54,32,45,30,"String"],[54,38,45,36],[54,39,45,37,"location"],[54,47,45,45],[54,51,45,49],[54,53,45,51],[54,54,45,52],[54,55,45,53,"trim"],[54,59,45,57],[54,60,45,58],[54,61,45,59],[55,8,46,6],[55,14,46,12,"genderTrimmed"],[55,27,46,25],[55,30,46,28,"String"],[55,36,46,34],[55,37,46,35,"gender"],[55,43,46,41],[55,47,46,45],[55,49,46,47],[55,50,46,48],[55,51,46,49,"trim"],[55,55,46,53],[55,56,46,54],[55,57,46,55],[56,8,47,6],[56,14,47,12,"phoneTrimmed"],[56,26,47,24],[56,29,47,27,"String"],[56,35,47,33],[56,36,47,34,"phoneNumber"],[56,47,47,45],[56,51,47,49],[56,53,47,51],[56,54,47,52],[56,55,47,53,"trim"],[56,59,47,57],[56,60,47,58],[56,61,47,59],[57,8,49,6],[57,14,49,12,"prevBasics"],[57,24,49,22],[57,27,50,8,"preferences"],[57,38,50,19],[57,40,50,21,"basics"],[57,46,50,27],[57,50,50,31],[57,57,50,38,"preferences"],[57,68,50,49],[57,69,50,50,"basics"],[57,75,50,56],[57,80,50,61],[57,88,50,69],[57,91,51,12,"preferences"],[57,102,51,23],[57,103,51,24,"basics"],[57,109,51,30],[57,112,52,12],[57,113,52,13],[57,114,52,14],[58,8,54,6],[58,14,54,12,"jobTitleTrimmed"],[58,29,54,27],[58,32,54,30,"String"],[58,38,54,36],[58,39,54,37,"basicJobTitle"],[58,52,54,50],[58,56,54,54],[58,58,54,56],[58,59,54,57],[58,60,54,58,"trim"],[58,64,54,62],[58,65,54,63],[58,66,54,64],[59,8,55,6],[59,14,55,12,"companyTrimmed"],[59,28,55,26],[59,31,55,29,"String"],[59,37,55,35],[59,38,55,36,"basicCompany"],[59,50,55,48],[59,54,55,52],[59,56,55,54],[59,57,55,55],[59,58,55,56,"trim"],[59,62,55,60],[59,63,55,61],[59,64,55,62],[60,8,56,6],[60,14,56,12,"workCombined"],[60,26,56,24],[60,29,57,8,"jobTitleTrimmed"],[60,44,57,23],[60,48,57,27,"companyTrimmed"],[60,62,57,41],[60,65,58,12],[60,68,58,15,"jobTitleTrimmed"],[60,83,58,30],[60,90,58,37,"companyTrimmed"],[60,104,58,51],[60,106,58,53],[60,109,59,12,"jobTitleTrimmed"],[60,124,59,27],[60,127,60,14,"jobTitleTrimmed"],[60,142,60,29],[60,145,61,14,"companyTrimmed"],[60,159,61,28],[60,162,62,16],[60,174,62,28,"companyTrimmed"],[60,188,62,42],[60,190,62,44],[60,193,63,16],[60,195,63,18],[61,8,65,6],[61,14,65,12,"nextBasics"],[61,24,65,22],[61,27,65,25],[62,10,66,8],[62,13,66,11,"prevBasics"],[62,23,66,21],[63,10,67,8,"height"],[63,16,67,14],[63,18,67,16,"String"],[63,24,67,22],[63,25,67,23,"basicHeight"],[63,36,67,34],[63,40,67,38],[63,42,67,40],[63,43,67,41],[63,44,67,42,"trim"],[63,48,67,46],[63,49,67,47],[63,50,67,48],[64,10,68,8,"jobTitle"],[64,18,68,16],[64,20,68,18,"jobTitleTrimmed"],[64,35,68,33],[65,10,69,8,"company"],[65,17,69,15],[65,19,69,17,"companyTrimmed"],[65,33,69,31],[66,10,70,8],[67,10,71,8,"work"],[67,14,71,12],[67,16,71,14,"workCombined"],[67,28,71,26],[68,10,72,8,"education"],[68,19,72,17],[68,21,72,19,"String"],[68,27,72,25],[68,28,72,26,"basicEducation"],[68,42,72,40],[68,46,72,44],[68,48,72,46],[68,49,72,47],[68,50,72,48,"trim"],[68,54,72,52],[68,55,72,53],[68,56,72,54],[69,10,73,8,"lookingFor"],[69,20,73,18],[69,22,73,20,"String"],[69,28,73,26],[69,29,73,27,"basicLookingFor"],[69,44,73,42],[69,48,73,46],[69,50,73,48],[69,51,73,49],[69,52,73,50,"trim"],[69,56,73,54],[69,57,73,55],[69,58,73,56],[70,10,74,8,"sexuality"],[70,19,74,17],[70,21,74,19,"String"],[70,27,74,25],[70,28,74,26,"basicSexuality"],[70,42,74,40],[70,46,74,44],[70,48,74,46],[70,49,74,47],[70,50,74,48,"trim"],[70,54,74,52],[70,55,74,53],[71,8,75,6],[71,9,75,7],[72,8,77,6],[72,14,77,12,"nextPreferences"],[72,29,77,27],[72,32,77,30],[73,10,78,8],[73,13,78,11,"preferences"],[73,24,78,22],[74,10,79,8,"category"],[74,18,79,16],[74,20,79,18,"String"],[74,26,79,24],[74,27,79,25,"category"],[74,35,79,33],[74,39,79,37],[74,41,79,39],[74,42,79,40],[74,43,79,41,"trim"],[74,47,79,45],[74,48,79,46],[74,49,79,47],[75,10,80,8,"basics"],[75,16,80,14],[75,18,80,16,"nextBasics"],[75,28,80,26],[76,10,81,8,"interests"],[76,19,81,17],[77,10,82,8,"prompts"],[77,17,82,15],[78,10,83,8,"voicePrompt"],[78,21,83,19],[79,10,84,8],[80,10,85,8,"videos"],[80,16,85,14],[80,18,85,16],[80,19,85,17,"Array"],[80,24,85,22],[80,25,85,23,"isArray"],[80,32,85,30],[80,33,85,31,"videos"],[80,39,85,37],[80,40,85,38],[80,43,85,41,"videos"],[80,49,85,47],[80,52,85,50],[80,54,85,52],[80,56,86,11,"map"],[80,59,86,14],[80,60,86,15,"normalizeVideoUrl"],[80,77,86,32],[80,78,86,33],[80,79,87,11,"filter"],[80,85,87,17],[80,86,87,19,"x"],[80,87,87,20],[80,91,87,25],[80,98,87,32,"x"],[80,99,87,33],[80,104,87,38],[80,112,87,46],[80,116,87,50,"x"],[80,117,87,51],[80,118,87,52,"length"],[80,124,87,58],[80,127,87,61],[80,128,87,62],[80,129,87,63],[80,130,88,11,"slice"],[80,135,88,16],[80,136,88,17],[80,137,88,18],[80,139,88,20],[80,140,88,21],[81,8,89,6],[81,9,89,7],[82,8,91,6],[82,14,91,12,"response"],[82,22,91,20],[82,25,91,23],[82,31,91,29,"fetch"],[82,36,91,34],[82,37,91,35],[82,54,91,52],[82,56,91,54],[83,10,92,8,"method"],[83,16,92,14],[83,18,92,16],[83,23,92,21],[84,10,93,8,"headers"],[84,17,93,15],[84,19,93,17],[85,12,93,19],[85,26,93,33],[85,28,93,35],[86,10,93,54],[86,11,93,55],[87,10,94,8,"body"],[87,14,94,12],[87,16,94,14,"JSON"],[87,20,94,18],[87,21,94,19,"stringify"],[87,30,94,28],[87,31,94,29],[88,12,95,10,"userId"],[88,18,95,16],[89,12,96,10,"displayName"],[89,23,96,21],[90,12,97,10,"age"],[90,15,97,13],[90,17,97,15,"ageNum"],[90,23,97,21],[91,12,98,10,"gender"],[91,18,98,16],[91,20,98,18,"genderTrimmed"],[91,33,98,31],[91,36,98,34,"genderTrimmed"],[91,49,98,47],[91,52,98,50],[91,56,98,54],[92,12,99,10,"bio"],[92,15,99,13],[93,12,100,10,"photos"],[93,18,100,16],[94,12,101,10,"location"],[94,20,101,18],[94,22,101,20,"locationTrimmed"],[94,37,101,35],[94,40,101,38,"locationTrimmed"],[94,55,101,53],[94,58,101,56],[94,62,101,60],[95,12,102,10,"phoneNumber"],[95,23,102,21],[95,25,102,23,"phoneTrimmed"],[95,37,102,35],[95,40,102,38,"phoneTrimmed"],[95,52,102,50],[95,55,102,53],[95,59,102,57],[96,12,103,10,"preferences"],[96,23,103,21],[96,25,103,23,"nextPreferences"],[97,10,104,8],[97,11,104,9],[98,8,105,6],[98,9,105,7],[98,10,105,8],[99,8,107,6],[99,12,107,10],[99,13,107,11,"response"],[99,21,107,19],[99,22,107,20,"ok"],[99,24,107,22],[99,26,107,24],[100,10,108,8],[100,16,108,14],[100,20,108,18,"Error"],[100,25,108,23],[100,26,109,10],[100,78,109,62,"response"],[100,86,109,70],[100,87,109,71,"status"],[100,93,109,77],[100,98,109,82,"response"],[100,106,109,90],[100,107,109,91,"statusText"],[100,117,109,101],[100,119,110,8],[100,120,110,9],[101,8,111,6],[102,8,112,6],[102,15,112,13,"response"],[102,23,112,21],[102,24,112,22,"json"],[102,28,112,26],[102,29,112,27],[102,30,112,28],[103,6,113,4],[103,7,113,5],[104,6,114,4,"onSuccess"],[104,15,114,13],[104,17,114,15],[104,23,114,15,"onSuccess"],[104,24,114,15],[104,29,114,27],[105,8,115,6],[105,14,115,12,"queryClient"],[105,25,115,23],[105,26,115,24,"invalidateQueries"],[105,43,115,41],[105,44,115,42],[106,10,115,44,"queryKey"],[106,18,115,52],[106,20,115,54],[106,21,115,55],[106,30,115,64],[106,32,115,66],[106,36,115,70],[107,8,115,72],[107,9,115,73],[107,10,115,74],[108,6,116,4],[108,7,116,5],[109,6,117,4,"onError"],[109,13,117,11],[109,15,117,14,"e"],[109,16,117,15],[109,20,117,20],[110,8,118,6,"console"],[110,15,118,13],[110,16,118,14,"error"],[110,21,118,19],[110,22,118,20,"e"],[110,23,118,21],[110,24,118,22],[111,8,119,6,"Alert"],[111,13,119,11],[111,14,119,11,"default"],[111,21,119,11],[111,22,119,12,"alert"],[111,27,119,17],[111,28,120,8],[111,44,120,24],[111,46,121,8,"e"],[111,47,121,9],[111,49,121,11,"message"],[111,56,121,18],[111,60,121,22],[111,103,122,6],[111,104,122,7],[112,6,123,4],[113,4,124,2],[113,5,124,3],[113,6,124,4],[114,4,126,2],[114,11,126,9,"saveMutation"],[114,23,126,21],[115,2,127,0],[116,0,127,1],[116,3]],"functionMap":{"names":["<global>","useProfileSave","useMutation$argument_0.mutationFn","map.filter$argument_0","useMutation$argument_0.onSuccess","useMutation$argument_0.onError"],"mappings":"AAA;OCG;gBC0B;kBCyD,4CD;KD0B;eGC;KHE;aIC;KJM;CDI"},"hasCjsExports":false},"type":"js/module"}]}