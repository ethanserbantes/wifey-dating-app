{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":65,"index":65}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":66},"end":{"line":2,"column":69,"index":135}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":136},"end":{"line":3,"column":55,"index":191}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useConversation = useConversation;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[3], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _tanstackReactQuery = require(_dependencyMap[4], \"@tanstack/react-query\");\n  function useConversation(matchId) {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var _useState = (0, _react.useState)(true),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n    var _useState3 = (0, _react.useState)([]),\n      _useState4 = (0, _slicedToArray.default)(_useState3, 2),\n      messages = _useState4[0],\n      setMessages = _useState4[1];\n    var _useState5 = (0, _react.useState)(null),\n      _useState6 = (0, _slicedToArray.default)(_useState5, 2),\n      user = _useState6[0],\n      setUser = _useState6[1];\n    var _useState7 = (0, _react.useState)(null),\n      _useState8 = (0, _slicedToArray.default)(_useState7, 2),\n      matchInfo = _useState8[0],\n      setMatchInfo = _useState8[1];\n    var _useState9 = (0, _react.useState)(null),\n      _useState0 = (0, _slicedToArray.default)(_useState9, 2),\n      error = _useState0[0],\n      setError = _useState0[1];\n\n    // Prevent \"Too Many Requests\" bursts when multiple parts of the chat\n    // screen trigger a refresh at the same time (tab switches, mutations, etc).\n    var messagesAbortRef = (0, _react.useRef)(null);\n    var messagesInFlightRef = (0, _react.useRef)(false);\n    var lastMessagesFetchAtRef = (0, _react.useRef)(0);\n    var rateLimitedUntilRef = (0, _react.useRef)(0);\n    var markMatchesSeen = (0, _react.useCallback)(/*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator.default)(function* (userId) {\n        try {\n          var resp = yield fetch(\"/api/matches/mark-seen\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              userId\n            })\n          });\n          if (resp.ok) {\n            queryClient.invalidateQueries({\n              queryKey: [\"matchesSummary\", userId]\n            });\n            // NEW: keep the Messages tab dot in sync immediately (donâ€™t wait for polling)\n            queryClient.invalidateQueries({\n              queryKey: [\"matchesForBadge\", userId]\n            });\n          }\n        } catch (e) {\n          console.error(\"Could not mark matches seen\", e);\n        }\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), [queryClient]);\n    var loadMatchInfo = /*#__PURE__*/function () {\n      var _ref2 = (0, _asyncToGenerator.default)(function* (userId) {\n        if (!matchId) return;\n        try {\n          var response = yield fetch(`/api/matches/${matchId}?userId=${userId}`);\n          if (!response.ok) {\n            if (response.status === 404) {\n              setMatchInfo(null);\n              setError(prev => prev || \"This match is no longer available.\");\n              return;\n            }\n\n            // When the backend is sleeping / proxy can't reach it, avoid scary gateway text.\n            if (response.status === 502 || response.status === 503 || response.status === 504) {\n              setMatchInfo(null);\n              setError(prev => prev || \"Server is starting up. Please try again in a moment.\");\n              return;\n            }\n            var text = yield response.text().catch(() => \"\");\n            throw new Error(`When fetching /api/matches/${matchId}, the response was [${response.status}] ${response.statusText} ${text}`);\n          }\n          var data = yield response.json();\n          setMatchInfo(data?.match || null);\n        } catch (err) {\n          console.error(\"Error loading match info:\", err);\n          setMatchInfo(null);\n\n          // Only set the UI error if one isn't already set (messages might set it first).\n          setError(prev => prev || (err?.message ? String(err.message) : \"Could not load match info.\"));\n        }\n      });\n      return function loadMatchInfo(_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var loadMessages = (0, _react.useCallback)(/*#__PURE__*/function () {\n      var _ref3 = (0, _asyncToGenerator.default)(function* (userId) {\n        if (!matchId) return;\n        var now = Date.now();\n        if (now < rateLimitedUntilRef.current) {\n          return;\n        }\n\n        // throttle: avoid accidental double-fetch on mount / tab switch\n        if (now - lastMessagesFetchAtRef.current < 750) {\n          return;\n        }\n\n        // Abort any in-flight request; we only care about the latest.\n        try {\n          if (messagesAbortRef.current) {\n            messagesAbortRef.current.abort();\n          }\n        } catch {\n          // ignore\n        }\n        var controller = new AbortController();\n        messagesAbortRef.current = controller;\n        lastMessagesFetchAtRef.current = now;\n\n        // prevent re-entrancy\n        if (messagesInFlightRef.current) {\n          return;\n        }\n        messagesInFlightRef.current = true;\n        try {\n          var response = yield fetch(`/api/messages/${matchId}?userId=${userId}`, {\n            signal: controller.signal\n          });\n          if (!response.ok) {\n            if (response.status === 429) {\n              // Soft-fail: keep the last good messages on screen and back off.\n              rateLimitedUntilRef.current = Date.now() + 1500;\n              return;\n            }\n            if (response.status === 404) {\n              setMessages([]);\n              setError(\"This chat is no longer available.\");\n              return;\n            }\n            if (response.status === 410) {\n              setMessages([]);\n              setError(\"This match is no longer available.\");\n              return;\n            }\n\n            // When the backend is sleeping / proxy can't reach it, avoid scary gateway text.\n            if (response.status === 502 || response.status === 503 || response.status === 504) {\n              setMessages([]);\n              setError(\"Server is starting up. Please try again in a moment.\");\n              return;\n            }\n            var text = yield response.text().catch(() => \"\");\n            throw new Error(`When fetching /api/messages/${matchId}, the response was [${response.status}] ${response.statusText} ${text}`);\n          }\n          var data = yield response.json();\n          var nextMessages = Array.isArray(data?.messages) ? data.messages : [];\n          setMessages(nextMessages);\n\n          // Existing: keep any cached match summaries fresh\n          queryClient.invalidateQueries({\n            queryKey: [\"matchesSummary\", userId]\n          });\n\n          // /api/messages marks the one-time \"SYSTEM_HINT\" as read.\n          queryClient.invalidateQueries({\n            queryKey: [\"matchesForBadge\", userId]\n          });\n        } catch (err) {\n          if (err?.name === \"AbortError\") {\n            return;\n          }\n          console.error(\"Error loading messages:\", err);\n          setError(err?.message ? String(err.message) : \"Could not load messages for this match.\");\n        } finally {\n          messagesInFlightRef.current = false;\n        }\n      });\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }(), [matchId, queryClient]);\n    var loadUserAndMessages = /*#__PURE__*/function () {\n      var _ref4 = (0, _asyncToGenerator.default)(function* () {\n        if (!matchId) {\n          setLoading(true);\n          return;\n        }\n        try {\n          setError(null);\n          var userData = yield AsyncStorage.default.getItem(\"user\");\n          if (!userData) {\n            setUser(null);\n            setError(\"You need to log in again.\");\n            return;\n          }\n          var parsedUser = JSON.parse(userData);\n          setUser(parsedUser);\n          yield markMatchesSeen(parsedUser.id);\n          yield Promise.all([loadMatchInfo(parsedUser.id), loadMessages(parsedUser.id)]);\n        } catch (err) {\n          console.error(\"Error loading conversation:\", err);\n          setError(err?.message ? String(err.message) : \"Could not load this chat.\");\n        } finally {\n          setLoading(false);\n        }\n      });\n      return function loadUserAndMessages() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n    (0, _react.useEffect)(() => {\n      // IMPORTANT: matchId can arrive slightly after first render in expo-router.\n      // If we only run once, the thread will never load.\n      loadUserAndMessages();\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [matchId]);\n    var reloadMessages = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator.default)(function* () {\n      var uid = user?.id;\n      if (!uid) return;\n      if (!matchId) return;\n      yield loadMessages(uid);\n    }), [loadMessages, matchId, user?.id]);\n    return {\n      loading,\n      error,\n      messages,\n      setMessages,\n      user,\n      matchInfo,\n      reloadMessages\n    };\n  }\n  _s(useConversation, \"renhz+rIyWGZsxQAWGK0ZydEfRg=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient];\n  });\n});","lineCount":257,"map":[[13,2,5,0,"exports"],[13,9,5,0],[13,10,5,0,"useConversation"],[13,25,5,0],[13,28,5,0,"useConversation"],[13,43,5,0],[14,2,251,1],[14,6,251,1,"_babelRuntimeHelpersAsyncToGenerator"],[14,42,251,1],[14,45,251,1,"require"],[14,52,251,1],[14,53,251,1,"_dependencyMap"],[14,67,251,1],[15,2,251,1],[15,6,251,1,"_asyncToGenerator"],[15,23,251,1],[15,26,251,1,"_interopDefault"],[15,41,251,1],[15,42,251,1,"_babelRuntimeHelpersAsyncToGenerator"],[15,78,251,1],[16,2,251,1],[16,6,251,1,"_babelRuntimeHelpersSlicedToArray"],[16,39,251,1],[16,42,251,1,"require"],[16,49,251,1],[16,50,251,1,"_dependencyMap"],[16,64,251,1],[17,2,251,1],[17,6,251,1,"_slicedToArray"],[17,20,251,1],[17,23,251,1,"_interopDefault"],[17,38,251,1],[17,39,251,1,"_babelRuntimeHelpersSlicedToArray"],[17,72,251,1],[18,2,1,0],[18,6,1,0,"_react"],[18,12,1,0],[18,15,1,0,"require"],[18,22,1,0],[18,23,1,0,"_dependencyMap"],[18,37,1,0],[19,2,2,0],[19,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,42,2,0],[19,45,2,0,"require"],[19,52,2,0],[19,53,2,0,"_dependencyMap"],[19,67,2,0],[20,2,2,0],[20,6,2,0,"AsyncStorage"],[20,18,2,0],[20,21,2,0,"_interopDefault"],[20,36,2,0],[20,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[20,73,2,0],[21,2,3,0],[21,6,3,0,"_tanstackReactQuery"],[21,25,3,0],[21,28,3,0,"require"],[21,35,3,0],[21,36,3,0,"_dependencyMap"],[21,50,3,0],[22,2,5,7],[22,11,5,16,"useConversation"],[22,26,5,31,"useConversation"],[22,27,5,32,"matchId"],[22,34,5,39],[22,36,5,41],[23,4,5,41,"_s"],[23,6,5,41],[24,4,6,2],[24,8,6,8,"queryClient"],[24,19,6,19],[24,22,6,22],[24,26,6,22,"useQueryClient"],[24,45,6,36],[24,46,6,36,"useQueryClient"],[24,60,6,36],[24,62,6,37],[24,63,6,38],[25,4,7,2],[25,8,7,2,"_useState"],[25,17,7,2],[25,20,7,32],[25,24,7,32,"useState"],[25,30,7,40],[25,31,7,40,"useState"],[25,39,7,40],[25,41,7,41],[25,45,7,45],[25,46,7,46],[26,6,7,46,"_useState2"],[26,16,7,46],[26,23,7,46,"_slicedToArray"],[26,37,7,46],[26,38,7,46,"default"],[26,45,7,46],[26,47,7,46,"_useState"],[26,56,7,46],[27,6,7,9,"loading"],[27,13,7,16],[27,16,7,16,"_useState2"],[27,26,7,16],[28,6,7,18,"setLoading"],[28,16,7,28],[28,19,7,28,"_useState2"],[28,29,7,28],[29,4,8,2],[29,8,8,2,"_useState3"],[29,18,8,2],[29,21,8,34],[29,25,8,34,"useState"],[29,31,8,42],[29,32,8,42,"useState"],[29,40,8,42],[29,42,8,43],[29,44,8,45],[29,45,8,46],[30,6,8,46,"_useState4"],[30,16,8,46],[30,23,8,46,"_slicedToArray"],[30,37,8,46],[30,38,8,46,"default"],[30,45,8,46],[30,47,8,46,"_useState3"],[30,57,8,46],[31,6,8,9,"messages"],[31,14,8,17],[31,17,8,17,"_useState4"],[31,27,8,17],[32,6,8,19,"setMessages"],[32,17,8,30],[32,20,8,30,"_useState4"],[32,30,8,30],[33,4,9,2],[33,8,9,2,"_useState5"],[33,18,9,2],[33,21,9,26],[33,25,9,26,"useState"],[33,31,9,34],[33,32,9,34,"useState"],[33,40,9,34],[33,42,9,35],[33,46,9,39],[33,47,9,40],[34,6,9,40,"_useState6"],[34,16,9,40],[34,23,9,40,"_slicedToArray"],[34,37,9,40],[34,38,9,40,"default"],[34,45,9,40],[34,47,9,40,"_useState5"],[34,57,9,40],[35,6,9,9,"user"],[35,10,9,13],[35,13,9,13,"_useState6"],[35,23,9,13],[36,6,9,15,"setUser"],[36,13,9,22],[36,16,9,22,"_useState6"],[36,26,9,22],[37,4,10,2],[37,8,10,2,"_useState7"],[37,18,10,2],[37,21,10,36],[37,25,10,36,"useState"],[37,31,10,44],[37,32,10,44,"useState"],[37,40,10,44],[37,42,10,45],[37,46,10,49],[37,47,10,50],[38,6,10,50,"_useState8"],[38,16,10,50],[38,23,10,50,"_slicedToArray"],[38,37,10,50],[38,38,10,50,"default"],[38,45,10,50],[38,47,10,50,"_useState7"],[38,57,10,50],[39,6,10,9,"matchInfo"],[39,15,10,18],[39,18,10,18,"_useState8"],[39,28,10,18],[40,6,10,20,"setMatchInfo"],[40,18,10,32],[40,21,10,32,"_useState8"],[40,31,10,32],[41,4,11,2],[41,8,11,2,"_useState9"],[41,18,11,2],[41,21,11,28],[41,25,11,28,"useState"],[41,31,11,36],[41,32,11,36,"useState"],[41,40,11,36],[41,42,11,37],[41,46,11,41],[41,47,11,42],[42,6,11,42,"_useState0"],[42,16,11,42],[42,23,11,42,"_slicedToArray"],[42,37,11,42],[42,38,11,42,"default"],[42,45,11,42],[42,47,11,42,"_useState9"],[42,57,11,42],[43,6,11,9,"error"],[43,11,11,14],[43,14,11,14,"_useState0"],[43,24,11,14],[44,6,11,16,"setError"],[44,14,11,24],[44,17,11,24,"_useState0"],[44,27,11,24],[46,4,13,2],[47,4,14,2],[48,4,15,2],[48,8,15,8,"messagesAbortRef"],[48,24,15,24],[48,27,15,27],[48,31,15,27,"useRef"],[48,37,15,33],[48,38,15,33,"useRef"],[48,44,15,33],[48,46,15,34],[48,50,15,38],[48,51,15,39],[49,4,16,2],[49,8,16,8,"messagesInFlightRef"],[49,27,16,27],[49,30,16,30],[49,34,16,30,"useRef"],[49,40,16,36],[49,41,16,36,"useRef"],[49,47,16,36],[49,49,16,37],[49,54,16,42],[49,55,16,43],[50,4,17,2],[50,8,17,8,"lastMessagesFetchAtRef"],[50,30,17,30],[50,33,17,33],[50,37,17,33,"useRef"],[50,43,17,39],[50,44,17,39,"useRef"],[50,50,17,39],[50,52,17,40],[50,53,17,41],[50,54,17,42],[51,4,18,2],[51,8,18,8,"rateLimitedUntilRef"],[51,27,18,27],[51,30,18,30],[51,34,18,30,"useRef"],[51,40,18,36],[51,41,18,36,"useRef"],[51,47,18,36],[51,49,18,37],[51,50,18,38],[51,51,18,39],[52,4,20,2],[52,8,20,8,"markMatchesSeen"],[52,23,20,23],[52,26,20,26],[52,30,20,26,"useCallback"],[52,36,20,37],[52,37,20,37,"useCallback"],[52,48,20,37],[53,6,20,37],[53,10,20,37,"_ref"],[53,14,20,37],[53,21,20,37,"_asyncToGenerator"],[53,38,20,37],[53,39,20,37,"default"],[53,46,20,37],[53,48,21,4],[53,59,21,11,"userId"],[53,65,21,17],[53,67,21,22],[54,8,22,6],[54,12,22,10],[55,10,23,8],[55,14,23,14,"resp"],[55,18,23,18],[55,27,23,27,"fetch"],[55,32,23,32],[55,33,23,33],[55,57,23,57],[55,59,23,59],[56,12,24,10,"method"],[56,18,24,16],[56,20,24,18],[56,26,24,24],[57,12,25,10,"headers"],[57,19,25,17],[57,21,25,19],[58,14,25,21],[58,28,25,35],[58,30,25,37],[59,12,25,56],[59,13,25,57],[60,12,26,10,"body"],[60,16,26,14],[60,18,26,16,"JSON"],[60,22,26,20],[60,23,26,21,"stringify"],[60,32,26,30],[60,33,26,31],[61,14,26,33,"userId"],[62,12,26,40],[62,13,26,41],[63,10,27,8],[63,11,27,9],[63,12,27,10],[64,10,28,8],[64,14,28,12,"resp"],[64,18,28,16],[64,19,28,17,"ok"],[64,21,28,19],[64,23,28,21],[65,12,29,10,"queryClient"],[65,23,29,21],[65,24,29,22,"invalidateQueries"],[65,41,29,39],[65,42,29,40],[66,14,30,12,"queryKey"],[66,22,30,20],[66,24,30,22],[66,25,30,23],[66,41,30,39],[66,43,30,41,"userId"],[66,49,30,47],[67,12,31,10],[67,13,31,11],[67,14,31,12],[68,12,32,10],[69,12,33,10,"queryClient"],[69,23,33,21],[69,24,33,22,"invalidateQueries"],[69,41,33,39],[69,42,33,40],[70,14,34,12,"queryKey"],[70,22,34,20],[70,24,34,22],[70,25,34,23],[70,42,34,40],[70,44,34,42,"userId"],[70,50,34,48],[71,12,35,10],[71,13,35,11],[71,14,35,12],[72,10,36,8],[73,8,37,6],[73,9,37,7],[73,10,37,8],[73,17,37,15,"e"],[73,18,37,16],[73,20,37,18],[74,10,38,8,"console"],[74,17,38,15],[74,18,38,16,"error"],[74,23,38,21],[74,24,38,22],[74,53,38,51],[74,55,38,53,"e"],[74,56,38,54],[74,57,38,55],[75,8,39,6],[76,6,40,4],[76,7,40,5],[77,6,40,5],[77,23,40,5,"_x"],[77,25,40,5],[78,8,40,5],[78,15,40,5,"_ref"],[78,19,40,5],[78,20,40,5,"apply"],[78,25,40,5],[78,32,40,5,"arguments"],[78,41,40,5],[79,6,40,5],[80,4,40,5],[80,9,41,4],[80,10,41,5,"queryClient"],[80,21,41,16],[80,22,42,2],[80,23,42,3],[81,4,44,2],[81,8,44,8,"loadMatchInfo"],[81,21,44,21],[82,6,44,21],[82,10,44,21,"_ref2"],[82,15,44,21],[82,22,44,21,"_asyncToGenerator"],[82,39,44,21],[82,40,44,21,"default"],[82,47,44,21],[82,49,44,24],[82,60,44,31,"userId"],[82,66,44,37],[82,68,44,42],[83,8,45,4],[83,12,45,8],[83,13,45,9,"matchId"],[83,20,45,16],[83,22,45,18],[84,8,46,4],[84,12,46,8],[85,10,47,6],[85,14,47,12,"response"],[85,22,47,20],[85,31,47,29,"fetch"],[85,36,47,34],[85,37,47,35],[85,53,47,51,"matchId"],[85,60,47,58],[85,71,47,69,"userId"],[85,77,47,75],[85,79,47,77],[85,80,47,78],[86,10,48,6],[86,14,48,10],[86,15,48,11,"response"],[86,23,48,19],[86,24,48,20,"ok"],[86,26,48,22],[86,28,48,24],[87,12,49,8],[87,16,49,12,"response"],[87,24,49,20],[87,25,49,21,"status"],[87,31,49,27],[87,36,49,32],[87,39,49,35],[87,41,49,37],[88,14,50,10,"setMatchInfo"],[88,26,50,22],[88,27,50,23],[88,31,50,27],[88,32,50,28],[89,14,51,10,"setError"],[89,22,51,18],[89,23,51,20,"prev"],[89,27,51,24],[89,31,51,29,"prev"],[89,35,51,33],[89,39,51,37],[89,75,51,73],[89,76,51,74],[90,14,52,10],[91,12,53,8],[93,12,55,8],[94,12,56,8],[94,16,57,10,"response"],[94,24,57,18],[94,25,57,19,"status"],[94,31,57,25],[94,36,57,30],[94,39,57,33],[94,43,58,10,"response"],[94,51,58,18],[94,52,58,19,"status"],[94,58,58,25],[94,63,58,30],[94,66,58,33],[94,70,59,10,"response"],[94,78,59,18],[94,79,59,19,"status"],[94,85,59,25],[94,90,59,30],[94,93,59,33],[94,95,60,10],[95,14,61,10,"setMatchInfo"],[95,26,61,22],[95,27,61,23],[95,31,61,27],[95,32,61,28],[96,14,62,10,"setError"],[96,22,62,18],[96,23,63,13,"prev"],[96,27,63,17],[96,31,64,14,"prev"],[96,35,64,18],[96,39,64,22],[96,93,65,10],[96,94,65,11],[97,14,66,10],[98,12,67,8],[99,12,69,8],[99,16,69,14,"text"],[99,20,69,18],[99,29,69,27,"response"],[99,37,69,35],[99,38,69,36,"text"],[99,42,69,40],[99,43,69,41],[99,44,69,42],[99,45,69,43,"catch"],[99,50,69,48],[99,51,69,49],[99,57,69,55],[99,59,69,57],[99,60,69,58],[100,12,70,8],[100,18,70,14],[100,22,70,18,"Error"],[100,27,70,23],[100,28,71,10],[100,58,71,40,"matchId"],[100,65,71,47],[100,88,71,70,"response"],[100,96,71,78],[100,97,71,79,"status"],[100,103,71,85],[100,108,71,90,"response"],[100,116,71,98],[100,117,71,99,"statusText"],[100,127,71,109],[100,131,71,113,"text"],[100,135,71,117],[100,137,72,8],[100,138,72,9],[101,10,73,6],[102,10,74,6],[102,14,74,12,"data"],[102,18,74,16],[102,27,74,25,"response"],[102,35,74,33],[102,36,74,34,"json"],[102,40,74,38],[102,41,74,39],[102,42,74,40],[103,10,75,6,"setMatchInfo"],[103,22,75,18],[103,23,75,19,"data"],[103,27,75,23],[103,29,75,25,"match"],[103,34,75,30],[103,38,75,34],[103,42,75,38],[103,43,75,39],[104,8,76,4],[104,9,76,5],[104,10,76,6],[104,17,76,13,"err"],[104,20,76,16],[104,22,76,18],[105,10,77,6,"console"],[105,17,77,13],[105,18,77,14,"error"],[105,23,77,19],[105,24,77,20],[105,51,77,47],[105,53,77,49,"err"],[105,56,77,52],[105,57,77,53],[106,10,78,6,"setMatchInfo"],[106,22,78,18],[106,23,78,19],[106,27,78,23],[106,28,78,24],[108,10,80,6],[109,10,81,6,"setError"],[109,18,81,14],[109,19,82,9,"prev"],[109,23,82,13],[109,27,83,10,"prev"],[109,31,83,14],[109,36,84,11,"err"],[109,39,84,14],[109,41,84,16,"message"],[109,48,84,23],[109,51,84,26,"String"],[109,57,84,32],[109,58,84,33,"err"],[109,61,84,36],[109,62,84,37,"message"],[109,69,84,44],[109,70,84,45],[109,73,84,48],[109,101,84,76],[109,102,85,6],[109,103,85,7],[110,8,86,4],[111,6,87,2],[111,7,87,3],[112,6,87,3],[112,22,44,8,"loadMatchInfo"],[112,35,44,21,"loadMatchInfo"],[112,36,44,21,"_x2"],[112,39,44,21],[113,8,44,21],[113,15,44,21,"_ref2"],[113,20,44,21],[113,21,44,21,"apply"],[113,26,44,21],[113,33,44,21,"arguments"],[113,42,44,21],[114,6,44,21],[115,4,44,21],[115,7,87,3],[116,4,89,2],[116,8,89,8,"loadMessages"],[116,20,89,20],[116,23,89,23],[116,27,89,23,"useCallback"],[116,33,89,34],[116,34,89,34,"useCallback"],[116,45,89,34],[117,6,89,34],[117,10,89,34,"_ref3"],[117,15,89,34],[117,22,89,34,"_asyncToGenerator"],[117,39,89,34],[117,40,89,34,"default"],[117,47,89,34],[117,49,90,4],[117,60,90,11,"userId"],[117,66,90,17],[117,68,90,22],[118,8,91,6],[118,12,91,10],[118,13,91,11,"matchId"],[118,20,91,18],[118,22,91,20],[119,8,93,6],[119,12,93,12,"now"],[119,15,93,15],[119,18,93,18,"Date"],[119,22,93,22],[119,23,93,23,"now"],[119,26,93,26],[119,27,93,27],[119,28,93,28],[120,8,94,6],[120,12,94,10,"now"],[120,15,94,13],[120,18,94,16,"rateLimitedUntilRef"],[120,37,94,35],[120,38,94,36,"current"],[120,45,94,43],[120,47,94,45],[121,10,95,8],[122,8,96,6],[124,8,98,6],[125,8,99,6],[125,12,99,10,"now"],[125,15,99,13],[125,18,99,16,"lastMessagesFetchAtRef"],[125,40,99,38],[125,41,99,39,"current"],[125,48,99,46],[125,51,99,49],[125,54,99,52],[125,56,99,54],[126,10,100,8],[127,8,101,6],[129,8,103,6],[130,8,104,6],[130,12,104,10],[131,10,105,8],[131,14,105,12,"messagesAbortRef"],[131,30,105,28],[131,31,105,29,"current"],[131,38,105,36],[131,40,105,38],[132,12,106,10,"messagesAbortRef"],[132,28,106,26],[132,29,106,27,"current"],[132,36,106,34],[132,37,106,35,"abort"],[132,42,106,40],[132,43,106,41],[132,44,106,42],[133,10,107,8],[134,8,108,6],[134,9,108,7],[134,10,108,8],[134,16,108,14],[135,10,109,8],[136,8,109,8],[137,8,112,6],[137,12,112,12,"controller"],[137,22,112,22],[137,25,112,25],[137,29,112,29,"AbortController"],[137,44,112,44],[137,45,112,45],[137,46,112,46],[138,8,113,6,"messagesAbortRef"],[138,24,113,22],[138,25,113,23,"current"],[138,32,113,30],[138,35,113,33,"controller"],[138,45,113,43],[139,8,114,6,"lastMessagesFetchAtRef"],[139,30,114,28],[139,31,114,29,"current"],[139,38,114,36],[139,41,114,39,"now"],[139,44,114,42],[141,8,116,6],[142,8,117,6],[142,12,117,10,"messagesInFlightRef"],[142,31,117,29],[142,32,117,30,"current"],[142,39,117,37],[142,41,117,39],[143,10,118,8],[144,8,119,6],[145,8,121,6,"messagesInFlightRef"],[145,27,121,25],[145,28,121,26,"current"],[145,35,121,33],[145,38,121,36],[145,42,121,40],[146,8,123,6],[146,12,123,10],[147,10,124,8],[147,14,124,14,"response"],[147,22,124,22],[147,31,124,31,"fetch"],[147,36,124,36],[147,37,125,10],[147,54,125,27,"matchId"],[147,61,125,34],[147,72,125,45,"userId"],[147,78,125,51],[147,80,125,53],[147,82,126,10],[148,12,127,12,"signal"],[148,18,127,18],[148,20,127,20,"controller"],[148,30,127,30],[148,31,127,31,"signal"],[149,10,128,10],[149,11,129,8],[149,12,129,9],[150,10,131,8],[150,14,131,12],[150,15,131,13,"response"],[150,23,131,21],[150,24,131,22,"ok"],[150,26,131,24],[150,28,131,26],[151,12,132,10],[151,16,132,14,"response"],[151,24,132,22],[151,25,132,23,"status"],[151,31,132,29],[151,36,132,34],[151,39,132,37],[151,41,132,39],[152,14,133,12],[153,14,134,12,"rateLimitedUntilRef"],[153,33,134,31],[153,34,134,32,"current"],[153,41,134,39],[153,44,134,42,"Date"],[153,48,134,46],[153,49,134,47,"now"],[153,52,134,50],[153,53,134,51],[153,54,134,52],[153,57,134,55],[153,61,134,59],[154,14,135,12],[155,12,136,10],[156,12,138,10],[156,16,138,14,"response"],[156,24,138,22],[156,25,138,23,"status"],[156,31,138,29],[156,36,138,34],[156,39,138,37],[156,41,138,39],[157,14,139,12,"setMessages"],[157,25,139,23],[157,26,139,24],[157,28,139,26],[157,29,139,27],[158,14,140,12,"setError"],[158,22,140,20],[158,23,140,21],[158,58,140,56],[158,59,140,57],[159,14,141,12],[160,12,142,10],[161,12,144,10],[161,16,144,14,"response"],[161,24,144,22],[161,25,144,23,"status"],[161,31,144,29],[161,36,144,34],[161,39,144,37],[161,41,144,39],[162,14,145,12,"setMessages"],[162,25,145,23],[162,26,145,24],[162,28,145,26],[162,29,145,27],[163,14,146,12,"setError"],[163,22,146,20],[163,23,146,21],[163,59,146,57],[163,60,146,58],[164,14,147,12],[165,12,148,10],[167,12,150,10],[168,12,151,10],[168,16,152,12,"response"],[168,24,152,20],[168,25,152,21,"status"],[168,31,152,27],[168,36,152,32],[168,39,152,35],[168,43,153,12,"response"],[168,51,153,20],[168,52,153,21,"status"],[168,58,153,27],[168,63,153,32],[168,66,153,35],[168,70,154,12,"response"],[168,78,154,20],[168,79,154,21,"status"],[168,85,154,27],[168,90,154,32],[168,93,154,35],[168,95,155,12],[169,14,156,12,"setMessages"],[169,25,156,23],[169,26,156,24],[169,28,156,26],[169,29,156,27],[170,14,157,12,"setError"],[170,22,157,20],[170,23,157,21],[170,77,157,75],[170,78,157,76],[171,14,158,12],[172,12,159,10],[173,12,161,10],[173,16,161,16,"text"],[173,20,161,20],[173,29,161,29,"response"],[173,37,161,37],[173,38,161,38,"text"],[173,42,161,42],[173,43,161,43],[173,44,161,44],[173,45,161,45,"catch"],[173,50,161,50],[173,51,161,51],[173,57,161,57],[173,59,161,59],[173,60,161,60],[174,12,162,10],[174,18,162,16],[174,22,162,20,"Error"],[174,27,162,25],[174,28,163,12],[174,59,163,43,"matchId"],[174,66,163,50],[174,89,163,73,"response"],[174,97,163,81],[174,98,163,82,"status"],[174,104,163,88],[174,109,163,93,"response"],[174,117,163,101],[174,118,163,102,"statusText"],[174,128,163,112],[174,132,163,116,"text"],[174,136,163,120],[174,138,164,10],[174,139,164,11],[175,10,165,8],[176,10,167,8],[176,14,167,14,"data"],[176,18,167,18],[176,27,167,27,"response"],[176,35,167,35],[176,36,167,36,"json"],[176,40,167,40],[176,41,167,41],[176,42,167,42],[177,10,168,8],[177,14,168,14,"nextMessages"],[177,26,168,26],[177,29,168,29,"Array"],[177,34,168,34],[177,35,168,35,"isArray"],[177,42,168,42],[177,43,168,43,"data"],[177,47,168,47],[177,49,168,49,"messages"],[177,57,168,57],[177,58,168,58],[177,61,168,61,"data"],[177,65,168,65],[177,66,168,66,"messages"],[177,74,168,74],[177,77,168,77],[177,79,168,79],[178,10,169,8,"setMessages"],[178,21,169,19],[178,22,169,20,"nextMessages"],[178,34,169,32],[178,35,169,33],[180,10,171,8],[181,10,172,8,"queryClient"],[181,21,172,19],[181,22,172,20,"invalidateQueries"],[181,39,172,37],[181,40,172,38],[182,12,172,40,"queryKey"],[182,20,172,48],[182,22,172,50],[182,23,172,51],[182,39,172,67],[182,41,172,69,"userId"],[182,47,172,75],[183,10,172,77],[183,11,172,78],[183,12,172,79],[185,10,174,8],[186,10,175,8,"queryClient"],[186,21,175,19],[186,22,175,20,"invalidateQueries"],[186,39,175,37],[186,40,175,38],[187,12,176,10,"queryKey"],[187,20,176,18],[187,22,176,20],[187,23,176,21],[187,40,176,38],[187,42,176,40,"userId"],[187,48,176,46],[188,10,177,8],[188,11,177,9],[188,12,177,10],[189,8,178,6],[189,9,178,7],[189,10,178,8],[189,17,178,15,"err"],[189,20,178,18],[189,22,178,20],[190,10,179,8],[190,14,179,12,"err"],[190,17,179,15],[190,19,179,17,"name"],[190,23,179,21],[190,28,179,26],[190,40,179,38],[190,42,179,40],[191,12,180,10],[192,10,181,8],[193,10,183,8,"console"],[193,17,183,15],[193,18,183,16,"error"],[193,23,183,21],[193,24,183,22],[193,49,183,47],[193,51,183,49,"err"],[193,54,183,52],[193,55,183,53],[194,10,184,8,"setError"],[194,18,184,16],[194,19,185,10,"err"],[194,22,185,13],[194,24,185,15,"message"],[194,31,185,22],[194,34,186,14,"String"],[194,40,186,20],[194,41,186,21,"err"],[194,44,186,24],[194,45,186,25,"message"],[194,52,186,32],[194,53,186,33],[194,56,187,14],[194,97,188,8],[194,98,188,9],[195,8,189,6],[195,9,189,7],[195,18,189,16],[196,10,190,8,"messagesInFlightRef"],[196,29,190,27],[196,30,190,28,"current"],[196,37,190,35],[196,40,190,38],[196,45,190,43],[197,8,191,6],[198,6,192,4],[198,7,192,5],[199,6,192,5],[199,23,192,5,"_x3"],[199,26,192,5],[200,8,192,5],[200,15,192,5,"_ref3"],[200,20,192,5],[200,21,192,5,"apply"],[200,26,192,5],[200,33,192,5,"arguments"],[200,42,192,5],[201,6,192,5],[202,4,192,5],[202,9,193,4],[202,10,193,5,"matchId"],[202,17,193,12],[202,19,193,14,"queryClient"],[202,30,193,25],[202,31,194,2],[202,32,194,3],[203,4,196,2],[203,8,196,8,"loadUserAndMessages"],[203,27,196,27],[204,6,196,27],[204,10,196,27,"_ref4"],[204,15,196,27],[204,22,196,27,"_asyncToGenerator"],[204,39,196,27],[204,40,196,27,"default"],[204,47,196,27],[204,49,196,30],[204,62,196,42],[205,8,197,4],[205,12,197,8],[205,13,197,9,"matchId"],[205,20,197,16],[205,22,197,18],[206,10,198,6,"setLoading"],[206,20,198,16],[206,21,198,17],[206,25,198,21],[206,26,198,22],[207,10,199,6],[208,8,200,4],[209,8,202,4],[209,12,202,8],[210,10,203,6,"setError"],[210,18,203,14],[210,19,203,15],[210,23,203,19],[210,24,203,20],[211,10,204,6],[211,14,204,12,"userData"],[211,22,204,20],[211,31,204,29,"AsyncStorage"],[211,43,204,41],[211,44,204,41,"default"],[211,51,204,41],[211,52,204,42,"getItem"],[211,59,204,49],[211,60,204,50],[211,66,204,56],[211,67,204,57],[212,10,205,6],[212,14,205,10],[212,15,205,11,"userData"],[212,23,205,19],[212,25,205,21],[213,12,206,8,"setUser"],[213,19,206,15],[213,20,206,16],[213,24,206,20],[213,25,206,21],[214,12,207,8,"setError"],[214,20,207,16],[214,21,207,17],[214,48,207,44],[214,49,207,45],[215,12,208,8],[216,10,209,6],[217,10,211,6],[217,14,211,12,"parsedUser"],[217,24,211,22],[217,27,211,25,"JSON"],[217,31,211,29],[217,32,211,30,"parse"],[217,37,211,35],[217,38,211,36,"userData"],[217,46,211,44],[217,47,211,45],[218,10,212,6,"setUser"],[218,17,212,13],[218,18,212,14,"parsedUser"],[218,28,212,24],[218,29,212,25],[219,10,213,6],[219,16,213,12,"markMatchesSeen"],[219,31,213,27],[219,32,213,28,"parsedUser"],[219,42,213,38],[219,43,213,39,"id"],[219,45,213,41],[219,46,213,42],[220,10,214,6],[220,16,214,12,"Promise"],[220,23,214,19],[220,24,214,20,"all"],[220,27,214,23],[220,28,214,24],[220,29,215,8,"loadMatchInfo"],[220,42,215,21],[220,43,215,22,"parsedUser"],[220,53,215,32],[220,54,215,33,"id"],[220,56,215,35],[220,57,215,36],[220,59,216,8,"loadMessages"],[220,71,216,20],[220,72,216,21,"parsedUser"],[220,82,216,31],[220,83,216,32,"id"],[220,85,216,34],[220,86,216,35],[220,87,217,7],[220,88,217,8],[221,8,218,4],[221,9,218,5],[221,10,218,6],[221,17,218,13,"err"],[221,20,218,16],[221,22,218,18],[222,10,219,6,"console"],[222,17,219,13],[222,18,219,14,"error"],[222,23,219,19],[222,24,219,20],[222,53,219,49],[222,55,219,51,"err"],[222,58,219,54],[222,59,219,55],[223,10,220,6,"setError"],[223,18,220,14],[223,19,221,8,"err"],[223,22,221,11],[223,24,221,13,"message"],[223,31,221,20],[223,34,221,23,"String"],[223,40,221,29],[223,41,221,30,"err"],[223,44,221,33],[223,45,221,34,"message"],[223,52,221,41],[223,53,221,42],[223,56,221,45],[223,83,222,6],[223,84,222,7],[224,8,223,4],[224,9,223,5],[224,18,223,14],[225,10,224,6,"setLoading"],[225,20,224,16],[225,21,224,17],[225,26,224,22],[225,27,224,23],[226,8,225,4],[227,6,226,2],[227,7,226,3],[228,6,226,3],[228,22,196,8,"loadUserAndMessages"],[228,41,196,27,"loadUserAndMessages"],[228,42,196,27],[229,8,196,27],[229,15,196,27,"_ref4"],[229,20,196,27],[229,21,196,27,"apply"],[229,26,196,27],[229,33,196,27,"arguments"],[229,42,196,27],[230,6,196,27],[231,4,196,27],[231,7,226,3],[232,4,228,2],[232,8,228,2,"useEffect"],[232,14,228,11],[232,15,228,11,"useEffect"],[232,24,228,11],[232,26,228,12],[232,32,228,18],[233,6,229,4],[234,6,230,4],[235,6,231,4,"loadUserAndMessages"],[235,25,231,23],[235,26,231,24],[235,27,231,25],[236,6,232,4],[237,4,233,2],[237,5,233,3],[237,7,233,5],[237,8,233,6,"matchId"],[237,15,233,13],[237,16,233,14],[237,17,233,15],[238,4,235,2],[238,8,235,8,"reloadMessages"],[238,22,235,22],[238,25,235,25],[238,29,235,25,"useCallback"],[238,35,235,36],[238,36,235,36,"useCallback"],[238,47,235,36],[238,66,235,36,"_asyncToGenerator"],[238,83,235,36],[238,84,235,36,"default"],[238,91,235,36],[238,93,235,37],[238,106,235,49],[239,6,236,4],[239,10,236,10,"uid"],[239,13,236,13],[239,16,236,16,"user"],[239,20,236,20],[239,22,236,22,"id"],[239,24,236,24],[240,6,237,4],[240,10,237,8],[240,11,237,9,"uid"],[240,14,237,12],[240,16,237,14],[241,6,238,4],[241,10,238,8],[241,11,238,9,"matchId"],[241,18,238,16],[241,20,238,18],[242,6,239,4],[242,12,239,10,"loadMessages"],[242,24,239,22],[242,25,239,23,"uid"],[242,28,239,26],[242,29,239,27],[243,4,240,2],[243,5,240,3],[243,8,240,5],[243,9,240,6,"loadMessages"],[243,21,240,18],[243,23,240,20,"matchId"],[243,30,240,27],[243,32,240,29,"user"],[243,36,240,33],[243,38,240,35,"id"],[243,40,240,37],[243,41,240,38],[243,42,240,39],[244,4,242,2],[244,11,242,9],[245,6,243,4,"loading"],[245,13,243,11],[246,6,244,4,"error"],[246,11,244,9],[247,6,245,4,"messages"],[247,14,245,12],[248,6,246,4,"setMessages"],[248,17,246,15],[249,6,247,4,"user"],[249,10,247,8],[250,6,248,4,"matchInfo"],[250,15,248,13],[251,6,249,4,"reloadMessages"],[252,4,250,2],[252,5,250,3],[253,2,251,0],[254,2,251,1,"_s"],[254,4,251,1],[254,5,5,16,"useConversation"],[254,20,5,31],[255,4,5,31],[255,12,6,22,"useQueryClient"],[255,31,6,36],[255,32,6,36,"useQueryClient"],[255,46,6,36],[256,2,6,36],[257,0,6,36],[257,3]],"functionMap":{"names":["<global>","useConversation","markMatchesSeen","loadMatchInfo","setError$argument_0","response.text._catch$argument_0","loadMessages","loadUserAndMessages","useEffect$argument_0","reloadMessages"],"mappings":"AAA;OCI;ICgB;KDmB;wBEI;mBCO,sDD;YCY;4EDC;iDEK,QF;QCa;6EDE;GFG;IKG;mDDuE,QC;KL+B;8BMI;GN8B;YOE;GPK;qCQE;GRK;CDW"},"hasCjsExports":false},"type":"js/module"}]}