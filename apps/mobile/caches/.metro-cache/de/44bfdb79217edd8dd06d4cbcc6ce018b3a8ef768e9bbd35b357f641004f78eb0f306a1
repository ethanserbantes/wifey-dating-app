{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"./attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":194,"index":194}}],"key":"UMlNobrmssIvLA9C9D03xjrDrQE=","exportNames":["*"],"imports":1}},{"name":"./validation.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":195},"end":{"line":2,"column":53,"index":248}}],"key":"wSuRSTlWQJOdJulOWcNvpmeJHkU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"extractPromptResultAttributes\", {\n    enumerable: true,\n    get: function () {\n      return extractPromptResultAttributes;\n    }\n  });\n  Object.defineProperty(exports, \"extractToolResultAttributes\", {\n    enumerable: true,\n    get: function () {\n      return extractToolResultAttributes;\n    }\n  });\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[0]);\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _attributesJs = require(_dependencyMap[1]);\n  var _validationJs = require(_dependencyMap[2]);\n  /**\n   * Result extraction functions for MCP server instrumentation\n   *\n   * Handles extraction of attributes from tool and prompt execution results.\n   */\n\n  /**\n   * Build attributes for tool result content items\n   * @param content - Array of content items from tool result\n   * @returns Attributes extracted from each content item including type, text, mime type, URI, and resource info\n   */\n  function buildAllContentItemAttributes(content) {\n    var attributes = {\n      [_attributesJs.MCP_TOOL_RESULT_CONTENT_COUNT_ATTRIBUTE]: content.length\n    };\n    var _loop = function () {\n      if (!(0, _validationJs.isValidContentItem)(item)) {\n        return 1; // continue\n      }\n      var prefix = content.length === 1 ? 'mcp.tool.result' : `mcp.tool.result.${i}`;\n      var safeSet = (key, value) => {\n        if (typeof value === 'string') {\n          attributes[`${prefix}.${key}`] = value;\n        }\n      };\n      safeSet('content_type', item.type);\n      safeSet('mime_type', item.mimeType);\n      safeSet('uri', item.uri);\n      safeSet('name', item.name);\n      if (typeof item.text === 'string') {\n        attributes[`${prefix}.content`] = item.text;\n      }\n      if (typeof item.data === 'string') {\n        attributes[`${prefix}.data_size`] = item.data.length;\n      }\n      var resource = item.resource;\n      if ((0, _validationJs.isValidContentItem)(resource)) {\n        safeSet('resource_uri', resource.uri);\n        safeSet('resource_mime_type', resource.mimeType);\n      }\n    };\n    for (var _ref of content.entries()) {\n      var _ref2 = (0, _slicedToArray.default)(_ref, 2);\n      var i = _ref2[0];\n      var item = _ref2[1];\n      if (_loop()) continue;\n    }\n    return attributes;\n  }\n\n  /**\n   * Extract tool result attributes for span instrumentation\n   * @param result - Tool execution result\n   * @returns Attributes extracted from tool result content\n   */\n  function extractToolResultAttributes(result) {\n    if (!(0, _validationJs.isValidContentItem)(result)) {\n      return {};\n    }\n    var attributes = Array.isArray(result.content) ? buildAllContentItemAttributes(result.content) : {};\n    if (typeof result.isError === 'boolean') {\n      attributes[_attributesJs.MCP_TOOL_RESULT_IS_ERROR_ATTRIBUTE] = result.isError;\n    }\n    return attributes;\n  }\n\n  /**\n   * Extract prompt result attributes for span instrumentation\n   * @param result - Prompt execution result\n   * @returns Attributes extracted from prompt result\n   */\n  function extractPromptResultAttributes(result) {\n    var attributes = {};\n    if (!(0, _validationJs.isValidContentItem)(result)) {\n      return attributes;\n    }\n    if (typeof result.description === 'string') {\n      attributes[_attributesJs.MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE] = result.description;\n    }\n    if (Array.isArray(result.messages)) {\n      attributes[_attributesJs.MCP_PROMPT_RESULT_MESSAGE_COUNT_ATTRIBUTE] = result.messages.length;\n      var messages = result.messages;\n      var _loop2 = function () {\n        if (!(0, _validationJs.isValidContentItem)(message)) {\n          return 1; // continue\n        }\n        var prefix = messages.length === 1 ? 'mcp.prompt.result' : `mcp.prompt.result.${i}`;\n        var safeSet = (key, value) => {\n          if (typeof value === 'string') {\n            var attrName = messages.length === 1 ? `${prefix}.message_${key}` : `${prefix}.${key}`;\n            attributes[attrName] = value;\n          }\n        };\n        safeSet('role', message.role);\n        if ((0, _validationJs.isValidContentItem)(message.content)) {\n          var content = message.content;\n          if (typeof content.text === 'string') {\n            var attrName = messages.length === 1 ? `${prefix}.message_content` : `${prefix}.content`;\n            attributes[attrName] = content.text;\n          }\n        }\n      };\n      for (var _ref3 of messages.entries()) {\n        var _ref4 = (0, _slicedToArray.default)(_ref3, 2);\n        var i = _ref4[0];\n        var message = _ref4[1];\n        if (_loop2()) continue;\n      }\n    }\n    return attributes;\n  }\n});","lineCount":139,"map":[[12,2,124,0,"Object"],[12,8,124,0],[12,9,124,0,"defineProperty"],[12,23,124,0],[12,24,124,0,"exports"],[12,31,124,0],[13,4,124,0,"enumerable"],[13,14,124,0],[14,4,124,0,"get"],[14,7,124,0],[14,18,124,0,"get"],[14,19,124,0],[15,6,124,0],[15,13,124,9,"extractPromptResultAttributes"],[15,42,124,38],[16,4,124,38],[17,2,124,38],[18,2,124,0,"Object"],[18,8,124,0],[18,9,124,0,"defineProperty"],[18,23,124,0],[18,24,124,0,"exports"],[18,31,124,0],[19,4,124,0,"enumerable"],[19,14,124,0],[20,4,124,0,"get"],[20,7,124,0],[20,18,124,0,"get"],[20,19,124,0],[21,6,124,0],[21,13,124,40,"extractToolResultAttributes"],[21,40,124,67],[22,4,124,67],[23,2,124,67],[24,2,124,70],[24,6,124,70,"_babelRuntimeHelpersSlicedToArray"],[24,39,124,70],[24,42,124,70,"require"],[24,49,124,70],[24,50,124,70,"_dependencyMap"],[24,64,124,70],[25,2,124,70],[25,6,124,70,"_slicedToArray"],[25,20,124,70],[25,23,124,70,"_interopDefault"],[25,38,124,70],[25,39,124,70,"_babelRuntimeHelpersSlicedToArray"],[25,72,124,70],[26,2,1,0],[26,6,1,0,"_attributesJs"],[26,19,1,0],[26,22,1,0,"require"],[26,29,1,0],[26,30,1,0,"_dependencyMap"],[26,44,1,0],[27,2,2,0],[27,6,2,0,"_validationJs"],[27,19,2,0],[27,22,2,0,"require"],[27,29,2,0],[27,30,2,0,"_dependencyMap"],[27,44,2,0],[28,2,4,0],[29,0,5,0],[30,0,6,0],[31,0,7,0],[32,0,8,0],[34,2,11,0],[35,0,12,0],[36,0,13,0],[37,0,14,0],[38,0,15,0],[39,2,16,0],[39,11,16,9,"buildAllContentItemAttributes"],[39,40,16,38,"buildAllContentItemAttributes"],[39,41,16,39,"content"],[39,48,16,46],[39,50,16,48],[40,4,17,2],[40,8,17,8,"attributes"],[40,18,17,18],[40,21,17,21],[41,6,18,4],[41,7,18,5,"MCP_TOOL_RESULT_CONTENT_COUNT_ATTRIBUTE"],[41,20,18,44],[41,21,18,44,"MCP_TOOL_RESULT_CONTENT_COUNT_ATTRIBUTE"],[41,60,18,44],[41,63,18,47,"content"],[41,70,18,54],[41,71,18,55,"length"],[42,4,19,2],[42,5,19,3],[43,4,19,4],[43,8,19,4,"_loop"],[43,13,19,4],[43,25,19,4,"_loop"],[43,26,19,4],[43,28,21,45],[44,6,22,4],[44,10,22,8],[44,11,22,9],[44,15,22,9,"isValidContentItem"],[44,28,22,27],[44,29,22,27,"isValidContentItem"],[44,47,22,27],[44,49,22,28,"item"],[44,53,22,32],[44,54,22,33],[44,56,22,35],[45,8,22,35],[46,6,24,4],[47,6,26,4],[47,10,26,10,"prefix"],[47,16,26,16],[47,19,26,19,"content"],[47,26,26,26],[47,27,26,27,"length"],[47,33,26,33],[47,38,26,38],[47,39,26,39],[47,42,26,42],[47,59,26,59],[47,62,26,62],[47,81,26,81,"i"],[47,82,26,82],[47,84,26,84],[48,6,28,4],[48,10,28,10,"safeSet"],[48,17,28,17],[48,20,28,20,"safeSet"],[48,21,28,21,"key"],[48,24,28,24],[48,26,28,26,"value"],[48,31,28,31],[48,36,28,36],[49,8,29,6],[49,12,29,10],[49,19,29,17,"value"],[49,24,29,22],[49,29,29,27],[49,37,29,35],[49,39,29,37],[50,10,30,8,"attributes"],[50,20,30,18],[50,21,30,19],[50,24,30,22,"prefix"],[50,30,30,28],[50,34,30,32,"key"],[50,37,30,35],[50,39,30,37],[50,40,30,38],[50,43,30,41,"value"],[50,48,30,46],[51,8,31,6],[52,6,32,4],[52,7,32,5],[53,6,34,4,"safeSet"],[53,13,34,11],[53,14,34,12],[53,28,34,26],[53,30,34,28,"item"],[53,34,34,32],[53,35,34,33,"type"],[53,39,34,37],[53,40,34,38],[54,6,35,4,"safeSet"],[54,13,35,11],[54,14,35,12],[54,25,35,23],[54,27,35,25,"item"],[54,31,35,29],[54,32,35,30,"mimeType"],[54,40,35,38],[54,41,35,39],[55,6,36,4,"safeSet"],[55,13,36,11],[55,14,36,12],[55,19,36,17],[55,21,36,19,"item"],[55,25,36,23],[55,26,36,24,"uri"],[55,29,36,27],[55,30,36,28],[56,6,37,4,"safeSet"],[56,13,37,11],[56,14,37,12],[56,20,37,18],[56,22,37,20,"item"],[56,26,37,24],[56,27,37,25,"name"],[56,31,37,29],[56,32,37,30],[57,6,39,4],[57,10,39,8],[57,17,39,15,"item"],[57,21,39,19],[57,22,39,20,"text"],[57,26,39,24],[57,31,39,29],[57,39,39,37],[57,41,39,39],[58,8,40,6,"attributes"],[58,18,40,16],[58,19,40,17],[58,22,40,20,"prefix"],[58,28,40,26],[58,38,40,36],[58,39,40,37],[58,42,40,40,"item"],[58,46,40,44],[58,47,40,45,"text"],[58,51,40,49],[59,6,41,4],[60,6,43,4],[60,10,43,8],[60,17,43,15,"item"],[60,21,43,19],[60,22,43,20,"data"],[60,26,43,24],[60,31,43,29],[60,39,43,37],[60,41,43,39],[61,8,44,6,"attributes"],[61,18,44,16],[61,19,44,17],[61,22,44,20,"prefix"],[61,28,44,26],[61,40,44,38],[61,41,44,39],[61,44,44,42,"item"],[61,48,44,46],[61,49,44,47,"data"],[61,53,44,51],[61,54,44,52,"length"],[61,60,44,58],[62,6,45,4],[63,6,47,4],[63,10,47,10,"resource"],[63,18,47,18],[63,21,47,21,"item"],[63,25,47,25],[63,26,47,26,"resource"],[63,34,47,34],[64,6,48,4],[64,10,48,8],[64,14,48,8,"isValidContentItem"],[64,27,48,26],[64,28,48,26,"isValidContentItem"],[64,46,48,26],[64,48,48,27,"resource"],[64,56,48,35],[64,57,48,36],[64,59,48,38],[65,8,49,6,"safeSet"],[65,15,49,13],[65,16,49,14],[65,30,49,28],[65,32,49,30,"resource"],[65,40,49,38],[65,41,49,39,"uri"],[65,44,49,42],[65,45,49,43],[66,8,50,6,"safeSet"],[66,15,50,13],[66,16,50,14],[66,36,50,34],[66,38,50,36,"resource"],[66,46,50,44],[66,47,50,45,"mimeType"],[66,55,50,53],[66,56,50,54],[67,6,51,4],[68,4,52,2],[68,5,52,3],[69,4,21,2],[69,13,21,2,"_ref"],[69,17,21,2],[69,21,21,26,"content"],[69,28,21,33],[69,29,21,34,"entries"],[69,36,21,41],[69,37,21,42],[69,38,21,43],[70,6,21,43],[70,10,21,43,"_ref2"],[70,15,21,43],[70,22,21,43,"_slicedToArray"],[70,36,21,43],[70,37,21,43,"default"],[70,44,21,43],[70,46,21,43,"_ref"],[70,50,21,43],[71,6,21,43],[71,10,21,14,"i"],[71,11,21,15],[71,14,21,15,"_ref2"],[71,19,21,15],[72,6,21,15],[72,10,21,17,"item"],[72,14,21,21],[72,17,21,21,"_ref2"],[72,22,21,21],[73,6,21,21],[73,10,21,21,"_loop"],[73,15,21,21],[73,19,23,6],[74,4,23,15],[75,4,54,2],[75,11,54,9,"attributes"],[75,21,54,19],[76,2,55,0],[78,2,57,0],[79,0,58,0],[80,0,59,0],[81,0,60,0],[82,0,61,0],[83,2,62,0],[83,11,62,9,"extractToolResultAttributes"],[83,38,62,36,"extractToolResultAttributes"],[83,39,62,37,"result"],[83,45,62,43],[83,47,62,45],[84,4,63,2],[84,8,63,6],[84,9,63,7],[84,13,63,7,"isValidContentItem"],[84,26,63,25],[84,27,63,25,"isValidContentItem"],[84,45,63,25],[84,47,63,26,"result"],[84,53,63,32],[84,54,63,33],[84,56,63,35],[85,6,64,4],[85,13,64,11],[85,14,64,12],[85,15,64,13],[86,4,65,2],[87,4,67,2],[87,8,67,8,"attributes"],[87,18,67,18],[87,21,67,21,"Array"],[87,26,67,26],[87,27,67,27,"isArray"],[87,34,67,34],[87,35,67,35,"result"],[87,41,67,41],[87,42,67,42,"content"],[87,49,67,49],[87,50,67,50],[87,53,67,53,"buildAllContentItemAttributes"],[87,82,67,82],[87,83,67,83,"result"],[87,89,67,89],[87,90,67,90,"content"],[87,97,67,97],[87,98,67,98],[87,101,67,101],[87,102,67,102],[87,103,67,103],[88,4,69,2],[88,8,69,6],[88,15,69,13,"result"],[88,21,69,19],[88,22,69,20,"isError"],[88,29,69,27],[88,34,69,32],[88,43,69,41],[88,45,69,43],[89,6,70,4,"attributes"],[89,16,70,14],[89,17,70,15,"MCP_TOOL_RESULT_IS_ERROR_ATTRIBUTE"],[89,30,70,49],[89,31,70,49,"MCP_TOOL_RESULT_IS_ERROR_ATTRIBUTE"],[89,65,70,49],[89,66,70,50],[89,69,70,53,"result"],[89,75,70,59],[89,76,70,60,"isError"],[89,83,70,67],[90,4,71,2],[91,4,73,2],[91,11,73,9,"attributes"],[91,21,73,19],[92,2,74,0],[94,2,76,0],[95,0,77,0],[96,0,78,0],[97,0,79,0],[98,0,80,0],[99,2,81,0],[99,11,81,9,"extractPromptResultAttributes"],[99,40,81,38,"extractPromptResultAttributes"],[99,41,81,39,"result"],[99,47,81,45],[99,49,81,47],[100,4,82,2],[100,8,82,8,"attributes"],[100,18,82,18],[100,21,82,21],[100,22,82,22],[100,23,82,23],[101,4,83,2],[101,8,83,6],[101,9,83,7],[101,13,83,7,"isValidContentItem"],[101,26,83,25],[101,27,83,25,"isValidContentItem"],[101,45,83,25],[101,47,83,26,"result"],[101,53,83,32],[101,54,83,33],[101,56,83,35],[102,6,84,4],[102,13,84,11,"attributes"],[102,23,84,21],[103,4,85,2],[104,4,87,2],[104,8,87,6],[104,15,87,13,"result"],[104,21,87,19],[104,22,87,20,"description"],[104,33,87,31],[104,38,87,36],[104,46,87,44],[104,48,87,46],[105,6,88,4,"attributes"],[105,16,88,14],[105,17,88,15,"MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE"],[105,30,88,54],[105,31,88,54,"MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE"],[105,70,88,54],[105,71,88,55],[105,74,88,58,"result"],[105,80,88,64],[105,81,88,65,"description"],[105,92,88,76],[106,4,89,2],[107,4,91,2],[107,8,91,6,"Array"],[107,13,91,11],[107,14,91,12,"isArray"],[107,21,91,19],[107,22,91,20,"result"],[107,28,91,26],[107,29,91,27,"messages"],[107,37,91,35],[107,38,91,36],[107,40,91,38],[108,6,92,4,"attributes"],[108,16,92,14],[108,17,92,15,"MCP_PROMPT_RESULT_MESSAGE_COUNT_ATTRIBUTE"],[108,30,92,56],[108,31,92,56,"MCP_PROMPT_RESULT_MESSAGE_COUNT_ATTRIBUTE"],[108,72,92,56],[108,73,92,57],[108,76,92,60,"result"],[108,82,92,66],[108,83,92,67,"messages"],[108,91,92,75],[108,92,92,76,"length"],[108,98,92,82],[109,6,94,4],[109,10,94,10,"messages"],[109,18,94,18],[109,21,94,21,"result"],[109,27,94,27],[109,28,94,28,"messages"],[109,36,94,36],[110,6,94,37],[110,10,94,37,"_loop2"],[110,16,94,37],[110,28,94,37,"_loop2"],[110,29,94,37],[110,31,95,51],[111,8,96,6],[111,12,96,10],[111,13,96,11],[111,17,96,11,"isValidContentItem"],[111,30,96,29],[111,31,96,29,"isValidContentItem"],[111,49,96,29],[111,51,96,30,"message"],[111,58,96,37],[111,59,96,38],[111,61,96,40],[112,10,96,40],[113,8,98,6],[114,8,100,6],[114,12,100,12,"prefix"],[114,18,100,18],[114,21,100,21,"messages"],[114,29,100,29],[114,30,100,30,"length"],[114,36,100,36],[114,41,100,41],[114,42,100,42],[114,45,100,45],[114,64,100,64],[114,67,100,67],[114,88,100,88,"i"],[114,89,100,89],[114,91,100,91],[115,8,102,6],[115,12,102,12,"safeSet"],[115,19,102,19],[115,22,102,22,"safeSet"],[115,23,102,23,"key"],[115,26,102,26],[115,28,102,28,"value"],[115,33,102,33],[115,38,102,38],[116,10,103,8],[116,14,103,12],[116,21,103,19,"value"],[116,26,103,24],[116,31,103,29],[116,39,103,37],[116,41,103,39],[117,12,104,10],[117,16,104,16,"attrName"],[117,24,104,24],[117,27,104,27,"messages"],[117,35,104,35],[117,36,104,36,"length"],[117,42,104,42],[117,47,104,47],[117,48,104,48],[117,51,104,51],[117,54,104,54,"prefix"],[117,60,104,60],[117,72,104,72,"key"],[117,75,104,75],[117,77,104,77],[117,80,104,80],[117,83,104,83,"prefix"],[117,89,104,89],[117,93,104,93,"key"],[117,96,104,96],[117,98,104,98],[118,12,105,10,"attributes"],[118,22,105,20],[118,23,105,21,"attrName"],[118,31,105,29],[118,32,105,30],[118,35,105,33,"value"],[118,40,105,38],[119,10,106,8],[120,8,107,6],[120,9,107,7],[121,8,109,6,"safeSet"],[121,15,109,13],[121,16,109,14],[121,22,109,20],[121,24,109,22,"message"],[121,31,109,29],[121,32,109,30,"role"],[121,36,109,34],[121,37,109,35],[122,8,111,6],[122,12,111,10],[122,16,111,10,"isValidContentItem"],[122,29,111,28],[122,30,111,28,"isValidContentItem"],[122,48,111,28],[122,50,111,29,"message"],[122,57,111,36],[122,58,111,37,"content"],[122,65,111,44],[122,66,111,45],[122,68,111,47],[123,10,112,8],[123,14,112,14,"content"],[123,21,112,21],[123,24,112,24,"message"],[123,31,112,31],[123,32,112,32,"content"],[123,39,112,39],[124,10,113,8],[124,14,113,12],[124,21,113,19,"content"],[124,28,113,26],[124,29,113,27,"text"],[124,33,113,31],[124,38,113,36],[124,46,113,44],[124,48,113,46],[125,12,114,10],[125,16,114,16,"attrName"],[125,24,114,24],[125,27,114,27,"messages"],[125,35,114,35],[125,36,114,36,"length"],[125,42,114,42],[125,47,114,47],[125,48,114,48],[125,51,114,51],[125,54,114,54,"prefix"],[125,60,114,60],[125,78,114,78],[125,81,114,81],[125,84,114,84,"prefix"],[125,90,114,90],[125,100,114,100],[126,12,115,10,"attributes"],[126,22,115,20],[126,23,115,21,"attrName"],[126,31,115,29],[126,32,115,30],[126,35,115,33,"content"],[126,42,115,40],[126,43,115,41,"text"],[126,47,115,45],[127,10,116,8],[128,8,117,6],[129,6,118,4],[129,7,118,5],[130,6,95,4],[130,15,95,4,"_ref3"],[130,20,95,4],[130,24,95,31,"messages"],[130,32,95,39],[130,33,95,40,"entries"],[130,40,95,47],[130,41,95,48],[130,42,95,49],[131,8,95,49],[131,12,95,49,"_ref4"],[131,17,95,49],[131,24,95,49,"_slicedToArray"],[131,38,95,49],[131,39,95,49,"default"],[131,46,95,49],[131,48,95,49,"_ref3"],[131,53,95,49],[132,8,95,49],[132,12,95,16,"i"],[132,13,95,17],[132,16,95,17,"_ref4"],[132,21,95,17],[133,8,95,17],[133,12,95,19,"message"],[133,19,95,26],[133,22,95,26,"_ref4"],[133,27,95,26],[134,8,95,26],[134,12,95,26,"_loop2"],[134,18,95,26],[134,22,97,8],[135,6,97,17],[136,4,119,2],[137,4,121,2],[137,11,121,9,"attributes"],[137,21,121,19],[138,2,122,0],[139,0,122,1],[139,3]],"functionMap":{"names":["<global>","buildAllContentItemAttributes","safeSet","extractToolResultAttributes","extractPromptResultAttributes"],"mappings":"AAA;ACe;oBCY;KDI;CDuB;AGO;CHY;AIO;sBFqB;OEK;CJe"},"hasCjsExports":false},"type":"js/module"}]}