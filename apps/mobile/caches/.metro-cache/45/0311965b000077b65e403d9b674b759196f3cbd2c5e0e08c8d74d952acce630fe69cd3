{"dependencies":[{"name":"../../exports.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"EZPmsHt7bn9JJ4Y0grXw/CrOow0=","exportNames":["*"],"imports":1}},{"name":"../spanstatus.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":53,"index":106}}],"key":"oo3PNTzeCFGehsy4DLcuUh8qvTg=","exportNames":["*"],"imports":1}},{"name":"./constants.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":67,"index":174}}],"key":"46QfplZMuoT7/1B4GqMDknw8q/g=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"handleResponseError\", {\n    enumerable: true,\n    get: function () {\n      return handleResponseError;\n    }\n  });\n  Object.defineProperty(exports, \"messagesFromParams\", {\n    enumerable: true,\n    get: function () {\n      return messagesFromParams;\n    }\n  });\n  Object.defineProperty(exports, \"shouldInstrument\", {\n    enumerable: true,\n    get: function () {\n      return shouldInstrument;\n    }\n  });\n  var _exportsJs = require(_dependencyMap[0]);\n  var _spanstatusJs = require(_dependencyMap[1]);\n  var _constantsJs = require(_dependencyMap[2]);\n  /**\n   * Check if a method path should be instrumented\n   */\n  function shouldInstrument(methodPath) {\n    return _constantsJs.ANTHROPIC_AI_INSTRUMENTED_METHODS.includes(methodPath);\n  }\n\n  /**\n   * Capture error information from the response\n   * @see https://docs.anthropic.com/en/api/errors#error-shapes\n   */\n  function handleResponseError(span, response) {\n    if (response.error) {\n      span.setStatus({\n        code: _spanstatusJs.SPAN_STATUS_ERROR,\n        message: response.error.type || 'internal_error'\n      });\n      (0, _exportsJs.captureException)(response.error, {\n        mechanism: {\n          handled: false,\n          type: 'auto.ai.anthropic.anthropic_error'\n        }\n      });\n    }\n  }\n\n  /**\n   * Include the system prompt in the messages list, if available\n   */\n  function messagesFromParams(params) {\n    var system = params.system,\n      messages = params.messages;\n    var systemMessages = typeof system === 'string' ? [{\n      role: 'system',\n      content: params.system\n    }] : [];\n    var userMessages = Array.isArray(messages) ? messages : messages != null ? [messages] : [];\n    return [...systemMessages, ...userMessages];\n  }\n});","lineCount":67,"map":[[7,2,42,0,"Object"],[7,8,42,0],[7,9,42,0,"defineProperty"],[7,23,42,0],[7,24,42,0,"exports"],[7,31,42,0],[8,4,42,0,"enumerable"],[8,14,42,0],[9,4,42,0,"get"],[9,7,42,0],[9,18,42,0,"get"],[9,19,42,0],[10,6,42,0],[10,13,42,9,"handleResponseError"],[10,32,42,28],[11,4,42,28],[12,2,42,28],[13,2,42,0,"Object"],[13,8,42,0],[13,9,42,0,"defineProperty"],[13,23,42,0],[13,24,42,0,"exports"],[13,31,42,0],[14,4,42,0,"enumerable"],[14,14,42,0],[15,4,42,0,"get"],[15,7,42,0],[15,18,42,0,"get"],[15,19,42,0],[16,6,42,0],[16,13,42,30,"messagesFromParams"],[16,31,42,48],[17,4,42,48],[18,2,42,48],[19,2,42,0,"Object"],[19,8,42,0],[19,9,42,0,"defineProperty"],[19,23,42,0],[19,24,42,0,"exports"],[19,31,42,0],[20,4,42,0,"enumerable"],[20,14,42,0],[21,4,42,0,"get"],[21,7,42,0],[21,18,42,0,"get"],[21,19,42,0],[22,6,42,0],[22,13,42,50,"shouldInstrument"],[22,29,42,66],[23,4,42,66],[24,2,42,66],[25,2,1,0],[25,6,1,0,"_exportsJs"],[25,16,1,0],[25,19,1,0,"require"],[25,26,1,0],[25,27,1,0,"_dependencyMap"],[25,41,1,0],[26,2,2,0],[26,6,2,0,"_spanstatusJs"],[26,19,2,0],[26,22,2,0,"require"],[26,29,2,0],[26,30,2,0,"_dependencyMap"],[26,44,2,0],[27,2,3,0],[27,6,3,0,"_constantsJs"],[27,18,3,0],[27,21,3,0,"require"],[27,28,3,0],[27,29,3,0,"_dependencyMap"],[27,43,3,0],[28,2,5,0],[29,0,6,0],[30,0,7,0],[31,2,8,0],[31,11,8,9,"shouldInstrument"],[31,27,8,25,"shouldInstrument"],[31,28,8,26,"methodPath"],[31,38,8,36],[31,40,8,38],[32,4,9,2],[32,11,9,9,"ANTHROPIC_AI_INSTRUMENTED_METHODS"],[32,23,9,42],[32,24,9,42,"ANTHROPIC_AI_INSTRUMENTED_METHODS"],[32,57,9,42],[32,58,9,43,"includes"],[32,66,9,51],[32,67,9,52,"methodPath"],[32,77,9,63],[32,78,9,64],[33,2,10,0],[35,2,12,0],[36,0,13,0],[37,0,14,0],[38,0,15,0],[39,2,16,0],[39,11,16,9,"handleResponseError"],[39,30,16,28,"handleResponseError"],[39,31,16,29,"span"],[39,35,16,33],[39,37,16,35,"response"],[39,45,16,43],[39,47,16,45],[40,4,17,2],[40,8,17,6,"response"],[40,16,17,14],[40,17,17,15,"error"],[40,22,17,20],[40,24,17,22],[41,6,18,4,"span"],[41,10,18,8],[41,11,18,9,"setStatus"],[41,20,18,18],[41,21,18,19],[42,8,18,21,"code"],[42,12,18,25],[42,14,18,27,"SPAN_STATUS_ERROR"],[42,27,18,44],[42,28,18,44,"SPAN_STATUS_ERROR"],[42,45,18,44],[43,8,18,46,"message"],[43,15,18,53],[43,17,18,55,"response"],[43,25,18,63],[43,26,18,64,"error"],[43,31,18,69],[43,32,18,70,"type"],[43,36,18,74],[43,40,18,78],[44,6,18,95],[44,7,18,96],[44,8,18,97],[45,6,20,4],[45,10,20,4,"captureException"],[45,20,20,20],[45,21,20,20,"captureException"],[45,37,20,20],[45,39,20,21,"response"],[45,47,20,29],[45,48,20,30,"error"],[45,53,20,35],[45,55,20,37],[46,8,21,6,"mechanism"],[46,17,21,15],[46,19,21,17],[47,10,22,8,"handled"],[47,17,22,15],[47,19,22,17],[47,24,22,22],[48,10,23,8,"type"],[48,14,23,12],[48,16,23,14],[49,8,24,6],[50,6,25,4],[50,7,25,5],[50,8,25,6],[51,4,26,2],[52,2,27,0],[54,2,29,0],[55,0,30,0],[56,0,31,0],[57,2,32,0],[57,11,32,9,"messagesFromParams"],[57,29,32,27,"messagesFromParams"],[57,30,32,28,"params"],[57,36,32,34],[57,38,32,36],[58,4,33,2],[58,8,33,10,"system"],[58,14,33,16],[58,17,33,31,"params"],[58,23,33,37],[58,24,33,10,"system"],[58,30,33,16],[59,6,33,18,"messages"],[59,14,33,26],[59,17,33,31,"params"],[59,23,33,37],[59,24,33,18,"messages"],[59,32,33,26],[60,4,35,2],[60,8,35,8,"systemMessages"],[60,22,35,22],[60,25,35,25],[60,32,35,32,"system"],[60,38,35,38],[60,43,35,43],[60,51,35,51],[60,54,35,54],[60,55,35,55],[61,6,35,57,"role"],[61,10,35,61],[61,12,35,63],[61,20,35,71],[62,6,35,73,"content"],[62,13,35,80],[62,15,35,82,"params"],[62,21,35,88],[62,22,35,89,"system"],[63,4,35,96],[63,5,35,97],[63,6,35,98],[63,9,35,101],[63,11,35,103],[64,4,37,2],[64,8,37,8,"userMessages"],[64,20,37,20],[64,23,37,23,"Array"],[64,28,37,28],[64,29,37,29,"isArray"],[64,36,37,36],[64,37,37,37,"messages"],[64,45,37,45],[64,46,37,46],[64,49,37,49,"messages"],[64,57,37,57],[64,60,37,60,"messages"],[64,68,37,68],[64,72,37,72],[64,76,37,76],[64,79,37,79],[64,80,37,80,"messages"],[64,88,37,88],[64,89,37,89],[64,92,37,92],[64,94,37,94],[65,4,39,2],[65,11,39,9],[65,12,39,10],[65,15,39,13,"systemMessages"],[65,29,39,27],[65,31,39,29],[65,34,39,32,"userMessages"],[65,46,39,44],[65,47,39,45],[66,2,40,0],[67,0,40,1],[67,3]],"functionMap":{"names":["<global>","shouldInstrument","handleResponseError","messagesFromParams"],"mappings":"AAA;ACO;CDE;AEM;CFW;AGK;CHQ"},"hasCjsExports":false},"type":"js/module"}]}