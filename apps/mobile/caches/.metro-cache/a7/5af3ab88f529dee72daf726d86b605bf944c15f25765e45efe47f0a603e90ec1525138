{"dependencies":[{"name":"../debug-build.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":48,"index":48}}],"key":"rfhktnzi6PvZxT1xtyHWbBktN/w=","exportNames":["*"],"imports":1}},{"name":"./debug-logger.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":49},"end":{"line":2,"column":42,"index":91}}],"key":"VSeoyyJzODV++e70LcO1jVtvSwg=","exportNames":["*"],"imports":1}},{"name":"./string.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":92},"end":{"line":3,"column":48,"index":140}}],"key":"4SgKKWBRWk0zxI3arZcISee7pnU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"reparentChildSpans\", {\n    enumerable: true,\n    get: function () {\n      return reparentChildSpans;\n    }\n  });\n  Object.defineProperty(exports, \"shouldIgnoreSpan\", {\n    enumerable: true,\n    get: function () {\n      return shouldIgnoreSpan;\n    }\n  });\n  var _debugBuildJs = require(_dependencyMap[0], \"../debug-build.js\");\n  var _debugLoggerJs = require(_dependencyMap[1], \"./debug-logger.js\");\n  var _stringJs = require(_dependencyMap[2], \"./string.js\");\n  function logIgnoredSpan(droppedSpan) {\n    _debugLoggerJs.debug.log(`Ignoring span ${droppedSpan.op} - ${droppedSpan.description} because it matches \\`ignoreSpans\\`.`);\n  }\n\n  /**\n   * Check if a span should be ignored based on the ignoreSpans configuration.\n   */\n  function shouldIgnoreSpan(span, ignoreSpans) {\n    if (!ignoreSpans?.length || !span.description) {\n      return false;\n    }\n    for (var pattern of ignoreSpans) {\n      if (isStringOrRegExp(pattern)) {\n        if ((0, _stringJs.isMatchingPattern)(span.description, pattern)) {\n          _debugBuildJs.DEBUG_BUILD && logIgnoredSpan(span);\n          return true;\n        }\n        continue;\n      }\n      if (!pattern.name && !pattern.op) {\n        continue;\n      }\n      var nameMatches = pattern.name ? (0, _stringJs.isMatchingPattern)(span.description, pattern.name) : true;\n      var opMatches = pattern.op ? span.op && (0, _stringJs.isMatchingPattern)(span.op, pattern.op) : true;\n\n      // This check here is only correct because we can guarantee that we ran `isMatchingPattern`\n      // for at least one of `nameMatches` and `opMatches`. So in contrary to how this looks,\n      // not both op and name actually have to match. This is the most efficient way to check\n      // for all combinations of name and op patterns.\n      if (nameMatches && opMatches) {\n        _debugBuildJs.DEBUG_BUILD && logIgnoredSpan(span);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Takes a list of spans, and a span that was dropped, and re-parents the child spans of the dropped span to the parent of the dropped span, if possible.\n   * This mutates the spans array in place!\n   */\n  function reparentChildSpans(spans, dropSpan) {\n    var droppedSpanParentId = dropSpan.parent_span_id;\n    var droppedSpanId = dropSpan.span_id;\n\n    // This should generally not happen, as we do not apply this on root spans\n    // but to be safe, we just bail in this case\n    if (!droppedSpanParentId) {\n      return;\n    }\n    for (var span of spans) {\n      if (span.parent_span_id === droppedSpanId) {\n        span.parent_span_id = droppedSpanParentId;\n      }\n    }\n  }\n  function isStringOrRegExp(value) {\n    return typeof value === 'string' || value instanceof RegExp;\n  }\n});","lineCount":81,"map":[[7,2,74,0,"Object"],[7,8,74,0],[7,9,74,0,"defineProperty"],[7,23,74,0],[7,24,74,0,"exports"],[7,31,74,0],[8,4,74,0,"enumerable"],[8,14,74,0],[9,4,74,0,"get"],[9,7,74,0],[9,18,74,0,"get"],[9,19,74,0],[10,6,74,0],[10,13,74,9,"reparentChildSpans"],[10,31,74,27],[11,4,74,27],[12,2,74,27],[13,2,74,0,"Object"],[13,8,74,0],[13,9,74,0,"defineProperty"],[13,23,74,0],[13,24,74,0,"exports"],[13,31,74,0],[14,4,74,0,"enumerable"],[14,14,74,0],[15,4,74,0,"get"],[15,7,74,0],[15,18,74,0,"get"],[15,19,74,0],[16,6,74,0],[16,13,74,29,"shouldIgnoreSpan"],[16,29,74,45],[17,4,74,45],[18,2,74,45],[19,2,1,0],[19,6,1,0,"_debugBuildJs"],[19,19,1,0],[19,22,1,0,"require"],[19,29,1,0],[19,30,1,0,"_dependencyMap"],[19,44,1,0],[20,2,2,0],[20,6,2,0,"_debugLoggerJs"],[20,20,2,0],[20,23,2,0,"require"],[20,30,2,0],[20,31,2,0,"_dependencyMap"],[20,45,2,0],[21,2,3,0],[21,6,3,0,"_stringJs"],[21,15,3,0],[21,18,3,0,"require"],[21,25,3,0],[21,26,3,0,"_dependencyMap"],[21,40,3,0],[22,2,5,0],[22,11,5,9,"logIgnoredSpan"],[22,25,5,23,"logIgnoredSpan"],[22,26,5,24,"droppedSpan"],[22,37,5,35],[22,39,5,37],[23,4,6,2,"debug"],[23,18,6,7],[23,19,6,7,"debug"],[23,24,6,7],[23,25,6,8,"log"],[23,28,6,11],[23,29,6,12],[23,46,6,29,"droppedSpan"],[23,57,6,40],[23,58,6,41,"op"],[23,60,6,43],[23,66,6,49,"droppedSpan"],[23,77,6,60],[23,78,6,61,"description"],[23,89,6,72],[23,127,6,110],[23,128,6,111],[24,2,7,0],[26,2,9,0],[27,0,10,0],[28,0,11,0],[29,2,12,0],[29,11,12,9,"shouldIgnoreSpan"],[29,27,12,25,"shouldIgnoreSpan"],[29,28,13,2,"span"],[29,32,13,6],[29,34,14,2,"ignoreSpans"],[29,45,14,13],[29,47,15,2],[30,4,16,2],[30,8,16,6],[30,9,16,7,"ignoreSpans"],[30,20,16,18],[30,22,16,20,"length"],[30,28,16,26],[30,32,16,30],[30,33,16,31,"span"],[30,37,16,35],[30,38,16,36,"description"],[30,49,16,47],[30,51,16,49],[31,6,17,4],[31,13,17,11],[31,18,17,16],[32,4,18,2],[33,4,20,2],[33,9,20,7],[33,13,20,13,"pattern"],[33,20,20,20],[33,24,20,24,"ignoreSpans"],[33,35,20,35],[33,37,20,37],[34,6,21,4],[34,10,21,8,"isStringOrRegExp"],[34,26,21,24],[34,27,21,25,"pattern"],[34,34,21,32],[34,35,21,33],[34,37,21,35],[35,8,22,6],[35,12,22,10],[35,16,22,10,"isMatchingPattern"],[35,25,22,27],[35,26,22,27,"isMatchingPattern"],[35,43,22,27],[35,45,22,28,"span"],[35,49,22,32],[35,50,22,33,"description"],[35,61,22,44],[35,63,22,46,"pattern"],[35,70,22,53],[35,71,22,54],[35,73,22,56],[36,10,23,8,"DEBUG_BUILD"],[36,23,23,19],[36,24,23,19,"DEBUG_BUILD"],[36,35,23,19],[36,39,23,23,"logIgnoredSpan"],[36,53,23,37],[36,54,23,38,"span"],[36,58,23,42],[36,59,23,43],[37,10,24,8],[37,17,24,15],[37,21,24,19],[38,8,25,6],[39,8,26,6],[40,6,27,4],[41,6,29,4],[41,10,29,8],[41,11,29,9,"pattern"],[41,18,29,16],[41,19,29,17,"name"],[41,23,29,21],[41,27,29,25],[41,28,29,26,"pattern"],[41,35,29,33],[41,36,29,34,"op"],[41,38,29,36],[41,40,29,38],[42,8,30,6],[43,6,31,4],[44,6,33,4],[44,10,33,10,"nameMatches"],[44,21,33,21],[44,24,33,24,"pattern"],[44,31,33,31],[44,32,33,32,"name"],[44,36,33,36],[44,39,33,39],[44,43,33,39,"isMatchingPattern"],[44,52,33,56],[44,53,33,56,"isMatchingPattern"],[44,70,33,56],[44,72,33,57,"span"],[44,76,33,61],[44,77,33,62,"description"],[44,88,33,73],[44,90,33,75,"pattern"],[44,97,33,82],[44,98,33,83,"name"],[44,102,33,87],[44,103,33,88],[44,106,33,91],[44,110,33,95],[45,6,34,4],[45,10,34,10,"opMatches"],[45,19,34,19],[45,22,34,22,"pattern"],[45,29,34,29],[45,30,34,30,"op"],[45,32,34,32],[45,35,34,35,"span"],[45,39,34,39],[45,40,34,40,"op"],[45,42,34,42],[45,46,34,46],[45,50,34,46,"isMatchingPattern"],[45,59,34,63],[45,60,34,63,"isMatchingPattern"],[45,77,34,63],[45,79,34,64,"span"],[45,83,34,68],[45,84,34,69,"op"],[45,86,34,71],[45,88,34,73,"pattern"],[45,95,34,80],[45,96,34,81,"op"],[45,98,34,83],[45,99,34,84],[45,102,34,87],[45,106,34,91],[47,6,36,4],[48,6,37,4],[49,6,38,4],[50,6,39,4],[51,6,40,4],[51,10,40,8,"nameMatches"],[51,21,40,19],[51,25,40,23,"opMatches"],[51,34,40,32],[51,36,40,34],[52,8,41,6,"DEBUG_BUILD"],[52,21,41,17],[52,22,41,17,"DEBUG_BUILD"],[52,33,41,17],[52,37,41,21,"logIgnoredSpan"],[52,51,41,35],[52,52,41,36,"span"],[52,56,41,40],[52,57,41,41],[53,8,42,6],[53,15,42,13],[53,19,42,17],[54,6,43,4],[55,4,44,2],[56,4,46,2],[56,11,46,9],[56,16,46,14],[57,2,47,0],[59,2,49,0],[60,0,50,0],[61,0,51,0],[62,0,52,0],[63,2,53,0],[63,11,53,9,"reparentChildSpans"],[63,29,53,27,"reparentChildSpans"],[63,30,53,28,"spans"],[63,35,53,33],[63,37,53,35,"dropSpan"],[63,45,53,43],[63,47,53,45],[64,4,54,2],[64,8,54,8,"droppedSpanParentId"],[64,27,54,27],[64,30,54,30,"dropSpan"],[64,38,54,38],[64,39,54,39,"parent_span_id"],[64,53,54,53],[65,4,55,2],[65,8,55,8,"droppedSpanId"],[65,21,55,21],[65,24,55,24,"dropSpan"],[65,32,55,32],[65,33,55,33,"span_id"],[65,40,55,40],[67,4,57,2],[68,4,58,2],[69,4,59,2],[69,8,59,6],[69,9,59,7,"droppedSpanParentId"],[69,28,59,26],[69,30,59,28],[70,6,60,4],[71,4,61,2],[72,4,63,2],[72,9,63,7],[72,13,63,13,"span"],[72,17,63,17],[72,21,63,21,"spans"],[72,26,63,26],[72,28,63,28],[73,6,64,4],[73,10,64,8,"span"],[73,14,64,12],[73,15,64,13,"parent_span_id"],[73,29,64,27],[73,34,64,32,"droppedSpanId"],[73,47,64,45],[73,49,64,47],[74,8,65,6,"span"],[74,12,65,10],[74,13,65,11,"parent_span_id"],[74,27,65,25],[74,30,65,28,"droppedSpanParentId"],[74,49,65,47],[75,6,66,4],[76,4,67,2],[77,2,68,0],[78,2,70,0],[78,11,70,9,"isStringOrRegExp"],[78,27,70,25,"isStringOrRegExp"],[78,28,70,26,"value"],[78,33,70,31],[78,35,70,33],[79,4,71,2],[79,11,71,9],[79,18,71,16,"value"],[79,23,71,21],[79,28,71,26],[79,36,71,34],[79,40,71,38,"value"],[79,45,71,43],[79,57,71,55,"RegExp"],[79,63,71,61],[80,2,72,0],[81,0,72,1],[81,3]],"functionMap":{"names":["<global>","logIgnoredSpan","shouldIgnoreSpan","reparentChildSpans","isStringOrRegExp"],"mappings":"AAA;ACI;CDE;AEK;CFmC;AGM;CHe;AIE;CJE"},"hasCjsExports":false},"type":"js/module"}]}