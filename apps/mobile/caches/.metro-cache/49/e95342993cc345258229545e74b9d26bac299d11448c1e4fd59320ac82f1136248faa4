{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":66,"index":66}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-navigation/native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":67},"end":{"line":2,"column":58,"index":125}}],"key":"yKhyWCfwa1gXEwEbMKnWHykYbZ4=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":126},"end":{"line":3,"column":55,"index":181}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/hooks/usePendingDateFeedback","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":182},"end":{"line":4,"column":72,"index":254}}],"key":"62Z9chell6H1kn1gDwIkzD2hBE4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useMessagesFeedback = useMessagesFeedback;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNavigationNative = require(_dependencyMap[1], \"@react-navigation/native\");\n  var _tanstackReactQuery = require(_dependencyMap[2], \"@tanstack/react-query\");\n  var _hooksUsePendingDateFeedback = require(_dependencyMap[3], \"@/hooks/usePendingDateFeedback\");\n  function useMessagesFeedback(user) {\n    _s();\n    const [feedbackOpen, setFeedbackOpen] = (0, _react.useState)(false);\n    const [activeFeedback, setActiveFeedback] = (0, _react.useState)(null);\n    const queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    const pendingKey = (0, _react.useMemo)(() => {\n      const uid = Number(user?.id);\n      return [\"pendingDateFeedback\", uid];\n    }, [user?.id]);\n    const pendingFeedbackQuery = (0, _hooksUsePendingDateFeedback.usePendingDateFeedback)(user?.id);\n    const maybeOpenFeedbackPrompt = (0, _react.useCallback)(pending => {\n      if (feedbackOpen) return;\n      const list = Array.isArray(pending) ? pending : [];\n      if (list.length === 0) return;\n      const first = list[0];\n      setActiveFeedback(first);\n      setFeedbackOpen(true);\n    }, [feedbackOpen]);\n    (0, _react.useEffect)(() => {\n      if (!user?.id) return;\n      if (!pendingFeedbackQuery.isSuccess) return;\n      const pending = pendingFeedbackQuery.data?.pending || [];\n      maybeOpenFeedbackPrompt(pending);\n    }, [maybeOpenFeedbackPrompt, pendingFeedbackQuery.data?.pending, pendingFeedbackQuery.isSuccess, user?.id]);\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) {\n        return;\n      }\n      pendingFeedbackQuery.refetch().then(result => {\n        const pending = result?.data?.pending || [];\n        maybeOpenFeedbackPrompt(pending);\n      }).catch(e => {\n        console.error(e);\n      });\n    }, [maybeOpenFeedbackPrompt, pendingFeedbackQuery, user?.id]));\n    const handleFeedbackSubmitted = (0, _react.useCallback)(async ({\n      matchId\n    } = {}) => {\n      setFeedbackOpen(false);\n      setActiveFeedback(null);\n      try {\n        if (Number.isFinite(Number(matchId))) {\n          queryClient.setQueryData(pendingKey, old => {\n            const oldPending = Array.isArray(old?.pending) ? old.pending : [];\n            return {\n              pending: oldPending.filter(p => Number(p?.matchId) !== Number(matchId))\n            };\n          });\n        }\n      } catch (e) {\n        console.error(e);\n      }\n      try {\n        const result = await pendingFeedbackQuery.refetch();\n        const pending = result?.data?.pending || [];\n        if (pending.length > 0) {\n          setActiveFeedback(pending[0]);\n          setFeedbackOpen(true);\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    }, [pendingFeedbackQuery, pendingKey, queryClient]);\n    return {\n      feedbackOpen,\n      activeFeedback,\n      handleFeedbackSubmitted\n    };\n  }\n  _s(useMessagesFeedback, \"tTxvmg8W8wIldFwPMolIHOEy2JY=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _hooksUsePendingDateFeedback.usePendingDateFeedback, _reactNavigationNative.useFocusEffect];\n  });\n});","lineCount":85,"map":[[8,2,6,0,"exports"],[8,9,6,0],[8,10,6,0,"useMessagesFeedback"],[8,29,6,0],[8,32,6,0,"useMessagesFeedback"],[8,51,6,0],[9,2,1,0],[9,6,1,0,"_react"],[9,12,1,0],[9,15,1,0,"require"],[9,22,1,0],[9,23,1,0,"_dependencyMap"],[9,37,1,0],[10,2,2,0],[10,6,2,0,"_reactNavigationNative"],[10,28,2,0],[10,31,2,0,"require"],[10,38,2,0],[10,39,2,0,"_dependencyMap"],[10,53,2,0],[11,2,3,0],[11,6,3,0,"_tanstackReactQuery"],[11,25,3,0],[11,28,3,0,"require"],[11,35,3,0],[11,36,3,0,"_dependencyMap"],[11,50,3,0],[12,2,4,0],[12,6,4,0,"_hooksUsePendingDateFeedback"],[12,34,4,0],[12,37,4,0,"require"],[12,44,4,0],[12,45,4,0,"_dependencyMap"],[12,59,4,0],[13,2,6,7],[13,11,6,16,"useMessagesFeedback"],[13,30,6,35,"useMessagesFeedback"],[13,31,6,36,"user"],[13,35,6,40],[13,37,6,42],[14,4,6,42,"_s"],[14,6,6,42],[15,4,7,2],[15,10,7,8],[15,11,7,9,"feedbackOpen"],[15,23,7,21],[15,25,7,23,"setFeedbackOpen"],[15,40,7,38],[15,41,7,39],[15,44,7,42],[15,48,7,42,"useState"],[15,54,7,50],[15,55,7,50,"useState"],[15,63,7,50],[15,65,7,51],[15,70,7,56],[15,71,7,57],[16,4,8,2],[16,10,8,8],[16,11,8,9,"activeFeedback"],[16,25,8,23],[16,27,8,25,"setActiveFeedback"],[16,44,8,42],[16,45,8,43],[16,48,8,46],[16,52,8,46,"useState"],[16,58,8,54],[16,59,8,54,"useState"],[16,67,8,54],[16,69,8,55],[16,73,8,59],[16,74,8,60],[17,4,9,2],[17,10,9,8,"queryClient"],[17,21,9,19],[17,24,9,22],[17,28,9,22,"useQueryClient"],[17,47,9,36],[17,48,9,36,"useQueryClient"],[17,62,9,36],[17,64,9,37],[17,65,9,38],[18,4,11,2],[18,10,11,8,"pendingKey"],[18,20,11,18],[18,23,11,21],[18,27,11,21,"useMemo"],[18,33,11,28],[18,34,11,28,"useMemo"],[18,41,11,28],[18,43,11,29],[18,49,11,35],[19,6,12,4],[19,12,12,10,"uid"],[19,15,12,13],[19,18,12,16,"Number"],[19,24,12,22],[19,25,12,23,"user"],[19,29,12,27],[19,31,12,29,"id"],[19,33,12,31],[19,34,12,32],[20,6,13,4],[20,13,13,11],[20,14,13,12],[20,35,13,33],[20,37,13,35,"uid"],[20,40,13,38],[20,41,13,39],[21,4,14,2],[21,5,14,3],[21,7,14,5],[21,8,14,6,"user"],[21,12,14,10],[21,14,14,12,"id"],[21,16,14,14],[21,17,14,15],[21,18,14,16],[22,4,16,2],[22,10,16,8,"pendingFeedbackQuery"],[22,30,16,28],[22,33,16,31],[22,37,16,31,"usePendingDateFeedback"],[22,65,16,53],[22,66,16,53,"usePendingDateFeedback"],[22,88,16,53],[22,90,16,54,"user"],[22,94,16,58],[22,96,16,60,"id"],[22,98,16,62],[22,99,16,63],[23,4,18,2],[23,10,18,8,"maybeOpenFeedbackPrompt"],[23,33,18,31],[23,36,18,34],[23,40,18,34,"useCallback"],[23,46,18,45],[23,47,18,45,"useCallback"],[23,58,18,45],[23,60,19,5,"pending"],[23,67,19,12],[23,71,19,17],[24,6,20,6],[24,10,20,10,"feedbackOpen"],[24,22,20,22],[24,24,20,24],[25,6,21,6],[25,12,21,12,"list"],[25,16,21,16],[25,19,21,19,"Array"],[25,24,21,24],[25,25,21,25,"isArray"],[25,32,21,32],[25,33,21,33,"pending"],[25,40,21,40],[25,41,21,41],[25,44,21,44,"pending"],[25,51,21,51],[25,54,21,54],[25,56,21,56],[26,6,22,6],[26,10,22,10,"list"],[26,14,22,14],[26,15,22,15,"length"],[26,21,22,21],[26,26,22,26],[26,27,22,27],[26,29,22,29],[27,6,23,6],[27,12,23,12,"first"],[27,17,23,17],[27,20,23,20,"list"],[27,24,23,24],[27,25,23,25],[27,26,23,26],[27,27,23,27],[28,6,24,6,"setActiveFeedback"],[28,23,24,23],[28,24,24,24,"first"],[28,29,24,29],[28,30,24,30],[29,6,25,6,"setFeedbackOpen"],[29,21,25,21],[29,22,25,22],[29,26,25,26],[29,27,25,27],[30,4,26,4],[30,5,26,5],[30,7,27,4],[30,8,27,5,"feedbackOpen"],[30,20,27,17],[30,21,28,2],[30,22,28,3],[31,4,30,2],[31,8,30,2,"useEffect"],[31,14,30,11],[31,15,30,11,"useEffect"],[31,24,30,11],[31,26,30,12],[31,32,30,18],[32,6,31,4],[32,10,31,8],[32,11,31,9,"user"],[32,15,31,13],[32,17,31,15,"id"],[32,19,31,17],[32,21,31,19],[33,6,32,4],[33,10,32,8],[33,11,32,9,"pendingFeedbackQuery"],[33,31,32,29],[33,32,32,30,"isSuccess"],[33,41,32,39],[33,43,32,41],[34,6,33,4],[34,12,33,10,"pending"],[34,19,33,17],[34,22,33,20,"pendingFeedbackQuery"],[34,42,33,40],[34,43,33,41,"data"],[34,47,33,45],[34,49,33,47,"pending"],[34,56,33,54],[34,60,33,58],[34,62,33,60],[35,6,34,4,"maybeOpenFeedbackPrompt"],[35,29,34,27],[35,30,34,28,"pending"],[35,37,34,35],[35,38,34,36],[36,4,35,2],[36,5,35,3],[36,7,35,5],[36,8,36,4,"maybeOpenFeedbackPrompt"],[36,31,36,27],[36,33,37,4,"pendingFeedbackQuery"],[36,53,37,24],[36,54,37,25,"data"],[36,58,37,29],[36,60,37,31,"pending"],[36,67,37,38],[36,69,38,4,"pendingFeedbackQuery"],[36,89,38,24],[36,90,38,25,"isSuccess"],[36,99,38,34],[36,101,39,4,"user"],[36,105,39,8],[36,107,39,10,"id"],[36,109,39,12],[36,110,40,3],[36,111,40,4],[37,4,42,2],[37,8,42,2,"useFocusEffect"],[37,30,42,16],[37,31,42,16,"useFocusEffect"],[37,45,42,16],[37,47,43,4],[37,51,43,4,"useCallback"],[37,57,43,15],[37,58,43,15,"useCallback"],[37,69,43,15],[37,71,43,16],[37,77,43,22],[38,6,44,6],[38,10,44,10],[38,11,44,11,"user"],[38,15,44,15],[38,17,44,17,"id"],[38,19,44,19],[38,21,44,21],[39,8,45,8],[40,6,46,6],[41,6,48,6,"pendingFeedbackQuery"],[41,26,48,26],[41,27,49,9,"refetch"],[41,34,49,16],[41,35,49,17],[41,36,49,18],[41,37,50,9,"then"],[41,41,50,13],[41,42,50,15,"result"],[41,48,50,21],[41,52,50,26],[42,8,51,10],[42,14,51,16,"pending"],[42,21,51,23],[42,24,51,26,"result"],[42,30,51,32],[42,32,51,34,"data"],[42,36,51,38],[42,38,51,40,"pending"],[42,45,51,47],[42,49,51,51],[42,51,51,53],[43,8,52,10,"maybeOpenFeedbackPrompt"],[43,31,52,33],[43,32,52,34,"pending"],[43,39,52,41],[43,40,52,42],[44,6,53,8],[44,7,53,9],[44,8,53,10],[44,9,54,9,"catch"],[44,14,54,14],[44,15,54,16,"e"],[44,16,54,17],[44,20,54,22],[45,8,55,10,"console"],[45,15,55,17],[45,16,55,18,"error"],[45,21,55,23],[45,22,55,24,"e"],[45,23,55,25],[45,24,55,26],[46,6,56,8],[46,7,56,9],[46,8,56,10],[47,4,57,4],[47,5,57,5],[47,7,57,7],[47,8,57,8,"maybeOpenFeedbackPrompt"],[47,31,57,31],[47,33,57,33,"pendingFeedbackQuery"],[47,53,57,53],[47,55,57,55,"user"],[47,59,57,59],[47,61,57,61,"id"],[47,63,57,63],[47,64,57,64],[47,65,58,2],[47,66,58,3],[48,4,60,2],[48,10,60,8,"handleFeedbackSubmitted"],[48,33,60,31],[48,36,60,34],[48,40,60,34,"useCallback"],[48,46,60,45],[48,47,60,45,"useCallback"],[48,58,60,45],[48,60,61,4],[48,67,61,11],[49,6,61,13,"matchId"],[50,4,61,21],[50,5,61,22],[50,8,61,25],[50,9,61,26],[50,10,61,27],[50,15,61,32],[51,6,62,6,"setFeedbackOpen"],[51,21,62,21],[51,22,62,22],[51,27,62,27],[51,28,62,28],[52,6,63,6,"setActiveFeedback"],[52,23,63,23],[52,24,63,24],[52,28,63,28],[52,29,63,29],[53,6,65,6],[53,10,65,10],[54,8,66,8],[54,12,66,12,"Number"],[54,18,66,18],[54,19,66,19,"isFinite"],[54,27,66,27],[54,28,66,28,"Number"],[54,34,66,34],[54,35,66,35,"matchId"],[54,42,66,42],[54,43,66,43],[54,44,66,44],[54,46,66,46],[55,10,67,10,"queryClient"],[55,21,67,21],[55,22,67,22,"setQueryData"],[55,34,67,34],[55,35,67,35,"pendingKey"],[55,45,67,45],[55,47,67,48,"old"],[55,50,67,51],[55,54,67,56],[56,12,68,12],[56,18,68,18,"oldPending"],[56,28,68,28],[56,31,68,31,"Array"],[56,36,68,36],[56,37,68,37,"isArray"],[56,44,68,44],[56,45,68,45,"old"],[56,48,68,48],[56,50,68,50,"pending"],[56,57,68,57],[56,58,68,58],[56,61,68,61,"old"],[56,64,68,64],[56,65,68,65,"pending"],[56,72,68,72],[56,75,68,75],[56,77,68,77],[57,12,69,12],[57,19,69,19],[58,14,70,14,"pending"],[58,21,70,21],[58,23,70,23,"oldPending"],[58,33,70,33],[58,34,70,34,"filter"],[58,40,70,40],[58,41,71,17,"p"],[58,42,71,18],[58,46,71,23,"Number"],[58,52,71,29],[58,53,71,30,"p"],[58,54,71,31],[58,56,71,33,"matchId"],[58,63,71,40],[58,64,71,41],[58,69,71,46,"Number"],[58,75,71,52],[58,76,71,53,"matchId"],[58,83,71,60],[58,84,72,14],[59,12,73,12],[59,13,73,13],[60,10,74,10],[60,11,74,11],[60,12,74,12],[61,8,75,8],[62,6,76,6],[62,7,76,7],[62,8,76,8],[62,15,76,15,"e"],[62,16,76,16],[62,18,76,18],[63,8,77,8,"console"],[63,15,77,15],[63,16,77,16,"error"],[63,21,77,21],[63,22,77,22,"e"],[63,23,77,23],[63,24,77,24],[64,6,78,6],[65,6,80,6],[65,10,80,10],[66,8,81,8],[66,14,81,14,"result"],[66,20,81,20],[66,23,81,23],[66,29,81,29,"pendingFeedbackQuery"],[66,49,81,49],[66,50,81,50,"refetch"],[66,57,81,57],[66,58,81,58],[66,59,81,59],[67,8,82,8],[67,14,82,14,"pending"],[67,21,82,21],[67,24,82,24,"result"],[67,30,82,30],[67,32,82,32,"data"],[67,36,82,36],[67,38,82,38,"pending"],[67,45,82,45],[67,49,82,49],[67,51,82,51],[68,8,83,8],[68,12,83,12,"pending"],[68,19,83,19],[68,20,83,20,"length"],[68,26,83,26],[68,29,83,29],[68,30,83,30],[68,32,83,32],[69,10,84,10,"setActiveFeedback"],[69,27,84,27],[69,28,84,28,"pending"],[69,35,84,35],[69,36,84,36],[69,37,84,37],[69,38,84,38],[69,39,84,39],[70,10,85,10,"setFeedbackOpen"],[70,25,85,25],[70,26,85,26],[70,30,85,30],[70,31,85,31],[71,8,86,8],[72,6,87,6],[72,7,87,7],[72,8,87,8],[72,15,87,15,"e"],[72,16,87,16],[72,18,87,18],[73,8,88,8,"console"],[73,15,88,15],[73,16,88,16,"error"],[73,21,88,21],[73,22,88,22,"e"],[73,23,88,23],[73,24,88,24],[74,6,89,6],[75,4,90,4],[75,5,90,5],[75,7,91,4],[75,8,91,5,"pendingFeedbackQuery"],[75,28,91,25],[75,30,91,27,"pendingKey"],[75,40,91,37],[75,42,91,39,"queryClient"],[75,53,91,50],[75,54,92,2],[75,55,92,3],[76,4,94,2],[76,11,94,9],[77,6,95,4,"feedbackOpen"],[77,18,95,16],[78,6,96,4,"activeFeedback"],[78,20,96,18],[79,6,97,4,"handleFeedbackSubmitted"],[80,4,98,2],[80,5,98,3],[81,2,99,0],[82,2,99,1,"_s"],[82,4,99,1],[82,5,6,16,"useMessagesFeedback"],[82,24,6,35],[83,4,6,35],[83,12,9,22,"useQueryClient"],[83,31,9,36],[83,32,9,36,"useQueryClient"],[83,46,9,36],[83,48,16,31,"usePendingDateFeedback"],[83,76,16,53],[83,77,16,53,"usePendingDateFeedback"],[83,99,16,53],[83,101,42,2,"useFocusEffect"],[83,123,42,16],[83,124,42,16,"useFocusEffect"],[83,138,42,16],[84,2,42,16],[85,0,42,16],[85,3]],"functionMap":{"names":["<global>","useMessagesFeedback","useMemo$argument_0","maybeOpenFeedbackPrompt","useEffect$argument_0","useFocusEffect$argument_0","pendingFeedbackQuery.refetch.then$argument_0","pendingFeedbackQuery.refetch.then._catch$argument_0","handleFeedbackSubmitted","queryClient.setQueryData$argument_1","oldPending.filter$argument_0"],"mappings":"AAA;OCK;6BCK;GDG;IEK;KFO;YGI;GHK;gBIQ;cCO;SDG;eEC;SFE;KJC;IOI;+CCM;gBCI,6CD;WDG;KPgB;CDS"},"hasCjsExports":false},"type":"js/module"}]}