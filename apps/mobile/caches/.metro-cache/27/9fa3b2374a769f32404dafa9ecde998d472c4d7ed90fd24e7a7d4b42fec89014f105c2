{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":36,"index":36}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-navigation/native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":37},"end":{"line":2,"column":58,"index":95}}],"key":"yKhyWCfwa1gXEwEbMKnWHykYbZ4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useMessagesAutoRefresh = useMessagesAutoRefresh;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNavigationNative = require(_dependencyMap[1], \"@react-navigation/native\");\n  function useMessagesAutoRefresh({\n    user,\n    closedRows,\n    loadMatches,\n    markMatchesSeen,\n    refreshCredits,\n    hasCredits,\n    attemptRestoreCredits\n  }) {\n    _s();\n    // Refresh when returning to tab\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) return;\n\n      // Keep these cheap and non-blocking\n      markMatchesSeen(user.id);\n      loadMatches(user.id);\n      refreshCredits(user.id);\n\n      // NEW: if they're locked but they just completed a purchase,\n      // try a one-shot restore+claim here so they don't get stuck.\n      if (!hasCredits && typeof attemptRestoreCredits === \"function\") {\n        attemptRestoreCredits(user.id).catch(() => null);\n      }\n    }, [attemptRestoreCredits, hasCredits, loadMatches, markMatchesSeen, refreshCredits, user?.id]));\n\n    // Auto-refresh if we have terminal rows (so they auto-dismiss)\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) return;\n      const hasTerminal = (closedRows?.length || 0) > 0;\n      if (!hasTerminal) return;\n      const id = setTimeout(() => {\n        loadMatches(user.id);\n      }, 4000);\n      return () => clearTimeout(id);\n    }, [closedRows?.length, loadMatches, user?.id]));\n  }\n  _s(useMessagesAutoRefresh, \"D1u/CFEz2BqbNc9Az6klnPzoDsc=\", false, function () {\n    return [_reactNavigationNative.useFocusEffect, _reactNavigationNative.useFocusEffect];\n  });\n});","lineCount":51,"map":[[8,2,4,0,"exports"],[8,9,4,0],[8,10,4,0,"useMessagesAutoRefresh"],[8,32,4,0],[8,35,4,0,"useMessagesAutoRefresh"],[8,57,4,0],[9,2,1,0],[9,6,1,0,"_react"],[9,12,1,0],[9,15,1,0,"require"],[9,22,1,0],[9,23,1,0,"_dependencyMap"],[9,37,1,0],[10,2,2,0],[10,6,2,0,"_reactNavigationNative"],[10,28,2,0],[10,31,2,0,"require"],[10,38,2,0],[10,39,2,0,"_dependencyMap"],[10,53,2,0],[11,2,4,7],[11,11,4,16,"useMessagesAutoRefresh"],[11,33,4,38,"useMessagesAutoRefresh"],[11,34,4,39],[12,4,5,2,"user"],[12,8,5,6],[13,4,6,2,"closedRows"],[13,14,6,12],[14,4,7,2,"loadMatches"],[14,15,7,13],[15,4,8,2,"markMatchesSeen"],[15,19,8,17],[16,4,9,2,"refreshCredits"],[16,18,9,16],[17,4,10,2,"hasCredits"],[17,14,10,12],[18,4,11,2,"attemptRestoreCredits"],[19,2,12,0],[19,3,12,1],[19,5,12,3],[20,4,12,3,"_s"],[20,6,12,3],[21,4,13,2],[22,4,14,2],[22,8,14,2,"useFocusEffect"],[22,30,14,16],[22,31,14,16,"useFocusEffect"],[22,45,14,16],[22,47,15,4],[22,51,15,4,"useCallback"],[22,57,15,15],[22,58,15,15,"useCallback"],[22,69,15,15],[22,71,15,16],[22,77,15,22],[23,6,16,6],[23,10,16,10],[23,11,16,11,"user"],[23,15,16,15],[23,17,16,17,"id"],[23,19,16,19],[23,21,16,21],[25,6,18,6],[26,6,19,6,"markMatchesSeen"],[26,21,19,21],[26,22,19,22,"user"],[26,26,19,26],[26,27,19,27,"id"],[26,29,19,29],[26,30,19,30],[27,6,20,6,"loadMatches"],[27,17,20,17],[27,18,20,18,"user"],[27,22,20,22],[27,23,20,23,"id"],[27,25,20,25],[27,26,20,26],[28,6,21,6,"refreshCredits"],[28,20,21,20],[28,21,21,21,"user"],[28,25,21,25],[28,26,21,26,"id"],[28,28,21,28],[28,29,21,29],[30,6,23,6],[31,6,24,6],[32,6,25,6],[32,10,25,10],[32,11,25,11,"hasCredits"],[32,21,25,21],[32,25,25,25],[32,32,25,32,"attemptRestoreCredits"],[32,53,25,53],[32,58,25,58],[32,68,25,68],[32,70,25,70],[33,8,26,8,"attemptRestoreCredits"],[33,29,26,29],[33,30,26,30,"user"],[33,34,26,34],[33,35,26,35,"id"],[33,37,26,37],[33,38,26,38],[33,39,26,39,"catch"],[33,44,26,44],[33,45,26,45],[33,51,26,51],[33,55,26,55],[33,56,26,56],[34,6,27,6],[35,4,28,4],[35,5,28,5],[35,7,28,7],[35,8,29,6,"attemptRestoreCredits"],[35,29,29,27],[35,31,30,6,"hasCredits"],[35,41,30,16],[35,43,31,6,"loadMatches"],[35,54,31,17],[35,56,32,6,"markMatchesSeen"],[35,71,32,21],[35,73,33,6,"refreshCredits"],[35,87,33,20],[35,89,34,6,"user"],[35,93,34,10],[35,95,34,12,"id"],[35,97,34,14],[35,98,35,5],[35,99,36,2],[35,100,36,3],[37,4,38,2],[38,4,39,2],[38,8,39,2,"useFocusEffect"],[38,30,39,16],[38,31,39,16,"useFocusEffect"],[38,45,39,16],[38,47,40,4],[38,51,40,4,"useCallback"],[38,57,40,15],[38,58,40,15,"useCallback"],[38,69,40,15],[38,71,40,16],[38,77,40,22],[39,6,41,6],[39,10,41,10],[39,11,41,11,"user"],[39,15,41,15],[39,17,41,17,"id"],[39,19,41,19],[39,21,41,21],[40,6,42,6],[40,12,42,12,"hasTerminal"],[40,23,42,23],[40,26,42,26],[40,27,42,27,"closedRows"],[40,37,42,37],[40,39,42,39,"length"],[40,45,42,45],[40,49,42,49],[40,50,42,50],[40,54,42,54],[40,55,42,55],[41,6,43,6],[41,10,43,10],[41,11,43,11,"hasTerminal"],[41,22,43,22],[41,24,43,24],[42,6,45,6],[42,12,45,12,"id"],[42,14,45,14],[42,17,45,17,"setTimeout"],[42,27,45,27],[42,28,45,28],[42,34,45,34],[43,8,46,8,"loadMatches"],[43,19,46,19],[43,20,46,20,"user"],[43,24,46,24],[43,25,46,25,"id"],[43,27,46,27],[43,28,46,28],[44,6,47,6],[44,7,47,7],[44,9,47,9],[44,13,47,13],[44,14,47,14],[45,6,49,6],[45,13,49,13],[45,19,49,19,"clearTimeout"],[45,31,49,31],[45,32,49,32,"id"],[45,34,49,34],[45,35,49,35],[46,4,50,4],[46,5,50,5],[46,7,50,7],[46,8,50,8,"closedRows"],[46,18,50,18],[46,20,50,20,"length"],[46,26,50,26],[46,28,50,28,"loadMatches"],[46,39,50,39],[46,41,50,41,"user"],[46,45,50,45],[46,47,50,47,"id"],[46,49,50,49],[46,50,50,50],[46,51,51,2],[46,52,51,3],[47,2,52,0],[48,2,52,1,"_s"],[48,4,52,1],[48,5,4,16,"useMessagesAutoRefresh"],[48,27,4,38],[49,4,4,38],[49,12,14,2,"useFocusEffect"],[49,34,14,16],[49,35,14,16,"useFocusEffect"],[49,49,14,16],[49,51,39,2,"useFocusEffect"],[49,73,39,16],[49,74,39,16,"useFocusEffect"],[49,88,39,16],[50,2,39,16],[51,0,39,16],[51,3]],"functionMap":{"names":["<global>","useMessagesAutoRefresh","useFocusEffect$argument_0","attemptRestoreCredits._catch$argument_0","setTimeout$argument_0","<anonymous>"],"mappings":"AAA;OCG;gBCW;6CCW,UD;KDE;gBCY;4BEK;OFE;aGE,sBH;KDC;CDE"},"hasCjsExports":false},"type":"js/module"}]}