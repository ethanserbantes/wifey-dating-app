{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":66,"index":66}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-navigation/native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":67},"end":{"line":2,"column":58,"index":125}}],"key":"yKhyWCfwa1gXEwEbMKnWHykYbZ4=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":126},"end":{"line":3,"column":55,"index":181}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/hooks/usePendingDateFeedback","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":182},"end":{"line":4,"column":72,"index":254}}],"key":"62Z9chell6H1kn1gDwIkzD2hBE4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useMessagesFeedback = useMessagesFeedback;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1]);\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2]);\n  var _reactNavigationNative = require(_dependencyMap[3]);\n  var _tanstackReactQuery = require(_dependencyMap[4]);\n  var _hooksUsePendingDateFeedback = require(_dependencyMap[5]);\n  function useMessagesFeedback(user) {\n    var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      feedbackOpen = _useState2[0],\n      setFeedbackOpen = _useState2[1];\n    var _useState3 = (0, _react.useState)(null),\n      _useState4 = (0, _slicedToArray.default)(_useState3, 2),\n      activeFeedback = _useState4[0],\n      setActiveFeedback = _useState4[1];\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var pendingKey = (0, _react.useMemo)(() => {\n      var uid = Number(user?.id);\n      return [\"pendingDateFeedback\", uid];\n    }, [user?.id]);\n    var pendingFeedbackQuery = (0, _hooksUsePendingDateFeedback.usePendingDateFeedback)(user?.id);\n    var maybeOpenFeedbackPrompt = (0, _react.useCallback)(pending => {\n      if (feedbackOpen) return;\n      var list = Array.isArray(pending) ? pending : [];\n      if (list.length === 0) return;\n      var first = list[0];\n      setActiveFeedback(first);\n      setFeedbackOpen(true);\n    }, [feedbackOpen]);\n    (0, _react.useEffect)(() => {\n      if (!user?.id) return;\n      if (!pendingFeedbackQuery.isSuccess) return;\n      var pending = pendingFeedbackQuery.data?.pending || [];\n      maybeOpenFeedbackPrompt(pending);\n    }, [maybeOpenFeedbackPrompt, pendingFeedbackQuery.data?.pending, pendingFeedbackQuery.isSuccess, user?.id]);\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) {\n        return;\n      }\n      pendingFeedbackQuery.refetch().then(result => {\n        var pending = result?.data?.pending || [];\n        maybeOpenFeedbackPrompt(pending);\n      }).catch(e => {\n        console.error(e);\n      });\n    }, [maybeOpenFeedbackPrompt, pendingFeedbackQuery, user?.id]));\n    var handleFeedbackSubmitted = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator.default)(function* () {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        matchId = _ref2.matchId;\n      setFeedbackOpen(false);\n      setActiveFeedback(null);\n      try {\n        if (Number.isFinite(Number(matchId))) {\n          queryClient.setQueryData(pendingKey, old => {\n            var oldPending = Array.isArray(old?.pending) ? old.pending : [];\n            return {\n              pending: oldPending.filter(p => Number(p?.matchId) !== Number(matchId))\n            };\n          });\n        }\n      } catch (e) {\n        console.error(e);\n      }\n      try {\n        var result = yield pendingFeedbackQuery.refetch();\n        var pending = result?.data?.pending || [];\n        if (pending.length > 0) {\n          setActiveFeedback(pending[0]);\n          setFeedbackOpen(true);\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    }), [pendingFeedbackQuery, pendingKey, queryClient]);\n    return {\n      feedbackOpen,\n      activeFeedback,\n      handleFeedbackSubmitted\n    };\n  }\n});","lineCount":95,"map":[[12,2,6,0,"exports"],[12,9,6,0],[12,10,6,0,"useMessagesFeedback"],[12,29,6,0],[12,32,6,0,"useMessagesFeedback"],[12,51,6,0],[13,2,99,1],[13,6,99,1,"_babelRuntimeHelpersAsyncToGenerator"],[13,42,99,1],[13,45,99,1,"require"],[13,52,99,1],[13,53,99,1,"_dependencyMap"],[13,67,99,1],[14,2,99,1],[14,6,99,1,"_asyncToGenerator"],[14,23,99,1],[14,26,99,1,"_interopDefault"],[14,41,99,1],[14,42,99,1,"_babelRuntimeHelpersAsyncToGenerator"],[14,78,99,1],[15,2,99,1],[15,6,99,1,"_babelRuntimeHelpersSlicedToArray"],[15,39,99,1],[15,42,99,1,"require"],[15,49,99,1],[15,50,99,1,"_dependencyMap"],[15,64,99,1],[16,2,99,1],[16,6,99,1,"_slicedToArray"],[16,20,99,1],[16,23,99,1,"_interopDefault"],[16,38,99,1],[16,39,99,1,"_babelRuntimeHelpersSlicedToArray"],[16,72,99,1],[17,2,1,0],[17,6,1,0,"_react"],[17,12,1,0],[17,15,1,0,"require"],[17,22,1,0],[17,23,1,0,"_dependencyMap"],[17,37,1,0],[18,2,2,0],[18,6,2,0,"_reactNavigationNative"],[18,28,2,0],[18,31,2,0,"require"],[18,38,2,0],[18,39,2,0,"_dependencyMap"],[18,53,2,0],[19,2,3,0],[19,6,3,0,"_tanstackReactQuery"],[19,25,3,0],[19,28,3,0,"require"],[19,35,3,0],[19,36,3,0,"_dependencyMap"],[19,50,3,0],[20,2,4,0],[20,6,4,0,"_hooksUsePendingDateFeedback"],[20,34,4,0],[20,37,4,0,"require"],[20,44,4,0],[20,45,4,0,"_dependencyMap"],[20,59,4,0],[21,2,6,7],[21,11,6,16,"useMessagesFeedback"],[21,30,6,35,"useMessagesFeedback"],[21,31,6,36,"user"],[21,35,6,40],[21,37,6,42],[22,4,7,2],[22,8,7,2,"_useState"],[22,17,7,2],[22,20,7,42],[22,24,7,42,"useState"],[22,30,7,50],[22,31,7,50,"useState"],[22,39,7,50],[22,41,7,51],[22,46,7,56],[22,47,7,57],[23,6,7,57,"_useState2"],[23,16,7,57],[23,23,7,57,"_slicedToArray"],[23,37,7,57],[23,38,7,57,"default"],[23,45,7,57],[23,47,7,57,"_useState"],[23,56,7,57],[24,6,7,9,"feedbackOpen"],[24,18,7,21],[24,21,7,21,"_useState2"],[24,31,7,21],[25,6,7,23,"setFeedbackOpen"],[25,21,7,38],[25,24,7,38,"_useState2"],[25,34,7,38],[26,4,8,2],[26,8,8,2,"_useState3"],[26,18,8,2],[26,21,8,46],[26,25,8,46,"useState"],[26,31,8,54],[26,32,8,54,"useState"],[26,40,8,54],[26,42,8,55],[26,46,8,59],[26,47,8,60],[27,6,8,60,"_useState4"],[27,16,8,60],[27,23,8,60,"_slicedToArray"],[27,37,8,60],[27,38,8,60,"default"],[27,45,8,60],[27,47,8,60,"_useState3"],[27,57,8,60],[28,6,8,9,"activeFeedback"],[28,20,8,23],[28,23,8,23,"_useState4"],[28,33,8,23],[29,6,8,25,"setActiveFeedback"],[29,23,8,42],[29,26,8,42,"_useState4"],[29,36,8,42],[30,4,9,2],[30,8,9,8,"queryClient"],[30,19,9,19],[30,22,9,22],[30,26,9,22,"useQueryClient"],[30,45,9,36],[30,46,9,36,"useQueryClient"],[30,60,9,36],[30,62,9,37],[30,63,9,38],[31,4,11,2],[31,8,11,8,"pendingKey"],[31,18,11,18],[31,21,11,21],[31,25,11,21,"useMemo"],[31,31,11,28],[31,32,11,28,"useMemo"],[31,39,11,28],[31,41,11,29],[31,47,11,35],[32,6,12,4],[32,10,12,10,"uid"],[32,13,12,13],[32,16,12,16,"Number"],[32,22,12,22],[32,23,12,23,"user"],[32,27,12,27],[32,29,12,29,"id"],[32,31,12,31],[32,32,12,32],[33,6,13,4],[33,13,13,11],[33,14,13,12],[33,35,13,33],[33,37,13,35,"uid"],[33,40,13,38],[33,41,13,39],[34,4,14,2],[34,5,14,3],[34,7,14,5],[34,8,14,6,"user"],[34,12,14,10],[34,14,14,12,"id"],[34,16,14,14],[34,17,14,15],[34,18,14,16],[35,4,16,2],[35,8,16,8,"pendingFeedbackQuery"],[35,28,16,28],[35,31,16,31],[35,35,16,31,"usePendingDateFeedback"],[35,63,16,53],[35,64,16,53,"usePendingDateFeedback"],[35,86,16,53],[35,88,16,54,"user"],[35,92,16,58],[35,94,16,60,"id"],[35,96,16,62],[35,97,16,63],[36,4,18,2],[36,8,18,8,"maybeOpenFeedbackPrompt"],[36,31,18,31],[36,34,18,34],[36,38,18,34,"useCallback"],[36,44,18,45],[36,45,18,45,"useCallback"],[36,56,18,45],[36,58,19,5,"pending"],[36,65,19,12],[36,69,19,17],[37,6,20,6],[37,10,20,10,"feedbackOpen"],[37,22,20,22],[37,24,20,24],[38,6,21,6],[38,10,21,12,"list"],[38,14,21,16],[38,17,21,19,"Array"],[38,22,21,24],[38,23,21,25,"isArray"],[38,30,21,32],[38,31,21,33,"pending"],[38,38,21,40],[38,39,21,41],[38,42,21,44,"pending"],[38,49,21,51],[38,52,21,54],[38,54,21,56],[39,6,22,6],[39,10,22,10,"list"],[39,14,22,14],[39,15,22,15,"length"],[39,21,22,21],[39,26,22,26],[39,27,22,27],[39,29,22,29],[40,6,23,6],[40,10,23,12,"first"],[40,15,23,17],[40,18,23,20,"list"],[40,22,23,24],[40,23,23,25],[40,24,23,26],[40,25,23,27],[41,6,24,6,"setActiveFeedback"],[41,23,24,23],[41,24,24,24,"first"],[41,29,24,29],[41,30,24,30],[42,6,25,6,"setFeedbackOpen"],[42,21,25,21],[42,22,25,22],[42,26,25,26],[42,27,25,27],[43,4,26,4],[43,5,26,5],[43,7,27,4],[43,8,27,5,"feedbackOpen"],[43,20,27,17],[43,21,28,2],[43,22,28,3],[44,4,30,2],[44,8,30,2,"useEffect"],[44,14,30,11],[44,15,30,11,"useEffect"],[44,24,30,11],[44,26,30,12],[44,32,30,18],[45,6,31,4],[45,10,31,8],[45,11,31,9,"user"],[45,15,31,13],[45,17,31,15,"id"],[45,19,31,17],[45,21,31,19],[46,6,32,4],[46,10,32,8],[46,11,32,9,"pendingFeedbackQuery"],[46,31,32,29],[46,32,32,30,"isSuccess"],[46,41,32,39],[46,43,32,41],[47,6,33,4],[47,10,33,10,"pending"],[47,17,33,17],[47,20,33,20,"pendingFeedbackQuery"],[47,40,33,40],[47,41,33,41,"data"],[47,45,33,45],[47,47,33,47,"pending"],[47,54,33,54],[47,58,33,58],[47,60,33,60],[48,6,34,4,"maybeOpenFeedbackPrompt"],[48,29,34,27],[48,30,34,28,"pending"],[48,37,34,35],[48,38,34,36],[49,4,35,2],[49,5,35,3],[49,7,35,5],[49,8,36,4,"maybeOpenFeedbackPrompt"],[49,31,36,27],[49,33,37,4,"pendingFeedbackQuery"],[49,53,37,24],[49,54,37,25,"data"],[49,58,37,29],[49,60,37,31,"pending"],[49,67,37,38],[49,69,38,4,"pendingFeedbackQuery"],[49,89,38,24],[49,90,38,25,"isSuccess"],[49,99,38,34],[49,101,39,4,"user"],[49,105,39,8],[49,107,39,10,"id"],[49,109,39,12],[49,110,40,3],[49,111,40,4],[50,4,42,2],[50,8,42,2,"useFocusEffect"],[50,30,42,16],[50,31,42,16,"useFocusEffect"],[50,45,42,16],[50,47,43,4],[50,51,43,4,"useCallback"],[50,57,43,15],[50,58,43,15,"useCallback"],[50,69,43,15],[50,71,43,16],[50,77,43,22],[51,6,44,6],[51,10,44,10],[51,11,44,11,"user"],[51,15,44,15],[51,17,44,17,"id"],[51,19,44,19],[51,21,44,21],[52,8,45,8],[53,6,46,6],[54,6,48,6,"pendingFeedbackQuery"],[54,26,48,26],[54,27,49,9,"refetch"],[54,34,49,16],[54,35,49,17],[54,36,49,18],[54,37,50,9,"then"],[54,41,50,13],[54,42,50,15,"result"],[54,48,50,21],[54,52,50,26],[55,8,51,10],[55,12,51,16,"pending"],[55,19,51,23],[55,22,51,26,"result"],[55,28,51,32],[55,30,51,34,"data"],[55,34,51,38],[55,36,51,40,"pending"],[55,43,51,47],[55,47,51,51],[55,49,51,53],[56,8,52,10,"maybeOpenFeedbackPrompt"],[56,31,52,33],[56,32,52,34,"pending"],[56,39,52,41],[56,40,52,42],[57,6,53,8],[57,7,53,9],[57,8,53,10],[57,9,54,9,"catch"],[57,14,54,14],[57,15,54,16,"e"],[57,16,54,17],[57,20,54,22],[58,8,55,10,"console"],[58,15,55,17],[58,16,55,18,"error"],[58,21,55,23],[58,22,55,24,"e"],[58,23,55,25],[58,24,55,26],[59,6,56,8],[59,7,56,9],[59,8,56,10],[60,4,57,4],[60,5,57,5],[60,7,57,7],[60,8,57,8,"maybeOpenFeedbackPrompt"],[60,31,57,31],[60,33,57,33,"pendingFeedbackQuery"],[60,53,57,53],[60,55,57,55,"user"],[60,59,57,59],[60,61,57,61,"id"],[60,63,57,63],[60,64,57,64],[60,65,58,2],[60,66,58,3],[61,4,60,2],[61,8,60,8,"handleFeedbackSubmitted"],[61,31,60,31],[61,34,60,34],[61,38,60,34,"useCallback"],[61,44,60,45],[61,45,60,45,"useCallback"],[61,56,60,45],[61,75,60,45,"_asyncToGenerator"],[61,92,60,45],[61,93,60,45,"default"],[61,100,60,45],[61,102,61,4],[61,115,61,32],[62,6,61,32],[62,10,61,32,"_ref2"],[62,15,61,32],[62,18,61,32,"arguments"],[62,27,61,32],[62,28,61,32,"length"],[62,34,61,32],[62,42,61,32,"arguments"],[62,51,61,32],[62,59,61,32,"undefined"],[62,68,61,32],[62,71,61,32,"arguments"],[62,80,61,32],[62,86,61,25],[62,87,61,26],[62,88,61,27],[63,8,61,13,"matchId"],[63,15,61,20],[63,18,61,20,"_ref2"],[63,23,61,20],[63,24,61,13,"matchId"],[63,31,61,20],[64,6,62,6,"setFeedbackOpen"],[64,21,62,21],[64,22,62,22],[64,27,62,27],[64,28,62,28],[65,6,63,6,"setActiveFeedback"],[65,23,63,23],[65,24,63,24],[65,28,63,28],[65,29,63,29],[66,6,65,6],[66,10,65,10],[67,8,66,8],[67,12,66,12,"Number"],[67,18,66,18],[67,19,66,19,"isFinite"],[67,27,66,27],[67,28,66,28,"Number"],[67,34,66,34],[67,35,66,35,"matchId"],[67,42,66,42],[67,43,66,43],[67,44,66,44],[67,46,66,46],[68,10,67,10,"queryClient"],[68,21,67,21],[68,22,67,22,"setQueryData"],[68,34,67,34],[68,35,67,35,"pendingKey"],[68,45,67,45],[68,47,67,48,"old"],[68,50,67,51],[68,54,67,56],[69,12,68,12],[69,16,68,18,"oldPending"],[69,26,68,28],[69,29,68,31,"Array"],[69,34,68,36],[69,35,68,37,"isArray"],[69,42,68,44],[69,43,68,45,"old"],[69,46,68,48],[69,48,68,50,"pending"],[69,55,68,57],[69,56,68,58],[69,59,68,61,"old"],[69,62,68,64],[69,63,68,65,"pending"],[69,70,68,72],[69,73,68,75],[69,75,68,77],[70,12,69,12],[70,19,69,19],[71,14,70,14,"pending"],[71,21,70,21],[71,23,70,23,"oldPending"],[71,33,70,33],[71,34,70,34,"filter"],[71,40,70,40],[71,41,71,17,"p"],[71,42,71,18],[71,46,71,23,"Number"],[71,52,71,29],[71,53,71,30,"p"],[71,54,71,31],[71,56,71,33,"matchId"],[71,63,71,40],[71,64,71,41],[71,69,71,46,"Number"],[71,75,71,52],[71,76,71,53,"matchId"],[71,83,71,60],[71,84,72,14],[72,12,73,12],[72,13,73,13],[73,10,74,10],[73,11,74,11],[73,12,74,12],[74,8,75,8],[75,6,76,6],[75,7,76,7],[75,8,76,8],[75,15,76,15,"e"],[75,16,76,16],[75,18,76,18],[76,8,77,8,"console"],[76,15,77,15],[76,16,77,16,"error"],[76,21,77,21],[76,22,77,22,"e"],[76,23,77,23],[76,24,77,24],[77,6,78,6],[78,6,80,6],[78,10,80,10],[79,8,81,8],[79,12,81,14,"result"],[79,18,81,20],[79,27,81,29,"pendingFeedbackQuery"],[79,47,81,49],[79,48,81,50,"refetch"],[79,55,81,57],[79,56,81,58],[79,57,81,59],[80,8,82,8],[80,12,82,14,"pending"],[80,19,82,21],[80,22,82,24,"result"],[80,28,82,30],[80,30,82,32,"data"],[80,34,82,36],[80,36,82,38,"pending"],[80,43,82,45],[80,47,82,49],[80,49,82,51],[81,8,83,8],[81,12,83,12,"pending"],[81,19,83,19],[81,20,83,20,"length"],[81,26,83,26],[81,29,83,29],[81,30,83,30],[81,32,83,32],[82,10,84,10,"setActiveFeedback"],[82,27,84,27],[82,28,84,28,"pending"],[82,35,84,35],[82,36,84,36],[82,37,84,37],[82,38,84,38],[82,39,84,39],[83,10,85,10,"setFeedbackOpen"],[83,25,85,25],[83,26,85,26],[83,30,85,30],[83,31,85,31],[84,8,86,8],[85,6,87,6],[85,7,87,7],[85,8,87,8],[85,15,87,15,"e"],[85,16,87,16],[85,18,87,18],[86,8,88,8,"console"],[86,15,88,15],[86,16,88,16,"error"],[86,21,88,21],[86,22,88,22,"e"],[86,23,88,23],[86,24,88,24],[87,6,89,6],[88,4,90,4],[88,5,90,5],[88,8,91,4],[88,9,91,5,"pendingFeedbackQuery"],[88,29,91,25],[88,31,91,27,"pendingKey"],[88,41,91,37],[88,43,91,39,"queryClient"],[88,54,91,50],[88,55,92,2],[88,56,92,3],[89,4,94,2],[89,11,94,9],[90,6,95,4,"feedbackOpen"],[90,18,95,16],[91,6,96,4,"activeFeedback"],[91,20,96,18],[92,6,97,4,"handleFeedbackSubmitted"],[93,4,98,2],[93,5,98,3],[94,2,99,0],[95,0,99,1],[95,3]],"functionMap":{"names":["<global>","useMessagesFeedback","useMemo$argument_0","maybeOpenFeedbackPrompt","useEffect$argument_0","useFocusEffect$argument_0","pendingFeedbackQuery.refetch.then$argument_0","pendingFeedbackQuery.refetch.then._catch$argument_0","handleFeedbackSubmitted","queryClient.setQueryData$argument_1","oldPending.filter$argument_0"],"mappings":"AAA;OCK;6BCK;GDG;IEK;KFO;YGI;GHK;gBIQ;cCO;SDG;eEC;SFE;KJC;IOI;+CCM;gBCI,6CD;WDG;KPgB;CDS"},"hasCjsExports":false},"type":"js/module"}]}