{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"expo/fetch","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":48,"index":98}}],"key":"ug2WTu871fxhwUkT+lg+x8TWZJo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _expoSecureStore = require(_dependencyMap[1], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _expoFetch = require(_dependencyMap[2], \"expo/fetch\");\n  const originalFetch = fetch;\n  const authKey = `${_expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID}-jwt`;\n  const getURLFromArgs = (...args) => {\n    const [urlArg] = args;\n    let url;\n    if (typeof urlArg === 'string') {\n      url = urlArg;\n    } else if (typeof urlArg === 'object' && urlArg !== null) {\n      url = urlArg.url;\n    } else {\n      url = null;\n    }\n    return url;\n  };\n  const isFileURL = url => {\n    return url.startsWith('file://') || url.startsWith('data:');\n  };\n  const isFirstPartyURL = url => {\n    return url.startsWith('/') || _expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL && url.startsWith(_expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL);\n  };\n  const isSecondPartyURL = url => {\n    return url.startsWith('/_create/');\n  };\n  const fetchToWeb = async function fetchWithHeaders(...args) {\n    const firstPartyURL = _expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL;\n    const secondPartyURL = _expoVirtualEnv.env.EXPO_PUBLIC_PROXY_BASE_URL;\n    const [input, init] = args;\n    const url = getURLFromArgs(input, init);\n    if (!url) {\n      return (0, _expoFetch.fetch)(input, init);\n    }\n    if (isFileURL(url)) {\n      return originalFetch(input, init);\n    }\n    const isExternalFetch = !isFirstPartyURL(url);\n    // we should not add headers to requests that don't go to our own server\n    if (isExternalFetch) {\n      return (0, _expoFetch.fetch)(input, init);\n    }\n    let finalInput = input;\n    const baseURL = isSecondPartyURL(url) ? secondPartyURL : firstPartyURL;\n    if (typeof input === 'string') {\n      finalInput = input.startsWith('/') ? `${baseURL}${input}` : input;\n    } else {\n      return (0, _expoFetch.fetch)(input, init);\n    }\n    const initHeaders = init?.headers ?? {};\n    const finalHeaders = new Headers(initHeaders);\n    const headers = {\n      'x-createxyz-project-group-id': _expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID,\n      host: _expoVirtualEnv.env.EXPO_PUBLIC_HOST,\n      'x-forwarded-host': _expoVirtualEnv.env.EXPO_PUBLIC_HOST,\n      'x-createxyz-host': _expoVirtualEnv.env.EXPO_PUBLIC_HOST\n    };\n    for (const [key, value] of Object.entries(headers)) {\n      if (value) {\n        finalHeaders.set(key, value);\n      }\n    }\n    const auth = await SecureStore.getItemAsync(authKey).then(auth => {\n      return auth ? JSON.parse(auth) : null;\n    }).catch(() => {\n      return null;\n    });\n    if (auth) {\n      finalHeaders.set('authorization', `Bearer ${auth.jwt}`);\n    }\n    return (0, _expoFetch.fetch)(finalInput, {\n      ...init,\n      headers: finalHeaders\n    });\n  };\n  var _default = fetchToWeb;\n});","lineCount":105,"map":[[22,2,97,0,"Object"],[22,8,97,0],[22,9,97,0,"defineProperty"],[22,23,97,0],[22,24,97,0,"exports"],[22,31,97,0],[23,4,97,0,"enumerable"],[23,14,97,0],[24,4,97,0,"get"],[24,7,97,0],[24,18,97,0,"get"],[24,19,97,0],[25,6,97,0],[25,13,97,0,"_default"],[25,21,97,0],[26,4,97,0],[27,2,97,0],[28,2,97,26],[28,6,97,26,"_expoVirtualEnv"],[28,21,97,26],[28,24,97,26,"require"],[28,31,97,26],[28,32,97,26,"_dependencyMap"],[28,46,97,26],[29,2,1,0],[29,6,1,0,"_expoSecureStore"],[29,22,1,0],[29,25,1,0,"require"],[29,32,1,0],[29,33,1,0,"_dependencyMap"],[29,47,1,0],[30,2,1,0],[30,6,1,0,"SecureStore"],[30,17,1,0],[30,20,1,0,"_interopNamespace"],[30,37,1,0],[30,38,1,0,"_expoSecureStore"],[30,54,1,0],[31,2,2,0],[31,6,2,0,"_expoFetch"],[31,16,2,0],[31,19,2,0,"require"],[31,26,2,0],[31,27,2,0,"_dependencyMap"],[31,41,2,0],[32,2,4,0],[32,8,4,6,"originalFetch"],[32,21,4,19],[32,24,4,22,"fetch"],[32,29,4,27],[33,2,5,0],[33,8,5,6,"authKey"],[33,15,5,13],[33,18,5,16],[33,21,5,16,"_expoVirtualEnv"],[33,36,5,16],[33,37,5,16,"env"],[33,40,5,16],[33,41,5,16,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[33,69,5,16],[33,75,5,65],[34,2,7,0],[34,8,7,6,"getURLFromArgs"],[34,22,7,20],[34,25,7,23,"getURLFromArgs"],[34,26,7,24],[34,29,7,27,"args"],[34,33,7,57],[34,38,7,62],[35,4,8,2],[35,10,8,8],[35,11,8,9,"urlArg"],[35,17,8,15],[35,18,8,16],[35,21,8,19,"args"],[35,25,8,23],[36,4,9,2],[36,8,9,6,"url"],[36,11,9,24],[37,4,10,2],[37,8,10,6],[37,15,10,13,"urlArg"],[37,21,10,19],[37,26,10,24],[37,34,10,32],[37,36,10,34],[38,6,11,4,"url"],[38,9,11,7],[38,12,11,10,"urlArg"],[38,18,11,16],[39,4,12,2],[39,5,12,3],[39,11,12,9],[39,15,12,13],[39,22,12,20,"urlArg"],[39,28,12,26],[39,33,12,31],[39,41,12,39],[39,45,12,43,"urlArg"],[39,51,12,49],[39,56,12,54],[39,60,12,58],[39,62,12,60],[40,6,13,4,"url"],[40,9,13,7],[40,12,13,10,"urlArg"],[40,18,13,16],[40,19,13,17,"url"],[40,22,13,20],[41,4,14,2],[41,5,14,3],[41,11,14,9],[42,6,15,4,"url"],[42,9,15,7],[42,12,15,10],[42,16,15,14],[43,4,16,2],[44,4,17,2],[44,11,17,9,"url"],[44,14,17,12],[45,2,18,0],[45,3,18,1],[46,2,20,0],[46,8,20,6,"isFileURL"],[46,17,20,15],[46,20,20,19,"url"],[46,23,20,30],[46,27,20,35],[47,4,21,2],[47,11,21,9,"url"],[47,14,21,12],[47,15,21,13,"startsWith"],[47,25,21,23],[47,26,21,24],[47,35,21,33],[47,36,21,34],[47,40,21,38,"url"],[47,43,21,41],[47,44,21,42,"startsWith"],[47,54,21,52],[47,55,21,53],[47,62,21,60],[47,63,21,61],[48,2,22,0],[48,3,22,1],[49,2,24,0],[49,8,24,6,"isFirstPartyURL"],[49,23,24,21],[49,26,24,25,"url"],[49,29,24,36],[49,33,24,41],[50,4,25,2],[50,11,26,4,"url"],[50,14,26,7],[50,15,26,8,"startsWith"],[50,25,26,18],[50,26,26,19],[50,29,26,22],[50,30,26,23],[50,34,27,5,"_expoVirtualEnv"],[50,49,27,5],[50,50,27,5,"env"],[50,53,27,5],[50,54,27,5,"EXPO_PUBLIC_BASE_URL"],[50,74,27,5],[50,78,27,41,"url"],[50,81,27,44],[50,82,27,45,"startsWith"],[50,92,27,55],[50,93,27,55,"_expoVirtualEnv"],[50,108,27,55],[50,109,27,55,"env"],[50,112,27,55],[50,113,27,55,"EXPO_PUBLIC_BASE_URL"],[50,133,27,88],[50,134,27,90],[51,2,29,0],[51,3,29,1],[52,2,31,0],[52,8,31,6,"isSecondPartyURL"],[52,24,31,22],[52,27,31,26,"url"],[52,30,31,37],[52,34,31,42],[53,4,32,2],[53,11,32,9,"url"],[53,14,32,12],[53,15,32,13,"startsWith"],[53,25,32,23],[53,26,32,24],[53,37,32,35],[53,38,32,36],[54,2,33,0],[54,3,33,1],[55,2,36,0],[55,8,36,6,"fetchToWeb"],[55,18,36,16],[55,21,36,19],[55,36,36,34,"fetchWithHeaders"],[55,52,36,50,"fetchWithHeaders"],[55,53,36,51],[55,56,36,54,"args"],[55,60,36,66],[55,62,36,68],[56,4,37,2],[56,10,37,8,"firstPartyURL"],[56,23,37,21],[56,26,37,21,"_expoVirtualEnv"],[56,41,37,21],[56,42,37,21,"env"],[56,45,37,21],[56,46,37,21,"EXPO_PUBLIC_BASE_URL"],[56,66,37,56],[57,4,38,2],[57,10,38,8,"secondPartyURL"],[57,24,38,22],[57,27,38,22,"_expoVirtualEnv"],[57,42,38,22],[57,43,38,22,"env"],[57,46,38,22],[57,47,38,22,"EXPO_PUBLIC_PROXY_BASE_URL"],[57,73,38,63],[58,4,39,2],[58,10,39,8],[58,11,39,9,"input"],[58,16,39,14],[58,18,39,16,"init"],[58,22,39,20],[58,23,39,21],[58,26,39,24,"args"],[58,30,39,28],[59,4,40,2],[59,10,40,8,"url"],[59,13,40,11],[59,16,40,14,"getURLFromArgs"],[59,30,40,28],[59,31,40,29,"input"],[59,36,40,34],[59,38,40,36,"init"],[59,42,40,40],[59,43,40,41],[60,4,41,2],[60,8,41,6],[60,9,41,7,"url"],[60,12,41,10],[60,14,41,12],[61,6,42,4],[61,13,42,11],[61,17,42,11,"expoFetch"],[61,27,42,20],[61,28,42,20,"fetch"],[61,33,42,20],[61,35,42,21,"input"],[61,40,42,26],[61,42,42,28,"init"],[61,46,42,32],[61,47,42,33],[62,4,43,2],[63,4,45,2],[63,8,45,6,"isFileURL"],[63,17,45,15],[63,18,45,16,"url"],[63,21,45,19],[63,22,45,20],[63,24,45,22],[64,6,46,4],[64,13,46,11,"originalFetch"],[64,26,46,24],[64,27,46,25,"input"],[64,32,46,30],[64,34,46,32,"init"],[64,38,46,36],[64,39,46,37],[65,4,47,2],[66,4,49,2],[66,10,49,8,"isExternalFetch"],[66,25,49,23],[66,28,49,26],[66,29,49,27,"isFirstPartyURL"],[66,44,49,42],[66,45,49,43,"url"],[66,48,49,46],[66,49,49,47],[67,4,50,2],[68,4,51,2],[68,8,51,6,"isExternalFetch"],[68,23,51,21],[68,25,51,23],[69,6,52,4],[69,13,52,11],[69,17,52,11,"expoFetch"],[69,27,52,20],[69,28,52,20,"fetch"],[69,33,52,20],[69,35,52,21,"input"],[69,40,52,26],[69,42,52,28,"init"],[69,46,52,32],[69,47,52,33],[70,4,53,2],[71,4,55,2],[71,8,55,6,"finalInput"],[71,18,55,16],[71,21,55,19,"input"],[71,26,55,24],[72,4,56,2],[72,10,56,8,"baseURL"],[72,17,56,15],[72,20,56,18,"isSecondPartyURL"],[72,36,56,34],[72,37,56,35,"url"],[72,40,56,38],[72,41,56,39],[72,44,56,42,"secondPartyURL"],[72,58,56,56],[72,61,56,59,"firstPartyURL"],[72,74,56,72],[73,4,57,2],[73,8,57,6],[73,15,57,13,"input"],[73,20,57,18],[73,25,57,23],[73,33,57,31],[73,35,57,33],[74,6,58,4,"finalInput"],[74,16,58,14],[74,19,58,17,"input"],[74,24,58,22],[74,25,58,23,"startsWith"],[74,35,58,33],[74,36,58,34],[74,39,58,37],[74,40,58,38],[74,43,58,41],[74,46,58,44,"baseURL"],[74,53,58,51],[74,56,58,54,"input"],[74,61,58,59],[74,63,58,61],[74,66,58,64,"input"],[74,71,58,69],[75,4,59,2],[75,5,59,3],[75,11,59,9],[76,6,60,4],[76,13,60,11],[76,17,60,11,"expoFetch"],[76,27,60,20],[76,28,60,20,"fetch"],[76,33,60,20],[76,35,60,21,"input"],[76,40,60,26],[76,42,60,28,"init"],[76,46,60,32],[76,47,60,33],[77,4,61,2],[78,4,63,2],[78,10,63,8,"initHeaders"],[78,21,63,19],[78,24,63,22,"init"],[78,28,63,26],[78,30,63,28,"headers"],[78,37,63,35],[78,41,63,39],[78,42,63,40],[78,43,63,41],[79,4,64,2],[79,10,64,8,"finalHeaders"],[79,22,64,20],[79,25,64,23],[79,29,64,27,"Headers"],[79,36,64,34],[79,37,64,35,"initHeaders"],[79,48,64,46],[79,49,64,47],[80,4,66,2],[80,10,66,8,"headers"],[80,17,66,15],[80,20,66,18],[81,6,67,4],[81,36,67,34],[81,38,67,34,"_expoVirtualEnv"],[81,53,67,34],[81,54,67,34,"env"],[81,57,67,34],[81,58,67,34,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[81,86,67,76],[82,6,68,4,"host"],[82,10,68,8],[82,12,68,8,"_expoVirtualEnv"],[82,27,68,8],[82,28,68,8,"env"],[82,31,68,8],[82,32,68,8,"EXPO_PUBLIC_HOST"],[82,48,68,38],[83,6,69,4],[83,24,69,22],[83,26,69,22,"_expoVirtualEnv"],[83,41,69,22],[83,42,69,22,"env"],[83,45,69,22],[83,46,69,22,"EXPO_PUBLIC_HOST"],[83,62,69,52],[84,6,70,4],[84,24,70,22],[84,26,70,22,"_expoVirtualEnv"],[84,41,70,22],[84,42,70,22,"env"],[84,45,70,22],[84,46,70,22,"EXPO_PUBLIC_HOST"],[85,4,71,2],[85,5,71,3],[86,4,73,2],[86,9,73,7],[86,15,73,13],[86,16,73,14,"key"],[86,19,73,17],[86,21,73,19,"value"],[86,26,73,24],[86,27,73,25],[86,31,73,29,"Object"],[86,37,73,35],[86,38,73,36,"entries"],[86,45,73,43],[86,46,73,44,"headers"],[86,53,73,51],[86,54,73,52],[86,56,73,54],[87,6,74,4],[87,10,74,8,"value"],[87,15,74,13],[87,17,74,15],[88,8,75,6,"finalHeaders"],[88,20,75,18],[88,21,75,19,"set"],[88,24,75,22],[88,25,75,23,"key"],[88,28,75,26],[88,30,75,28,"value"],[88,35,75,33],[88,36,75,34],[89,6,76,4],[90,4,77,2],[91,4,79,2],[91,10,79,8,"auth"],[91,14,79,12],[91,17,79,15],[91,23,79,21,"SecureStore"],[91,34,79,32],[91,35,79,33,"getItemAsync"],[91,47,79,45],[91,48,79,46,"authKey"],[91,55,79,53],[91,56,79,54],[91,57,80,5,"then"],[91,61,80,9],[91,62,80,11,"auth"],[91,66,80,15],[91,70,80,20],[92,6,81,6],[92,13,81,13,"auth"],[92,17,81,17],[92,20,81,20,"JSON"],[92,24,81,24],[92,25,81,25,"parse"],[92,30,81,30],[92,31,81,31,"auth"],[92,35,81,35],[92,36,81,36],[92,39,81,39],[92,43,81,43],[93,4,82,4],[93,5,82,5],[93,6,82,6],[93,7,83,5,"catch"],[93,12,83,10],[93,13,83,11],[93,19,83,17],[94,6,84,6],[94,13,84,13],[94,17,84,17],[95,4,85,4],[95,5,85,5],[95,6,85,6],[96,4,87,2],[96,8,87,6,"auth"],[96,12,87,10],[96,14,87,12],[97,6,88,4,"finalHeaders"],[97,18,88,16],[97,19,88,17,"set"],[97,22,88,20],[97,23,88,21],[97,38,88,36],[97,40,88,38],[97,50,88,48,"auth"],[97,54,88,52],[97,55,88,53,"jwt"],[97,58,88,56],[97,60,88,58],[97,61,88,59],[98,4,89,2],[99,4,91,2],[99,11,91,9],[99,15,91,9,"expoFetch"],[99,25,91,18],[99,26,91,18,"fetch"],[99,31,91,18],[99,33,91,19,"finalInput"],[99,43,91,29],[99,45,91,31],[100,6,92,4],[100,9,92,7,"init"],[100,13,92,11],[101,6,93,4,"headers"],[101,13,93,11],[101,15,93,13,"finalHeaders"],[102,4,94,2],[102,5,94,3],[102,6,94,4],[103,2,95,0],[103,3,95,1],[104,2,97,0],[104,6,97,0,"_default"],[104,14,97,0],[104,17,97,15,"fetchToWeb"],[104,27,97,25],[105,0,97,26],[105,3]],"functionMap":{"names":["<global>","getURLFromArgs","isFileURL","isFirstPartyURL","isSecondPartyURL","fetchWithHeaders","SecureStore.getItemAsync.then$argument_0","SecureStore.getItemAsync.then._catch$argument_0"],"mappings":"AAA;uBCM;CDW;kBEE;CFE;wBGE;CHK;yBIE;CJE;mBKG;UC4C;KDE;WEC;KFE;CLU"},"hasCjsExports":false},"type":"js/module"}]}