{"dependencies":[{"name":"../integration.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"B8aKvpmafw58aWtupuC7GWTMiwo=","exportNames":["*"],"imports":1}},{"name":"../metadata.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":88,"index":143}}],"key":"e+GcWU7PM4jYDq7rLAthu62vi9g=","exportNames":["*"],"imports":1}},{"name":"../utils/envelope.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":144},"end":{"line":3,"column":59,"index":203}}],"key":"yiniLg9hHeIHPDkrzeivR1oDz5o=","exportNames":["*"],"imports":1}},{"name":"../utils/stacktrace.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":204},"end":{"line":4,"column":60,"index":264}}],"key":"WpLJaT745+DkgThT6ewjxOGI2qI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"thirdPartyErrorFilterIntegration\", {\n    enumerable: true,\n    get: function () {\n      return thirdPartyErrorFilterIntegration;\n    }\n  });\n  var _integrationJs = require(_dependencyMap[0], \"../integration.js\");\n  var _metadataJs = require(_dependencyMap[1], \"../metadata.js\");\n  var _utilsEnvelopeJs = require(_dependencyMap[2], \"../utils/envelope.js\");\n  var _utilsStacktraceJs = require(_dependencyMap[3], \"../utils/stacktrace.js\");\n  /**\n   * This integration allows you to filter out, or tag error events that do not come from user code marked with a bundle key via the Sentry bundler plugins.\n   */\n  var thirdPartyErrorFilterIntegration = (0, _integrationJs.defineIntegration)(options => {\n    return {\n      name: 'ThirdPartyErrorsFilter',\n      setup(client) {\n        // We need to strip metadata from stack frames before sending them to Sentry since these are client side only.\n        client.on('beforeEnvelope', envelope => {\n          (0, _utilsEnvelopeJs.forEachEnvelopeItem)(envelope, (item, type) => {\n            if (type === 'event') {\n              var event = Array.isArray(item) ? item[1] : undefined;\n              if (event) {\n                (0, _metadataJs.stripMetadataFromStackFrames)(event);\n                item[1] = event;\n              }\n            }\n          });\n        });\n        client.on('applyFrameMetadata', event => {\n          // Only apply stack frame metadata to error events\n          if (event.type) {\n            return;\n          }\n          var stackParser = client.getOptions().stackParser;\n          (0, _metadataJs.addMetadataToStackFrames)(stackParser, event);\n        });\n      },\n      processEvent(event) {\n        var frameKeys = getBundleKeysForAllFramesWithFilenames(event);\n        if (frameKeys) {\n          var arrayMethod = options.behaviour === 'drop-error-if-contains-third-party-frames' || options.behaviour === 'apply-tag-if-contains-third-party-frames' ? 'some' : 'every';\n          var behaviourApplies = frameKeys[arrayMethod](keys => !keys.some(key => options.filterKeys.includes(key)));\n          if (behaviourApplies) {\n            var shouldDrop = options.behaviour === 'drop-error-if-contains-third-party-frames' || options.behaviour === 'drop-error-if-exclusively-contains-third-party-frames';\n            if (shouldDrop) {\n              return null;\n            } else {\n              event.tags = {\n                ...event.tags,\n                third_party_code: true\n              };\n            }\n          }\n        }\n        return event;\n      }\n    };\n  });\n  function getBundleKeysForAllFramesWithFilenames(event) {\n    var frames = (0, _utilsStacktraceJs.getFramesFromEvent)(event);\n    if (!frames) {\n      return undefined;\n    }\n    return frames\n    // Exclude frames without a filename or without lineno and colno,\n    // since these are likely native code or built-ins\n    .filter(frame => !!frame.filename && (frame.lineno ?? frame.colno) != null).map(frame => {\n      if (frame.module_metadata) {\n        return Object.keys(frame.module_metadata).filter(key => key.startsWith(BUNDLER_PLUGIN_APP_KEY_PREFIX)).map(key => key.slice(BUNDLER_PLUGIN_APP_KEY_PREFIX.length));\n      }\n      return [];\n    });\n  }\n  var BUNDLER_PLUGIN_APP_KEY_PREFIX = '_sentryBundlerPluginAppKey:';\n});","lineCount":82,"map":[[7,2,95,0,"Object"],[7,8,95,0],[7,9,95,0,"defineProperty"],[7,23,95,0],[7,24,95,0,"exports"],[7,31,95,0],[8,4,95,0,"enumerable"],[8,14,95,0],[9,4,95,0,"get"],[9,7,95,0],[9,18,95,0,"get"],[9,19,95,0],[10,6,95,0],[10,13,95,9,"thirdPartyErrorFilterIntegration"],[10,45,95,41],[11,4,95,41],[12,2,95,41],[13,2,1,0],[13,6,1,0,"_integrationJs"],[13,20,1,0],[13,23,1,0,"require"],[13,30,1,0],[13,31,1,0,"_dependencyMap"],[13,45,1,0],[14,2,2,0],[14,6,2,0,"_metadataJs"],[14,17,2,0],[14,20,2,0,"require"],[14,27,2,0],[14,28,2,0,"_dependencyMap"],[14,42,2,0],[15,2,3,0],[15,6,3,0,"_utilsEnvelopeJs"],[15,22,3,0],[15,25,3,0,"require"],[15,32,3,0],[15,33,3,0,"_dependencyMap"],[15,47,3,0],[16,2,4,0],[16,6,4,0,"_utilsStacktraceJs"],[16,24,4,0],[16,27,4,0,"require"],[16,34,4,0],[16,35,4,0,"_dependencyMap"],[16,49,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,2,9,0],[20,6,9,6,"thirdPartyErrorFilterIntegration"],[20,38,9,38],[20,41,9,41],[20,45,9,41,"defineIntegration"],[20,59,9,58],[20,60,9,58,"defineIntegration"],[20,77,9,58],[20,79,9,60,"options"],[20,86,9,67],[20,90,9,72],[21,4,10,2],[21,11,10,9],[22,6,11,4,"name"],[22,10,11,8],[22,12,11,10],[22,36,11,34],[23,6,12,4,"setup"],[23,11,12,9,"setup"],[23,12,12,10,"client"],[23,18,12,16],[23,20,12,18],[24,8,13,6],[25,8,14,6,"client"],[25,14,14,12],[25,15,14,13,"on"],[25,17,14,15],[25,18,14,16],[25,34,14,32],[25,36,14,34,"envelope"],[25,44,14,42],[25,48,14,46],[26,10,15,8],[26,14,15,8,"forEachEnvelopeItem"],[26,30,15,27],[26,31,15,27,"forEachEnvelopeItem"],[26,50,15,27],[26,52,15,28,"envelope"],[26,60,15,36],[26,62,15,38],[26,63,15,39,"item"],[26,67,15,43],[26,69,15,45,"type"],[26,73,15,49],[26,78,15,54],[27,12,16,10],[27,16,16,14,"type"],[27,20,16,18],[27,25,16,23],[27,32,16,30],[27,34,16,32],[28,14,17,12],[28,18,17,18,"event"],[28,23,17,23],[28,26,17,26,"Array"],[28,31,17,31],[28,32,17,32,"isArray"],[28,39,17,39],[28,40,17,40,"item"],[28,44,17,44],[28,45,17,45],[28,48,17,49,"item"],[28,52,17,53],[28,53,17,56],[28,54,17,57],[28,55,17,58],[28,58,17,61,"undefined"],[28,67,17,70],[29,14,19,12],[29,18,19,16,"event"],[29,23,19,21],[29,25,19,23],[30,16,20,14],[30,20,20,14,"stripMetadataFromStackFrames"],[30,31,20,42],[30,32,20,42,"stripMetadataFromStackFrames"],[30,60,20,42],[30,62,20,43,"event"],[30,67,20,48],[30,68,20,49],[31,16,21,14,"item"],[31,20,21,18],[31,21,21,19],[31,22,21,20],[31,23,21,21],[31,26,21,24,"event"],[31,31,21,29],[32,14,22,12],[33,12,23,10],[34,10,24,8],[34,11,24,9],[34,12,24,10],[35,8,25,6],[35,9,25,7],[35,10,25,8],[36,8,27,6,"client"],[36,14,27,12],[36,15,27,13,"on"],[36,17,27,15],[36,18,27,16],[36,38,27,36],[36,40,27,38,"event"],[36,45,27,43],[36,49,27,47],[37,10,28,8],[38,10,29,8],[38,14,29,12,"event"],[38,19,29,17],[38,20,29,18,"type"],[38,24,29,22],[38,26,29,24],[39,12,30,10],[40,10,31,8],[41,10,33,8],[41,14,33,14,"stackParser"],[41,25,33,25],[41,28,33,28,"client"],[41,34,33,34],[41,35,33,35,"getOptions"],[41,45,33,45],[41,46,33,46],[41,47,33,47],[41,48,33,48,"stackParser"],[41,59,33,59],[42,10,34,8],[42,14,34,8,"addMetadataToStackFrames"],[42,25,34,32],[42,26,34,32,"addMetadataToStackFrames"],[42,50,34,32],[42,52,34,33,"stackParser"],[42,63,34,44],[42,65,34,46,"event"],[42,70,34,51],[42,71,34,52],[43,8,35,6],[43,9,35,7],[43,10,35,8],[44,6,36,4],[44,7,36,5],[45,6,38,4,"processEvent"],[45,18,38,16,"processEvent"],[45,19,38,17,"event"],[45,24,38,22],[45,26,38,24],[46,8,39,6],[46,12,39,12,"frameKeys"],[46,21,39,21],[46,24,39,24,"getBundleKeysForAllFramesWithFilenames"],[46,62,39,62],[46,63,39,63,"event"],[46,68,39,68],[46,69,39,69],[47,8,41,6],[47,12,41,10,"frameKeys"],[47,21,41,19],[47,23,41,21],[48,10,42,8],[48,14,42,14,"arrayMethod"],[48,25,42,25],[48,28,43,10,"options"],[48,35,43,17],[48,36,43,18,"behaviour"],[48,45,43,27],[48,50,43,32],[48,93,43,75],[48,97,44,10,"options"],[48,104,44,17],[48,105,44,18,"behaviour"],[48,114,44,27],[48,119,44,32],[48,161,44,74],[48,164,45,14],[48,170,45,20],[48,173,46,14],[48,180,46,21],[49,10,48,8],[49,14,48,14,"behaviourApplies"],[49,30,48,30],[49,33,48,33,"frameKeys"],[49,42,48,42],[49,43,48,43,"arrayMethod"],[49,54,48,54],[49,55,48,55],[49,56,48,56,"keys"],[49,60,48,60],[49,64,48,64],[49,65,48,65,"keys"],[49,69,48,69],[49,70,48,70,"some"],[49,74,48,74],[49,75,48,75,"key"],[49,78,48,78],[49,82,48,82,"options"],[49,89,48,89],[49,90,48,90,"filterKeys"],[49,100,48,100],[49,101,48,101,"includes"],[49,109,48,109],[49,110,48,110,"key"],[49,113,48,113],[49,114,48,114],[49,115,48,115],[49,116,48,116],[50,10,50,8],[50,14,50,12,"behaviourApplies"],[50,30,50,28],[50,32,50,30],[51,12,51,10],[51,16,51,16,"shouldDrop"],[51,26,51,26],[51,29,52,12,"options"],[51,36,52,19],[51,37,52,20,"behaviour"],[51,46,52,29],[51,51,52,34],[51,94,52,77],[51,98,53,12,"options"],[51,105,53,19],[51,106,53,20,"behaviour"],[51,115,53,29],[51,120,53,34],[51,175,53,89],[52,12,54,10],[52,16,54,14,"shouldDrop"],[52,26,54,24],[52,28,54,26],[53,14,55,12],[53,21,55,19],[53,25,55,23],[54,12,56,10],[54,13,56,11],[54,19,56,17],[55,14,57,12,"event"],[55,19,57,17],[55,20,57,18,"tags"],[55,24,57,22],[55,27,57,25],[56,16,58,14],[56,19,58,17,"event"],[56,24,58,22],[56,25,58,23,"tags"],[56,29,58,27],[57,16,59,14,"third_party_code"],[57,32,59,30],[57,34,59,32],[58,14,60,12],[58,15,60,13],[59,12,61,10],[60,10,62,8],[61,8,63,6],[62,8,65,6],[62,15,65,13,"event"],[62,20,65,18],[63,6,66,4],[64,4,67,2],[64,5,67,3],[65,2,68,0],[65,3,68,1],[65,4,68,2],[66,2,70,0],[66,11,70,9,"getBundleKeysForAllFramesWithFilenames"],[66,49,70,47,"getBundleKeysForAllFramesWithFilenames"],[66,50,70,48,"event"],[66,55,70,53],[66,57,70,55],[67,4,71,2],[67,8,71,8,"frames"],[67,14,71,14],[67,17,71,17],[67,21,71,17,"getFramesFromEvent"],[67,39,71,35],[67,40,71,35,"getFramesFromEvent"],[67,58,71,35],[67,60,71,36,"event"],[67,65,71,41],[67,66,71,42],[68,4,73,2],[68,8,73,6],[68,9,73,7,"frames"],[68,15,73,13],[68,17,73,15],[69,6,74,4],[69,13,74,11,"undefined"],[69,22,74,20],[70,4,75,2],[71,4,77,2],[71,11,78,4,"frames"],[72,4,79,6],[73,4,80,6],[74,4,80,6],[74,5,81,7,"filter"],[74,11,81,13],[74,12,81,14,"frame"],[74,17,81,19],[74,21,81,23],[74,22,81,24],[74,23,81,25,"frame"],[74,28,81,30],[74,29,81,31,"filename"],[74,37,81,39],[74,41,81,43],[74,42,81,44,"frame"],[74,47,81,49],[74,48,81,50,"lineno"],[74,54,81,56],[74,58,81,60,"frame"],[74,63,81,65],[74,64,81,66,"colno"],[74,69,81,71],[74,74,81,76],[74,78,81,80],[74,79,81,81],[74,80,82,7,"map"],[74,83,82,10],[74,84,82,11,"frame"],[74,89,82,16],[74,93,82,20],[75,6,83,8],[75,10,83,12,"frame"],[75,15,83,17],[75,16,83,18,"module_metadata"],[75,31,83,33],[75,33,83,35],[76,8,84,10],[76,15,84,17,"Object"],[76,21,84,23],[76,22,84,24,"keys"],[76,26,84,28],[76,27,84,29,"frame"],[76,32,84,34],[76,33,84,35,"module_metadata"],[76,48,84,50],[76,49,84,51],[76,50,85,13,"filter"],[76,56,85,19],[76,57,85,20,"key"],[76,60,85,23],[76,64,85,27,"key"],[76,67,85,30],[76,68,85,31,"startsWith"],[76,78,85,41],[76,79,85,42,"BUNDLER_PLUGIN_APP_KEY_PREFIX"],[76,108,85,71],[76,109,85,72],[76,110,85,73],[76,111,86,13,"map"],[76,114,86,16],[76,115,86,17,"key"],[76,118,86,20],[76,122,86,24,"key"],[76,125,86,27],[76,126,86,28,"slice"],[76,131,86,33],[76,132,86,34,"BUNDLER_PLUGIN_APP_KEY_PREFIX"],[76,161,86,63],[76,162,86,64,"length"],[76,168,86,70],[76,169,86,71],[76,170,86,72],[77,6,87,8],[78,6,88,8],[78,13,88,15],[78,15,88,17],[79,4,89,6],[79,5,89,7],[79,6,89,8],[80,2,91,0],[81,2,93,0],[81,6,93,6,"BUNDLER_PLUGIN_APP_KEY_PREFIX"],[81,35,93,35],[81,38,93,38],[81,67,93,67],[82,0,93,68],[82,3]],"functionMap":{"names":["<global>","defineIntegration$argument_0","setup","client.on$argument_1","forEachEnvelopeItem$argument_1","processEvent","frameKeys.arrayMethod$argument_0","keys.some$argument_0","getBundleKeysForAllFramesWithFilenames","frames.filter$argument_0","frames.filter.map$argument_0","Object.keys.filter$argument_0","Object.keys.filter.map$argument_0"],"mappings":"AAA;2DCQ;ICG;kCCE;sCCC;SDS;ODC;sCCE;ODQ;KDC;IIE;wDCU,mBC,uCD,CD;KJkB;CDE;AQE;cCW,kED;WEC;oBCG,oDD;iBEC,sDF;OFG;CRE"},"hasCjsExports":false},"type":"js/module"}]}