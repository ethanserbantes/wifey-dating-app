{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"setActiveSpanInBrowser\", {\n    enumerable: true,\n    get: function () {\n      return setActiveSpanInBrowser;\n    }\n  });\n  var _sentryCore = require(_dependencyMap[0], \"@sentry/core\");\n  /**\n   * Sets an inactive span active on the current scope.\n   *\n   * This is useful in browser applications, if you want to create a span that cannot be finished\n   * within its callback. Any spans started while the given span is active, will be children of the span.\n   *\n   * If there already was an active span on the scope prior to calling this function, it is replaced\n   * with the given span and restored after the span ended. Otherwise, the span will simply be\n   * removed, resulting in no active span on the scope.\n   *\n   * IMPORTANT: This function can ONLY be used in the browser! Calling this function in a server\n   * environment (for example in a server-side rendered component) will result in undefined behaviour\n   * and is not supported.\n   * You MUST call `span.end()` manually, otherwise the span will never be finished.\n   *\n   * @example\n   * ```js\n   * let checkoutSpan;\n   *\n   * on('checkoutStarted', () => {\n   *  checkoutSpan = Sentry.startInactiveSpan({ name: 'checkout-flow' });\n   *  Sentry.setActiveSpanInBrowser(checkoutSpan);\n   * })\n   *\n   * // during this time, any spans started will be children of `checkoutSpan`:\n   * Sentry.startSpan({ name: 'checkout-step-1' }, () => {\n   *  // ... `\n   * })\n   *\n   * on('checkoutCompleted', () => {\n   *  checkoutSpan?.end();\n   * })\n   * ```\n   *\n   * @param span - the span to set active\n   */\n  function setActiveSpanInBrowser(span) {\n    var maybePreviousActiveSpan = (0, _sentryCore.getActiveSpan)();\n\n    // If the span is already active, there's no need to double-patch or set it again.\n    // This also guards against users (for whatever reason) calling setActiveSpanInBrowser on SDK-started\n    // idle spans like pageload or navigation spans. These will already be handled correctly by the SDK.\n    // For nested situations, we have to double-patch to ensure we restore the correct previous span (see tests)\n    if (maybePreviousActiveSpan === span) {\n      return;\n    }\n    var scope = (0, _sentryCore.getCurrentScope)();\n\n    // Putting a small patch onto the span.end method to ensure we\n    // remove the span from the scope when it ends.\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    span.end = new Proxy(span.end, {\n      apply(target, thisArg, args) {\n        (0, _sentryCore._INTERNAL_setSpanForScope)(scope, maybePreviousActiveSpan);\n        return Reflect.apply(target, thisArg, args);\n      }\n    });\n    (0, _sentryCore._INTERNAL_setSpanForScope)(scope, span);\n  }\n});","lineCount":73,"map":[[7,2,65,0,"Object"],[7,8,65,0],[7,9,65,0,"defineProperty"],[7,23,65,0],[7,24,65,0,"exports"],[7,31,65,0],[8,4,65,0,"enumerable"],[8,14,65,0],[9,4,65,0,"get"],[9,7,65,0],[9,18,65,0,"get"],[9,19,65,0],[10,6,65,0],[10,13,65,9,"setActiveSpanInBrowser"],[10,35,65,31],[11,4,65,31],[12,2,65,31],[13,2,1,0],[13,6,1,0,"_sentryCore"],[13,17,1,0],[13,20,1,0,"require"],[13,27,1,0],[13,28,1,0,"_dependencyMap"],[13,42,1,0],[14,2,3,0],[15,0,4,0],[16,0,5,0],[17,0,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,0,15,0],[27,0,16,0],[28,0,17,0],[29,0,18,0],[30,0,19,0],[31,0,20,0],[32,0,21,0],[33,0,22,0],[34,0,23,0],[35,0,24,0],[36,0,25,0],[37,0,26,0],[38,0,27,0],[39,0,28,0],[40,0,29,0],[41,0,30,0],[42,0,31,0],[43,0,32,0],[44,0,33,0],[45,0,34,0],[46,0,35,0],[47,0,36,0],[48,0,37,0],[49,0,38,0],[50,2,39,0],[50,11,39,9,"setActiveSpanInBrowser"],[50,33,39,31,"setActiveSpanInBrowser"],[50,34,39,32,"span"],[50,38,39,36],[50,40,39,38],[51,4,40,2],[51,8,40,8,"maybePreviousActiveSpan"],[51,31,40,31],[51,34,40,34],[51,38,40,34,"getActiveSpan"],[51,49,40,47],[51,50,40,47,"getActiveSpan"],[51,63,40,47],[51,65,40,48],[51,66,40,49],[53,4,42,2],[54,4,43,2],[55,4,44,2],[56,4,45,2],[57,4,46,2],[57,8,46,6,"maybePreviousActiveSpan"],[57,31,46,29],[57,36,46,34,"span"],[57,40,46,38],[57,42,46,40],[58,6,47,4],[59,4,48,2],[60,4,50,2],[60,8,50,8,"scope"],[60,13,50,13],[60,16,50,16],[60,20,50,16,"getCurrentScope"],[60,31,50,31],[60,32,50,31,"getCurrentScope"],[60,47,50,31],[60,49,50,32],[60,50,50,33],[62,4,52,2],[63,4,53,2],[64,4,54,2],[65,4,55,2,"span"],[65,8,55,6],[65,9,55,7,"end"],[65,12,55,10],[65,15,55,13],[65,19,55,17,"Proxy"],[65,24,55,22],[65,25,55,23,"span"],[65,29,55,27],[65,30,55,28,"end"],[65,33,55,31],[65,35,55,33],[66,6,56,4,"apply"],[66,11,56,9,"apply"],[66,12,56,10,"target"],[66,18,56,16],[66,20,56,18,"thisArg"],[66,27,56,25],[66,29,56,27,"args"],[66,33,56,31],[66,35,56,33],[67,8,57,6],[67,12,57,6,"_INTERNAL_setSpanForScope"],[67,23,57,31],[67,24,57,31,"_INTERNAL_setSpanForScope"],[67,49,57,31],[67,51,57,32,"scope"],[67,56,57,37],[67,58,57,39,"maybePreviousActiveSpan"],[67,81,57,62],[67,82,57,63],[68,8,58,6],[68,15,58,13,"Reflect"],[68,22,58,20],[68,23,58,21,"apply"],[68,28,58,26],[68,29,58,27,"target"],[68,35,58,33],[68,37,58,35,"thisArg"],[68,44,58,42],[68,46,58,44,"args"],[68,50,58,48],[68,51,58,49],[69,6,59,4],[70,4,60,2],[70,5,60,3],[70,6,60,4],[71,4,62,2],[71,8,62,2,"_INTERNAL_setSpanForScope"],[71,19,62,27],[71,20,62,27,"_INTERNAL_setSpanForScope"],[71,45,62,27],[71,47,62,28,"scope"],[71,52,62,33],[71,54,62,35,"span"],[71,58,62,39],[71,59,62,40],[72,2,63,0],[73,0,63,1],[73,3]],"functionMap":{"names":["<global>","setActiveSpanInBrowser","Proxy$argument_1.apply"],"mappings":"AAA;ACsC;ICiB;KDG;CDI"},"hasCjsExports":false},"type":"js/module"}]}