{"dependencies":[{"name":"./is.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":37,"index":37}}],"key":"C6fLnEQPNIdj7xXbougAJ0zoinA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"handleCallbackErrors\", {\n    enumerable: true,\n    get: function () {\n      return handleCallbackErrors;\n    }\n  });\n  var _isJs = require(_dependencyMap[0], \"./is.js\");\n  /* eslint-disable */\n  // Vendor \"Awaited\" in to be TS 3.8 compatible\n\n  /**\n   * Wrap a callback function with error handling.\n   * If an error is thrown, it will be passed to the `onError` callback and re-thrown.\n   *\n   * If the return value of the function is a promise, it will be handled with `maybeHandlePromiseRejection`.\n   *\n   * If an `onFinally` callback is provided, this will be called when the callback has finished\n   * - so if it returns a promise, once the promise resolved/rejected,\n   * else once the callback has finished executing.\n   * The `onFinally` callback will _always_ be called, no matter if an error was thrown or not.\n   */\n  function handleCallbackErrors(fn, onError) {\n    var onFinally = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : () => {};\n    var onSuccess = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : () => {};\n    var maybePromiseResult;\n    try {\n      maybePromiseResult = fn();\n    } catch (e) {\n      onError(e);\n      onFinally();\n      throw e;\n    }\n    return maybeHandlePromiseRejection(maybePromiseResult, onError, onFinally, onSuccess);\n  }\n\n  /**\n   * Maybe handle a promise rejection.\n   * This expects to be given a value that _may_ be a promise, or any other value.\n   * If it is a promise, and it rejects, it will call the `onError` callback.\n   * Other than this, it will generally return the given value as-is.\n   */\n  function maybeHandlePromiseRejection(value, onError, onFinally, onSuccess) {\n    if ((0, _isJs.isThenable)(value)) {\n      // @ts-expect-error - the isThenable check returns the \"wrong\" type here\n      return value.then(res => {\n        onFinally();\n        onSuccess(res);\n        return res;\n      }, e => {\n        onError(e);\n        onFinally();\n        throw e;\n      });\n    }\n    onFinally();\n    onSuccess(value);\n    return value;\n  }\n});","lineCount":65,"map":[[7,2,70,0,"Object"],[7,8,70,0],[7,9,70,0,"defineProperty"],[7,23,70,0],[7,24,70,0,"exports"],[7,31,70,0],[8,4,70,0,"enumerable"],[8,14,70,0],[9,4,70,0,"get"],[9,7,70,0],[9,18,70,0,"get"],[9,19,70,0],[10,6,70,0],[10,13,70,9,"handleCallbackErrors"],[10,33,70,29],[11,4,70,29],[12,2,70,29],[13,2,1,0],[13,6,1,0,"_isJs"],[13,11,1,0],[13,14,1,0,"require"],[13,21,1,0],[13,22,1,0,"_dependencyMap"],[13,36,1,0],[14,2,3,0],[15,2,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,0,15,0],[27,0,16,0],[28,2,17,0],[28,11,17,9,"handleCallbackErrors"],[28,31,17,29,"handleCallbackErrors"],[28,32,20,2,"fn"],[28,34,20,4],[28,36,21,2,"onError"],[28,43,21,9],[28,45,24,2],[29,4,24,2],[29,8,22,2,"onFinally"],[29,17,22,11],[29,20,22,11,"arguments"],[29,29,22,11],[29,30,22,11,"length"],[29,36,22,11],[29,44,22,11,"arguments"],[29,53,22,11],[29,61,22,11,"undefined"],[29,70,22,11],[29,73,22,11,"arguments"],[29,82,22,11],[29,88,22,14],[29,94,22,20],[29,95,22,21],[29,96,22,22],[30,4,22,22],[30,8,23,2,"onSuccess"],[30,17,23,11],[30,20,23,11,"arguments"],[30,29,23,11],[30,30,23,11,"length"],[30,36,23,11],[30,44,23,11,"arguments"],[30,53,23,11],[30,61,23,11,"undefined"],[30,70,23,11],[30,73,23,11,"arguments"],[30,82,23,11],[30,88,23,14],[30,94,23,20],[30,95,23,21],[30,96,23,22],[31,4,25,2],[31,8,25,6,"maybePromiseResult"],[31,26,25,24],[32,4,26,2],[32,8,26,6],[33,6,27,4,"maybePromiseResult"],[33,24,27,22],[33,27,27,25,"fn"],[33,29,27,27],[33,30,27,28],[33,31,27,29],[34,4,28,2],[34,5,28,3],[34,6,28,4],[34,13,28,11,"e"],[34,14,28,12],[34,16,28,14],[35,6,29,4,"onError"],[35,13,29,11],[35,14,29,12,"e"],[35,15,29,13],[35,16,29,14],[36,6,30,4,"onFinally"],[36,15,30,13],[36,16,30,14],[36,17,30,15],[37,6,31,4],[37,12,31,10,"e"],[37,13,31,11],[38,4,32,2],[39,4,34,2],[39,11,34,9,"maybeHandlePromiseRejection"],[39,38,34,36],[39,39,34,37,"maybePromiseResult"],[39,57,34,55],[39,59,34,57,"onError"],[39,66,34,64],[39,68,34,66,"onFinally"],[39,77,34,75],[39,79,34,77,"onSuccess"],[39,88,34,86],[39,89,34,87],[40,2,35,0],[42,2,37,0],[43,0,38,0],[44,0,39,0],[45,0,40,0],[46,0,41,0],[47,0,42,0],[48,2,43,0],[48,11,43,9,"maybeHandlePromiseRejection"],[48,38,43,36,"maybeHandlePromiseRejection"],[48,39,44,2,"value"],[48,44,44,7],[48,46,45,2,"onError"],[48,53,45,9],[48,55,46,2,"onFinally"],[48,64,46,11],[48,66,47,2,"onSuccess"],[48,75,47,11],[48,77,48,2],[49,4,49,2],[49,8,49,6],[49,12,49,6,"isThenable"],[49,17,49,16],[49,18,49,16,"isThenable"],[49,28,49,16],[49,30,49,17,"value"],[49,35,49,22],[49,36,49,23],[49,38,49,25],[50,6,50,4],[51,6,51,4],[51,13,51,11,"value"],[51,18,51,16],[51,19,51,17,"then"],[51,23,51,21],[51,24,52,6,"res"],[51,27,52,9],[51,31,52,13],[52,8,53,8,"onFinally"],[52,17,53,17],[52,18,53,18],[52,19,53,19],[53,8,54,8,"onSuccess"],[53,17,54,17],[53,18,54,18,"res"],[53,21,54,21],[53,22,54,22],[54,8,55,8],[54,15,55,15,"res"],[54,18,55,18],[55,6,56,6],[55,7,56,7],[55,9,57,6,"e"],[55,10,57,7],[55,14,57,11],[56,8,58,8,"onError"],[56,15,58,15],[56,16,58,16,"e"],[56,17,58,17],[56,18,58,18],[57,8,59,8,"onFinally"],[57,17,59,17],[57,18,59,18],[57,19,59,19],[58,8,60,8],[58,14,60,14,"e"],[58,15,60,15],[59,6,61,6],[59,7,62,4],[59,8,62,5],[60,4,63,2],[61,4,65,2,"onFinally"],[61,13,65,11],[61,14,65,12],[61,15,65,13],[62,4,66,2,"onSuccess"],[62,13,66,11],[62,14,66,12,"value"],[62,19,66,17],[62,20,66,18],[63,4,67,2],[63,11,67,9,"value"],[63,16,67,14],[64,2,68,0],[65,0,68,1],[65,3]],"functionMap":{"names":["<global>","handleCallbackErrors","<anonymous>","maybeHandlePromiseRejection","value.then$argument_0","value.then$argument_1"],"mappings":"AAA;ACgB;cCK,QD;cCC,QD;CDY;AGQ;MCS;ODI;MEC;OFI;CHO"},"hasCjsExports":false},"type":"js/module"}]}