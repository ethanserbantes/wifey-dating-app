{"dependencies":[{"name":"../../error/GraphQLError.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":60,"index":60}}],"key":"bmIpo7jOJABVILoymQcjQyoT3Bc=","exportNames":["*"],"imports":1}},{"name":"../../language/kinds.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":61},"end":{"line":2,"column":48,"index":109}}],"key":"Pst0V1b6vjNwQXmeu75q8aBhbiU=","exportNames":["*"],"imports":1}},{"name":"../../execution/collectFields.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":110},"end":{"line":3,"column":66,"index":176}}],"key":"SZAeiHUN5V7j4jRENKabg+mNFkM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.SingleFieldSubscriptionsRule = SingleFieldSubscriptionsRule;\n  var _errorGraphQLErrorMjs = require(_dependencyMap[0], \"../../error/GraphQLError.mjs\");\n  var _languageKindsMjs = require(_dependencyMap[1], \"../../language/kinds.mjs\");\n  var _executionCollectFieldsMjs = require(_dependencyMap[2], \"../../execution/collectFields.mjs\");\n  /**\n   * Subscriptions must only include a non-introspection field.\n   *\n   * A GraphQL subscription is valid only if it contains a single root field and\n   * that root field is not an introspection field.\n   *\n   * See https://spec.graphql.org/draft/#sec-Single-root-field\n   */\n  function SingleFieldSubscriptionsRule(context) {\n    return {\n      OperationDefinition(node) {\n        if (node.operation === 'subscription') {\n          var schema = context.getSchema();\n          var subscriptionType = schema.getSubscriptionType();\n          if (subscriptionType) {\n            var operationName = node.name ? node.name.value : null;\n            var variableValues = Object.create(null);\n            var document = context.getDocument();\n            var fragments = Object.create(null);\n            for (var definition of document.definitions) {\n              if (definition.kind === _languageKindsMjs.Kind.FRAGMENT_DEFINITION) {\n                fragments[definition.name.value] = definition;\n              }\n            }\n            var fields = (0, _executionCollectFieldsMjs.collectFields)(schema, fragments, variableValues, subscriptionType, node.selectionSet);\n            if (fields.size > 1) {\n              var fieldSelectionLists = [...fields.values()];\n              var extraFieldSelectionLists = fieldSelectionLists.slice(1);\n              var extraFieldSelections = extraFieldSelectionLists.flat();\n              context.reportError(new _errorGraphQLErrorMjs.GraphQLError(operationName != null ? `Subscription \"${operationName}\" must select only one top level field.` : 'Anonymous Subscription must select only one top level field.', {\n                nodes: extraFieldSelections\n              }));\n            }\n            for (var fieldNodes of fields.values()) {\n              var field = fieldNodes[0];\n              var fieldName = field.name.value;\n              if (fieldName.startsWith('__')) {\n                context.reportError(new _errorGraphQLErrorMjs.GraphQLError(operationName != null ? `Subscription \"${operationName}\" must not select an introspection top level field.` : 'Anonymous Subscription must not select an introspection top level field.', {\n                  nodes: fieldNodes\n                }));\n              }\n            }\n          }\n        }\n      }\n    };\n  }\n});","lineCount":58,"map":[[7,2,13,0,"exports"],[7,9,13,0],[7,10,13,0,"SingleFieldSubscriptionsRule"],[7,38,13,0],[7,41,13,0,"SingleFieldSubscriptionsRule"],[7,69,13,0],[8,2,1,0],[8,6,1,0,"_errorGraphQLErrorMjs"],[8,27,1,0],[8,30,1,0,"require"],[8,37,1,0],[8,38,1,0,"_dependencyMap"],[8,52,1,0],[9,2,2,0],[9,6,2,0,"_languageKindsMjs"],[9,23,2,0],[9,26,2,0,"require"],[9,33,2,0],[9,34,2,0,"_dependencyMap"],[9,48,2,0],[10,2,3,0],[10,6,3,0,"_executionCollectFieldsMjs"],[10,32,3,0],[10,35,3,0,"require"],[10,42,3,0],[10,43,3,0,"_dependencyMap"],[10,57,3,0],[11,2,5,0],[12,0,6,0],[13,0,7,0],[14,0,8,0],[15,0,9,0],[16,0,10,0],[17,0,11,0],[18,0,12,0],[19,2,13,7],[19,11,13,16,"SingleFieldSubscriptionsRule"],[19,39,13,44,"SingleFieldSubscriptionsRule"],[19,40,13,45,"context"],[19,47,13,52],[19,49,13,54],[20,4,14,2],[20,11,14,9],[21,6,15,4,"OperationDefinition"],[21,25,15,23,"OperationDefinition"],[21,26,15,24,"node"],[21,30,15,28],[21,32,15,30],[22,8,16,6],[22,12,16,10,"node"],[22,16,16,14],[22,17,16,15,"operation"],[22,26,16,24],[22,31,16,29],[22,45,16,43],[22,47,16,45],[23,10,17,8],[23,14,17,14,"schema"],[23,20,17,20],[23,23,17,23,"context"],[23,30,17,30],[23,31,17,31,"getSchema"],[23,40,17,40],[23,41,17,41],[23,42,17,42],[24,10,18,8],[24,14,18,14,"subscriptionType"],[24,30,18,30],[24,33,18,33,"schema"],[24,39,18,39],[24,40,18,40,"getSubscriptionType"],[24,59,18,59],[24,60,18,60],[24,61,18,61],[25,10,20,8],[25,14,20,12,"subscriptionType"],[25,30,20,28],[25,32,20,30],[26,12,21,10],[26,16,21,16,"operationName"],[26,29,21,29],[26,32,21,32,"node"],[26,36,21,36],[26,37,21,37,"name"],[26,41,21,41],[26,44,21,44,"node"],[26,48,21,48],[26,49,21,49,"name"],[26,53,21,53],[26,54,21,54,"value"],[26,59,21,59],[26,62,21,62],[26,66,21,66],[27,12,22,10],[27,16,22,16,"variableValues"],[27,30,22,30],[27,33,22,33,"Object"],[27,39,22,39],[27,40,22,40,"create"],[27,46,22,46],[27,47,22,47],[27,51,22,51],[27,52,22,52],[28,12,23,10],[28,16,23,16,"document"],[28,24,23,24],[28,27,23,27,"context"],[28,34,23,34],[28,35,23,35,"getDocument"],[28,46,23,46],[28,47,23,47],[28,48,23,48],[29,12,24,10],[29,16,24,16,"fragments"],[29,25,24,25],[29,28,24,28,"Object"],[29,34,24,34],[29,35,24,35,"create"],[29,41,24,41],[29,42,24,42],[29,46,24,46],[29,47,24,47],[30,12,26,10],[30,17,26,15],[30,21,26,21,"definition"],[30,31,26,31],[30,35,26,35,"document"],[30,43,26,43],[30,44,26,44,"definitions"],[30,55,26,55],[30,57,26,57],[31,14,27,12],[31,18,27,16,"definition"],[31,28,27,26],[31,29,27,27,"kind"],[31,33,27,31],[31,38,27,36,"Kind"],[31,55,27,40],[31,56,27,40,"Kind"],[31,60,27,40],[31,61,27,41,"FRAGMENT_DEFINITION"],[31,80,27,60],[31,82,27,62],[32,16,28,14,"fragments"],[32,25,28,23],[32,26,28,24,"definition"],[32,36,28,34],[32,37,28,35,"name"],[32,41,28,39],[32,42,28,40,"value"],[32,47,28,45],[32,48,28,46],[32,51,28,49,"definition"],[32,61,28,59],[33,14,29,12],[34,12,30,10],[35,12,32,10],[35,16,32,16,"fields"],[35,22,32,22],[35,25,32,25],[35,29,32,25,"collectFields"],[35,55,32,38],[35,56,32,38,"collectFields"],[35,69,32,38],[35,71,33,12,"schema"],[35,77,33,18],[35,79,34,12,"fragments"],[35,88,34,21],[35,90,35,12,"variableValues"],[35,104,35,26],[35,106,36,12,"subscriptionType"],[35,122,36,28],[35,124,37,12,"node"],[35,128,37,16],[35,129,37,17,"selectionSet"],[35,141,38,10],[35,142,38,11],[36,12,40,10],[36,16,40,14,"fields"],[36,22,40,20],[36,23,40,21,"size"],[36,27,40,25],[36,30,40,28],[36,31,40,29],[36,33,40,31],[37,14,41,12],[37,18,41,18,"fieldSelectionLists"],[37,37,41,37],[37,40,41,40],[37,41,41,41],[37,44,41,44,"fields"],[37,50,41,50],[37,51,41,51,"values"],[37,57,41,57],[37,58,41,58],[37,59,41,59],[37,60,41,60],[38,14,42,12],[38,18,42,18,"extraFieldSelectionLists"],[38,42,42,42],[38,45,42,45,"fieldSelectionLists"],[38,64,42,64],[38,65,42,65,"slice"],[38,70,42,70],[38,71,42,71],[38,72,42,72],[38,73,42,73],[39,14,43,12],[39,18,43,18,"extraFieldSelections"],[39,38,43,38],[39,41,43,41,"extraFieldSelectionLists"],[39,65,43,65],[39,66,43,66,"flat"],[39,70,43,70],[39,71,43,71],[39,72,43,72],[40,14,44,12,"context"],[40,21,44,19],[40,22,44,20,"reportError"],[40,33,44,31],[40,34,45,14],[40,38,45,18,"GraphQLError"],[40,59,45,30],[40,60,45,30,"GraphQLError"],[40,72,45,30],[40,73,46,16,"operationName"],[40,86,46,29],[40,90,46,33],[40,94,46,37],[40,97,47,20],[40,114,47,37,"operationName"],[40,127,47,50],[40,168,47,91],[40,171,48,20],[40,233,48,82],[40,235,49,16],[41,16,50,18,"nodes"],[41,21,50,23],[41,23,50,25,"extraFieldSelections"],[42,14,51,16],[42,15,52,14],[42,16,53,12],[42,17,53,13],[43,12,54,10],[44,12,56,10],[44,17,56,15],[44,21,56,21,"fieldNodes"],[44,31,56,31],[44,35,56,35,"fields"],[44,41,56,41],[44,42,56,42,"values"],[44,48,56,48],[44,49,56,49],[44,50,56,50],[44,52,56,52],[45,14,57,12],[45,18,57,18,"field"],[45,23,57,23],[45,26,57,26,"fieldNodes"],[45,36,57,36],[45,37,57,37],[45,38,57,38],[45,39,57,39],[46,14,58,12],[46,18,58,18,"fieldName"],[46,27,58,27],[46,30,58,30,"field"],[46,35,58,35],[46,36,58,36,"name"],[46,40,58,40],[46,41,58,41,"value"],[46,46,58,46],[47,14,60,12],[47,18,60,16,"fieldName"],[47,27,60,25],[47,28,60,26,"startsWith"],[47,38,60,36],[47,39,60,37],[47,43,60,41],[47,44,60,42],[47,46,60,44],[48,16,61,14,"context"],[48,23,61,21],[48,24,61,22,"reportError"],[48,35,61,33],[48,36,62,16],[48,40,62,20,"GraphQLError"],[48,61,62,32],[48,62,62,32,"GraphQLError"],[48,74,62,32],[48,75,63,18,"operationName"],[48,88,63,31],[48,92,63,35],[48,96,63,39],[48,99,64,22],[48,116,64,39,"operationName"],[48,129,64,52],[48,182,64,105],[48,185,65,22],[48,259,65,96],[48,261,66,18],[49,18,67,20,"nodes"],[49,23,67,25],[49,25,67,27,"fieldNodes"],[50,16,68,18],[50,17,69,16],[50,18,70,14],[50,19,70,15],[51,14,71,12],[52,12,72,10],[53,10,73,8],[54,8,74,6],[55,6,75,4],[56,4,76,2],[56,5,76,3],[57,2,77,0],[58,0,77,1],[58,3]],"functionMap":{"names":["<global>","SingleFieldSubscriptionsRule","OperationDefinition"],"mappings":"AAA;OCY;ICE;KD4D;CDE"},"hasCjsExports":false},"type":"js/module"}]}