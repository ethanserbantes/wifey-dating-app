{"dependencies":[{"name":"expo-asset","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":35,"index":35}}],"key":"ZXJFWHziJpBZf3W7vl00wXf6fd8=","exportNames":["*"],"imports":1}},{"name":"expo-modules-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":36},"end":{"line":2,"column":45,"index":81}}],"key":"fU8WLIPqoAGygnPbZ/QJiQQfXEY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.resolveSource = resolveSource;\n  exports.resolveSourceWithDownload = resolveSourceWithDownload;\n  var _expoAsset = require(_dependencyMap[0], \"expo-asset\");\n  var _expoModulesCore = require(_dependencyMap[1], \"expo-modules-core\");\n  function resolveSource(source) {\n    if (typeof source === 'string') {\n      return {\n        uri: source\n      };\n    }\n    if (typeof source === 'number') {\n      const asset = _expoAsset.Asset.fromModule(source);\n      return {\n        uri: asset.uri,\n        assetId: source\n      };\n    }\n    return source ?? null;\n  }\n  /**\n   * Resolves and optionally downloads an audio source before loading.\n   * Similar to expo-av's getNativeSourceAndFullInitialStatusForLoadAsync but simplified for expo-audio.\n   */\n  async function resolveSourceWithDownload(source) {\n    let asset = null;\n    // Get asset from different source types\n    if (typeof source === 'number') {\n      asset = _expoAsset.Asset.fromModule(source);\n    } else if (source instanceof _expoAsset.Asset) {\n      asset = source;\n    } else if (typeof source === 'string') {\n      // For remote URLs, create an asset from URI\n      asset = _expoAsset.Asset.fromURI(source);\n    } else if (source && typeof source === 'object' && source.uri) {\n      // For source objects with URI\n      asset = _expoAsset.Asset.fromURI(source.uri);\n    } else if (source && typeof source === 'object' && source.assetId) {\n      // For source objects with assetId\n      asset = _expoAsset.Asset.fromModule(source.assetId);\n    }\n    if (asset) {\n      try {\n        // iOS AVPlayer fails to load the asset if the type is not set or can't be inferred\n        // since this is an audio asset, we can safely set the type to mp3 or any other audio type\n        // and iOS will be able to download and play the asset\n        // Since expo-asset caches, this will only run once per asset, as long as the asset is not deleted from the cache\n        if (!asset.type) {\n          asset = new _expoAsset.Asset({\n            name: asset.name,\n            type: 'mp3',\n            uri: asset.uri\n          });\n        }\n        // FYI: downloadAsync is a no-op on web and immediately returns a promise that resolves to the original url\n        // TODO(@hirbod): evaluate if we should implement downloadAsync for web instead\n        await asset.downloadAsync();\n        // Use the local URI if available after download\n        if (asset.localUri) {\n          let finalUri = asset.localUri;\n          // On web, we need to fetch the audio file and create a blob URL\n          // this fully downloads the file to the user's device memory and makes it available for the user to play\n          // fetch() is subject to CORS restrictions, so we need to document this for the users on web\n          // TODO(@hirbod): evaluate if we should implement a downloadAsync for web instead of using fetch here\n          if (_expoModulesCore.Platform.OS === 'web') {\n            const response = await fetch(asset.localUri);\n            const blob = await response.blob();\n            finalUri = URL.createObjectURL(blob);\n          }\n          return {\n            uri: finalUri\n          };\n        } else {\n          console.warn('No localUri found, asset may not have downloaded properly, returning the original source');\n        }\n      } catch (error) {\n        // If download fails, fall back to original source\n        console.warn('expo-audio: Failed to download asset, falling back to original source:', error);\n      }\n    }\n    // Fallback to normal resolution\n    return resolveSource(source);\n  }\n});","lineCount":89,"map":[[7,2,3,0,"exports"],[7,9,3,0],[7,10,3,0,"resolveSource"],[7,23,3,0],[7,26,3,0,"resolveSource"],[7,39,3,0],[8,2,17,0,"exports"],[8,9,17,0],[8,10,17,0,"resolveSourceWithDownload"],[8,35,17,0],[8,38,17,0,"resolveSourceWithDownload"],[8,63,17,0],[9,2,1,0],[9,6,1,0,"_expoAsset"],[9,16,1,0],[9,19,1,0,"require"],[9,26,1,0],[9,27,1,0,"_dependencyMap"],[9,41,1,0],[10,2,2,0],[10,6,2,0,"_expoModulesCore"],[10,22,2,0],[10,25,2,0,"require"],[10,32,2,0],[10,33,2,0,"_dependencyMap"],[10,47,2,0],[11,2,3,7],[11,11,3,16,"resolveSource"],[11,24,3,29,"resolveSource"],[11,25,3,30,"source"],[11,31,3,36],[11,33,3,38],[12,4,4,4],[12,8,4,8],[12,15,4,15,"source"],[12,21,4,21],[12,26,4,26],[12,34,4,34],[12,36,4,36],[13,6,5,8],[13,13,5,15],[14,8,5,17,"uri"],[14,11,5,20],[14,13,5,22,"source"],[15,6,5,29],[15,7,5,30],[16,4,6,4],[17,4,7,4],[17,8,7,8],[17,15,7,15,"source"],[17,21,7,21],[17,26,7,26],[17,34,7,34],[17,36,7,36],[18,6,8,8],[18,12,8,14,"asset"],[18,17,8,19],[18,20,8,22,"Asset"],[18,30,8,27],[18,31,8,27,"Asset"],[18,36,8,27],[18,37,8,28,"fromModule"],[18,47,8,38],[18,48,8,39,"source"],[18,54,8,45],[18,55,8,46],[19,6,9,8],[19,13,9,15],[20,8,9,17,"uri"],[20,11,9,20],[20,13,9,22,"asset"],[20,18,9,27],[20,19,9,28,"uri"],[20,22,9,31],[21,8,9,33,"assetId"],[21,15,9,40],[21,17,9,42,"source"],[22,6,9,49],[22,7,9,50],[23,4,10,4],[24,4,11,4],[24,11,11,11,"source"],[24,17,11,17],[24,21,11,21],[24,25,11,25],[25,2,12,0],[26,2,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[30,2,17,7],[30,17,17,22,"resolveSourceWithDownload"],[30,42,17,47,"resolveSourceWithDownload"],[30,43,17,48,"source"],[30,49,17,54],[30,51,17,56],[31,4,18,4],[31,8,18,8,"asset"],[31,13,18,13],[31,16,18,16],[31,20,18,20],[32,4,19,4],[33,4,20,4],[33,8,20,8],[33,15,20,15,"source"],[33,21,20,21],[33,26,20,26],[33,34,20,34],[33,36,20,36],[34,6,21,8,"asset"],[34,11,21,13],[34,14,21,16,"Asset"],[34,24,21,21],[34,25,21,21,"Asset"],[34,30,21,21],[34,31,21,22,"fromModule"],[34,41,21,32],[34,42,21,33,"source"],[34,48,21,39],[34,49,21,40],[35,4,22,4],[35,5,22,5],[35,11,23,9],[35,15,23,13,"source"],[35,21,23,19],[35,33,23,31,"Asset"],[35,43,23,36],[35,44,23,36,"Asset"],[35,49,23,36],[35,51,23,38],[36,6,24,8,"asset"],[36,11,24,13],[36,14,24,16,"source"],[36,20,24,22],[37,4,25,4],[37,5,25,5],[37,11,26,9],[37,15,26,13],[37,22,26,20,"source"],[37,28,26,26],[37,33,26,31],[37,41,26,39],[37,43,26,41],[38,6,27,8],[39,6,28,8,"asset"],[39,11,28,13],[39,14,28,16,"Asset"],[39,24,28,21],[39,25,28,21,"Asset"],[39,30,28,21],[39,31,28,22,"fromURI"],[39,38,28,29],[39,39,28,30,"source"],[39,45,28,36],[39,46,28,37],[40,4,29,4],[40,5,29,5],[40,11,30,9],[40,15,30,13,"source"],[40,21,30,19],[40,25,30,23],[40,32,30,30,"source"],[40,38,30,36],[40,43,30,41],[40,51,30,49],[40,55,30,53,"source"],[40,61,30,59],[40,62,30,60,"uri"],[40,65,30,63],[40,67,30,65],[41,6,31,8],[42,6,32,8,"asset"],[42,11,32,13],[42,14,32,16,"Asset"],[42,24,32,21],[42,25,32,21,"Asset"],[42,30,32,21],[42,31,32,22,"fromURI"],[42,38,32,29],[42,39,32,30,"source"],[42,45,32,36],[42,46,32,37,"uri"],[42,49,32,40],[42,50,32,41],[43,4,33,4],[43,5,33,5],[43,11,34,9],[43,15,34,13,"source"],[43,21,34,19],[43,25,34,23],[43,32,34,30,"source"],[43,38,34,36],[43,43,34,41],[43,51,34,49],[43,55,34,53,"source"],[43,61,34,59],[43,62,34,60,"assetId"],[43,69,34,67],[43,71,34,69],[44,6,35,8],[45,6,36,8,"asset"],[45,11,36,13],[45,14,36,16,"Asset"],[45,24,36,21],[45,25,36,21,"Asset"],[45,30,36,21],[45,31,36,22,"fromModule"],[45,41,36,32],[45,42,36,33,"source"],[45,48,36,39],[45,49,36,40,"assetId"],[45,56,36,47],[45,57,36,48],[46,4,37,4],[47,4,38,4],[47,8,38,8,"asset"],[47,13,38,13],[47,15,38,15],[48,6,39,8],[48,10,39,12],[49,8,40,12],[50,8,41,12],[51,8,42,12],[52,8,43,12],[53,8,44,12],[53,12,44,16],[53,13,44,17,"asset"],[53,18,44,22],[53,19,44,23,"type"],[53,23,44,27],[53,25,44,29],[54,10,45,16,"asset"],[54,15,45,21],[54,18,45,24],[54,22,45,28,"Asset"],[54,32,45,33],[54,33,45,33,"Asset"],[54,38,45,33],[54,39,45,34],[55,12,46,20,"name"],[55,16,46,24],[55,18,46,26,"asset"],[55,23,46,31],[55,24,46,32,"name"],[55,28,46,36],[56,12,47,20,"type"],[56,16,47,24],[56,18,47,26],[56,23,47,31],[57,12,48,20,"uri"],[57,15,48,23],[57,17,48,25,"asset"],[57,22,48,30],[57,23,48,31,"uri"],[58,10,49,16],[58,11,49,17],[58,12,49,18],[59,8,50,12],[60,8,51,12],[61,8,52,12],[62,8,53,12],[62,14,53,18,"asset"],[62,19,53,23],[62,20,53,24,"downloadAsync"],[62,33,53,37],[62,34,53,38],[62,35,53,39],[63,8,54,12],[64,8,55,12],[64,12,55,16,"asset"],[64,17,55,21],[64,18,55,22,"localUri"],[64,26,55,30],[64,28,55,32],[65,10,56,16],[65,14,56,20,"finalUri"],[65,22,56,28],[65,25,56,31,"asset"],[65,30,56,36],[65,31,56,37,"localUri"],[65,39,56,45],[66,10,57,16],[67,10,58,16],[68,10,59,16],[69,10,60,16],[70,10,61,16],[70,14,61,20,"Platform"],[70,30,61,28],[70,31,61,28,"Platform"],[70,39,61,28],[70,40,61,29,"OS"],[70,42,61,31],[70,47,61,36],[70,52,61,41],[70,54,61,43],[71,12,62,20],[71,18,62,26,"response"],[71,26,62,34],[71,29,62,37],[71,35,62,43,"fetch"],[71,40,62,48],[71,41,62,49,"asset"],[71,46,62,54],[71,47,62,55,"localUri"],[71,55,62,63],[71,56,62,64],[72,12,63,20],[72,18,63,26,"blob"],[72,22,63,30],[72,25,63,33],[72,31,63,39,"response"],[72,39,63,47],[72,40,63,48,"blob"],[72,44,63,52],[72,45,63,53],[72,46,63,54],[73,12,64,20,"finalUri"],[73,20,64,28],[73,23,64,31,"URL"],[73,26,64,34],[73,27,64,35,"createObjectURL"],[73,42,64,50],[73,43,64,51,"blob"],[73,47,64,55],[73,48,64,56],[74,10,65,16],[75,10,66,16],[75,17,66,23],[76,12,66,25,"uri"],[76,15,66,28],[76,17,66,30,"finalUri"],[77,10,66,39],[77,11,66,40],[78,8,67,12],[78,9,67,13],[78,15,68,17],[79,10,69,16,"console"],[79,17,69,23],[79,18,69,24,"warn"],[79,22,69,28],[79,23,69,29],[79,113,69,119],[79,114,69,120],[80,8,70,12],[81,6,71,8],[81,7,71,9],[81,8,72,8],[81,15,72,15,"error"],[81,20,72,20],[81,22,72,22],[82,8,73,12],[83,8,74,12,"console"],[83,15,74,19],[83,16,74,20,"warn"],[83,20,74,24],[83,21,74,25],[83,93,74,97],[83,95,74,99,"error"],[83,100,74,104],[83,101,74,105],[84,6,75,8],[85,4,76,4],[86,4,77,4],[87,4,78,4],[87,11,78,11,"resolveSource"],[87,24,78,24],[87,25,78,25,"source"],[87,31,78,31],[87,32,78,32],[88,2,79,0],[89,0,79,1],[89,3]],"functionMap":{"names":["<global>","resolveSource","resolveSourceWithDownload"],"mappings":"AAA;OCE;CDS;OEK;CF8D"},"hasCjsExports":false},"type":"js/module"}]}