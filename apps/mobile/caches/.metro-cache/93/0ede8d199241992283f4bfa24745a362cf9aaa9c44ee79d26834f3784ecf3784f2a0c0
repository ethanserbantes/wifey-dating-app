{"dependencies":[{"name":"./utils/worldwide.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":50,"index":50}}],"key":"tPhT6cWF22FdNY7qYgYOs/LcVkQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"addMetadataToStackFrames\", {\n    enumerable: true,\n    get: function () {\n      return addMetadataToStackFrames;\n    }\n  });\n  Object.defineProperty(exports, \"getMetadataForUrl\", {\n    enumerable: true,\n    get: function () {\n      return getMetadataForUrl;\n    }\n  });\n  Object.defineProperty(exports, \"stripMetadataFromStackFrames\", {\n    enumerable: true,\n    get: function () {\n      return stripMetadataFromStackFrames;\n    }\n  });\n  var _utilsWorldwideJs = require(_dependencyMap[0], \"./utils/worldwide.js\");\n  /** Keys are source filename/url, values are metadata objects. */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  var filenameMetadataMap = new Map();\n  /** Set of stack strings that have already been parsed. */\n  var parsedStacks = new Set();\n  function ensureMetadataStacksAreParsed(parser) {\n    if (!_utilsWorldwideJs.GLOBAL_OBJ._sentryModuleMetadata) {\n      return;\n    }\n    for (var stack of Object.keys(_utilsWorldwideJs.GLOBAL_OBJ._sentryModuleMetadata)) {\n      var metadata = _utilsWorldwideJs.GLOBAL_OBJ._sentryModuleMetadata[stack];\n      if (parsedStacks.has(stack)) {\n        continue;\n      }\n\n      // Ensure this stack doesn't get parsed again\n      parsedStacks.add(stack);\n      var frames = parser(stack);\n\n      // Go through the frames starting from the top of the stack and find the first one with a filename\n      for (var frame of frames.reverse()) {\n        if (frame.filename) {\n          // Save the metadata for this filename\n          filenameMetadataMap.set(frame.filename, metadata);\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * Retrieve metadata for a specific JavaScript file URL.\n   *\n   * Metadata is injected by the Sentry bundler plugins using the `_experiments.moduleMetadata` config option.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function getMetadataForUrl(parser, filename) {\n    ensureMetadataStacksAreParsed(parser);\n    return filenameMetadataMap.get(filename);\n  }\n\n  /**\n   * Adds metadata to stack frames.\n   *\n   * Metadata is injected by the Sentry bundler plugins using the `_experiments.moduleMetadata` config option.\n   */\n  function addMetadataToStackFrames(parser, event) {\n    event.exception?.values?.forEach(exception => {\n      exception.stacktrace?.frames?.forEach(frame => {\n        if (!frame.filename || frame.module_metadata) {\n          return;\n        }\n        var metadata = getMetadataForUrl(parser, frame.filename);\n        if (metadata) {\n          frame.module_metadata = metadata;\n        }\n      });\n    });\n  }\n\n  /**\n   * Strips metadata from stack frames.\n   */\n  function stripMetadataFromStackFrames(event) {\n    event.exception?.values?.forEach(exception => {\n      exception.stacktrace?.frames?.forEach(frame => {\n        delete frame.module_metadata;\n      });\n    });\n  }\n});","lineCount":96,"map":[[7,2,80,0,"Object"],[7,8,80,0],[7,9,80,0,"defineProperty"],[7,23,80,0],[7,24,80,0,"exports"],[7,31,80,0],[8,4,80,0,"enumerable"],[8,14,80,0],[9,4,80,0,"get"],[9,7,80,0],[9,18,80,0,"get"],[9,19,80,0],[10,6,80,0],[10,13,80,9,"addMetadataToStackFrames"],[10,37,80,33],[11,4,80,33],[12,2,80,33],[13,2,80,0,"Object"],[13,8,80,0],[13,9,80,0,"defineProperty"],[13,23,80,0],[13,24,80,0,"exports"],[13,31,80,0],[14,4,80,0,"enumerable"],[14,14,80,0],[15,4,80,0,"get"],[15,7,80,0],[15,18,80,0,"get"],[15,19,80,0],[16,6,80,0],[16,13,80,35,"getMetadataForUrl"],[16,30,80,52],[17,4,80,52],[18,2,80,52],[19,2,80,0,"Object"],[19,8,80,0],[19,9,80,0,"defineProperty"],[19,23,80,0],[19,24,80,0,"exports"],[19,31,80,0],[20,4,80,0,"enumerable"],[20,14,80,0],[21,4,80,0,"get"],[21,7,80,0],[21,18,80,0,"get"],[21,19,80,0],[22,6,80,0],[22,13,80,54,"stripMetadataFromStackFrames"],[22,41,80,82],[23,4,80,82],[24,2,80,82],[25,2,1,0],[25,6,1,0,"_utilsWorldwideJs"],[25,23,1,0],[25,26,1,0,"require"],[25,33,1,0],[25,34,1,0,"_dependencyMap"],[25,48,1,0],[26,2,3,0],[27,2,4,0],[28,2,5,0],[28,6,5,6,"filenameMetadataMap"],[28,25,5,25],[28,28,5,28],[28,32,5,32,"Map"],[28,35,5,35],[28,36,5,36],[28,37,5,37],[29,2,6,0],[30,2,7,0],[30,6,7,6,"parsedStacks"],[30,18,7,18],[30,21,7,21],[30,25,7,25,"Set"],[30,28,7,28],[30,29,7,29],[30,30,7,30],[31,2,9,0],[31,11,9,9,"ensureMetadataStacksAreParsed"],[31,40,9,38,"ensureMetadataStacksAreParsed"],[31,41,9,39,"parser"],[31,47,9,45],[31,49,9,47],[32,4,10,2],[32,8,10,6],[32,9,10,7,"GLOBAL_OBJ"],[32,26,10,17],[32,27,10,17,"GLOBAL_OBJ"],[32,37,10,17],[32,38,10,18,"_sentryModuleMetadata"],[32,59,10,39],[32,61,10,41],[33,6,11,4],[34,4,12,2],[35,4,14,2],[35,9,14,7],[35,13,14,13,"stack"],[35,18,14,18],[35,22,14,22,"Object"],[35,28,14,28],[35,29,14,29,"keys"],[35,33,14,33],[35,34,14,34,"GLOBAL_OBJ"],[35,51,14,44],[35,52,14,44,"GLOBAL_OBJ"],[35,62,14,44],[35,63,14,45,"_sentryModuleMetadata"],[35,84,14,66],[35,85,14,67],[35,87,14,69],[36,6,15,4],[36,10,15,10,"metadata"],[36,18,15,18],[36,21,15,21,"GLOBAL_OBJ"],[36,38,15,31],[36,39,15,31,"GLOBAL_OBJ"],[36,49,15,31],[36,50,15,32,"_sentryModuleMetadata"],[36,71,15,53],[36,72,15,54,"stack"],[36,77,15,59],[36,78,15,60],[37,6,17,4],[37,10,17,8,"parsedStacks"],[37,22,17,20],[37,23,17,21,"has"],[37,26,17,24],[37,27,17,25,"stack"],[37,32,17,30],[37,33,17,31],[37,35,17,33],[38,8,18,6],[39,6,19,4],[41,6,21,4],[42,6,22,4,"parsedStacks"],[42,18,22,16],[42,19,22,17,"add"],[42,22,22,20],[42,23,22,21,"stack"],[42,28,22,26],[42,29,22,27],[43,6,24,4],[43,10,24,10,"frames"],[43,16,24,16],[43,19,24,19,"parser"],[43,25,24,25],[43,26,24,26,"stack"],[43,31,24,31],[43,32,24,32],[45,6,26,4],[46,6,27,4],[46,11,27,9],[46,15,27,15,"frame"],[46,20,27,20],[46,24,27,24,"frames"],[46,30,27,30],[46,31,27,31,"reverse"],[46,38,27,38],[46,39,27,39],[46,40,27,40],[46,42,27,42],[47,8,28,6],[47,12,28,10,"frame"],[47,17,28,15],[47,18,28,16,"filename"],[47,26,28,24],[47,28,28,26],[48,10,29,8],[49,10,30,8,"filenameMetadataMap"],[49,29,30,27],[49,30,30,28,"set"],[49,33,30,31],[49,34,30,32,"frame"],[49,39,30,37],[49,40,30,38,"filename"],[49,48,30,46],[49,50,30,48,"metadata"],[49,58,30,56],[49,59,30,57],[50,10,31,8],[51,8,32,6],[52,6,33,4],[53,4,34,2],[54,2,35,0],[56,2,37,0],[57,0,38,0],[58,0,39,0],[59,0,40,0],[60,0,41,0],[61,2,42,0],[62,2,43,0],[62,11,43,9,"getMetadataForUrl"],[62,28,43,26,"getMetadataForUrl"],[62,29,43,27,"parser"],[62,35,43,33],[62,37,43,35,"filename"],[62,45,43,43],[62,47,43,45],[63,4,44,2,"ensureMetadataStacksAreParsed"],[63,33,44,31],[63,34,44,32,"parser"],[63,40,44,38],[63,41,44,39],[64,4,45,2],[64,11,45,9,"filenameMetadataMap"],[64,30,45,28],[64,31,45,29,"get"],[64,34,45,32],[64,35,45,33,"filename"],[64,43,45,41],[64,44,45,42],[65,2,46,0],[67,2,48,0],[68,0,49,0],[69,0,50,0],[70,0,51,0],[71,0,52,0],[72,2,53,0],[72,11,53,9,"addMetadataToStackFrames"],[72,35,53,33,"addMetadataToStackFrames"],[72,36,53,34,"parser"],[72,42,53,40],[72,44,53,42,"event"],[72,49,53,47],[72,51,53,49],[73,4,54,2,"event"],[73,9,54,7],[73,10,54,8,"exception"],[73,19,54,17],[73,21,54,19,"values"],[73,27,54,25],[73,29,54,27,"forEach"],[73,36,54,34],[73,37,54,35,"exception"],[73,46,54,44],[73,50,54,48],[74,6,55,4,"exception"],[74,15,55,13],[74,16,55,14,"stacktrace"],[74,26,55,24],[74,28,55,26,"frames"],[74,34,55,32],[74,36,55,34,"forEach"],[74,43,55,41],[74,44,55,42,"frame"],[74,49,55,47],[74,53,55,51],[75,8,56,6],[75,12,56,10],[75,13,56,11,"frame"],[75,18,56,16],[75,19,56,17,"filename"],[75,27,56,25],[75,31,56,29,"frame"],[75,36,56,34],[75,37,56,35,"module_metadata"],[75,52,56,50],[75,54,56,52],[76,10,57,8],[77,8,58,6],[78,8,60,6],[78,12,60,12,"metadata"],[78,20,60,20],[78,23,60,23,"getMetadataForUrl"],[78,40,60,40],[78,41,60,41,"parser"],[78,47,60,47],[78,49,60,49,"frame"],[78,54,60,54],[78,55,60,55,"filename"],[78,63,60,63],[78,64,60,64],[79,8,62,6],[79,12,62,10,"metadata"],[79,20,62,18],[79,22,62,20],[80,10,63,8,"frame"],[80,15,63,13],[80,16,63,14,"module_metadata"],[80,31,63,29],[80,34,63,32,"metadata"],[80,42,63,40],[81,8,64,6],[82,6,65,4],[82,7,65,5],[82,8,65,6],[83,4,66,2],[83,5,66,3],[83,6,66,4],[84,2,67,0],[86,2,69,0],[87,0,70,0],[88,0,71,0],[89,2,72,0],[89,11,72,9,"stripMetadataFromStackFrames"],[89,39,72,37,"stripMetadataFromStackFrames"],[89,40,72,38,"event"],[89,45,72,43],[89,47,72,45],[90,4,73,2,"event"],[90,9,73,7],[90,10,73,8,"exception"],[90,19,73,17],[90,21,73,19,"values"],[90,27,73,25],[90,29,73,27,"forEach"],[90,36,73,34],[90,37,73,35,"exception"],[90,46,73,44],[90,50,73,48],[91,6,74,4,"exception"],[91,15,74,13],[91,16,74,14,"stacktrace"],[91,26,74,24],[91,28,74,26,"frames"],[91,34,74,32],[91,36,74,34,"forEach"],[91,43,74,41],[91,44,74,42,"frame"],[91,49,74,47],[91,53,74,51],[92,8,75,6],[92,15,75,13,"frame"],[92,20,75,18],[92,21,75,19,"module_metadata"],[92,36,75,34],[93,6,76,4],[93,7,76,5],[93,8,76,6],[94,4,77,2],[94,5,77,3],[94,6,77,4],[95,2,78,0],[96,0,78,1],[96,3]],"functionMap":{"names":["<global>","ensureMetadataStacksAreParsed","getMetadataForUrl","addMetadataToStackFrames","event.exception.values.forEach$argument_0","exception.stacktrace.frames.forEach$argument_0","stripMetadataFromStackFrames"],"mappings":"AAA;ACQ;CD0B;AEQ;CFG;AGO;mCCC;0CCC;KDU;GDC;CHC;AMK;mCFC;0CCC;KDE;GEC;CNC"},"hasCjsExports":false},"type":"js/module"}]}