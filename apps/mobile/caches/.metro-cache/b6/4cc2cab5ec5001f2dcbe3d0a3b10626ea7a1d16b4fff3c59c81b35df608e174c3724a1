{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":65,"index":65}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":66},"end":{"line":2,"column":69,"index":135}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":136},"end":{"line":3,"column":55,"index":191}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useConversation = useConversation;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _tanstackReactQuery = require(_dependencyMap[2], \"@tanstack/react-query\");\n  function useConversation(matchId) {\n    _s();\n    const queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    const [loading, setLoading] = (0, _react.useState)(true);\n    const [messages, setMessages] = (0, _react.useState)([]);\n    const [user, setUser] = (0, _react.useState)(null);\n    const [matchInfo, setMatchInfo] = (0, _react.useState)(null);\n    const [error, setError] = (0, _react.useState)(null);\n\n    // Prevent \"Too Many Requests\" bursts when multiple parts of the chat\n    // screen trigger a refresh at the same time (tab switches, mutations, etc).\n    const messagesAbortRef = (0, _react.useRef)(null);\n    const messagesInFlightRef = (0, _react.useRef)(false);\n    const lastMessagesFetchAtRef = (0, _react.useRef)(0);\n    const rateLimitedUntilRef = (0, _react.useRef)(0);\n    const markMatchesSeen = (0, _react.useCallback)(async userId => {\n      try {\n        const resp = await fetch(\"/api/matches/mark-seen\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            userId\n          })\n        });\n        if (resp.ok) {\n          queryClient.invalidateQueries({\n            queryKey: [\"matchesSummary\", userId]\n          });\n          // NEW: keep the Messages tab dot in sync immediately (donâ€™t wait for polling)\n          queryClient.invalidateQueries({\n            queryKey: [\"matchesForBadge\", userId]\n          });\n        }\n      } catch (e) {\n        console.error(\"Could not mark matches seen\", e);\n      }\n    }, [queryClient]);\n    const loadMatchInfo = async userId => {\n      if (!matchId) return;\n      try {\n        const response = await fetch(`/api/matches/${matchId}?userId=${userId}`);\n        if (!response.ok) {\n          if (response.status === 404) {\n            setMatchInfo(null);\n            setError(prev => prev || \"This match is no longer available.\");\n            return;\n          }\n\n          // When the backend is sleeping / proxy can't reach it, avoid scary gateway text.\n          if (response.status === 502 || response.status === 503 || response.status === 504) {\n            setMatchInfo(null);\n            setError(prev => prev || \"Server is starting up. Please try again in a moment.\");\n            return;\n          }\n          const text = await response.text().catch(() => \"\");\n          throw new Error(`When fetching /api/matches/${matchId}, the response was [${response.status}] ${response.statusText} ${text}`);\n        }\n        const data = await response.json();\n        setMatchInfo(data?.match || null);\n      } catch (err) {\n        console.error(\"Error loading match info:\", err);\n        setMatchInfo(null);\n\n        // Only set the UI error if one isn't already set (messages might set it first).\n        setError(prev => prev || (err?.message ? String(err.message) : \"Could not load match info.\"));\n      }\n    };\n    const loadMessages = (0, _react.useCallback)(async userId => {\n      if (!matchId) return;\n      const now = Date.now();\n      if (now < rateLimitedUntilRef.current) {\n        return;\n      }\n\n      // throttle: avoid accidental double-fetch on mount / tab switch\n      if (now - lastMessagesFetchAtRef.current < 750) {\n        return;\n      }\n\n      // Abort any in-flight request; we only care about the latest.\n      try {\n        if (messagesAbortRef.current) {\n          messagesAbortRef.current.abort();\n        }\n      } catch {\n        // ignore\n      }\n      const controller = new AbortController();\n      messagesAbortRef.current = controller;\n      lastMessagesFetchAtRef.current = now;\n\n      // prevent re-entrancy\n      if (messagesInFlightRef.current) {\n        return;\n      }\n      messagesInFlightRef.current = true;\n      try {\n        const response = await fetch(`/api/messages/${matchId}?userId=${userId}`, {\n          signal: controller.signal\n        });\n        if (!response.ok) {\n          if (response.status === 429) {\n            // Soft-fail: keep the last good messages on screen and back off.\n            rateLimitedUntilRef.current = Date.now() + 1500;\n            return;\n          }\n          if (response.status === 404) {\n            setMessages([]);\n            setError(\"This chat is no longer available.\");\n            return;\n          }\n          if (response.status === 410) {\n            setMessages([]);\n            setError(\"This match is no longer available.\");\n            return;\n          }\n\n          // When the backend is sleeping / proxy can't reach it, avoid scary gateway text.\n          if (response.status === 502 || response.status === 503 || response.status === 504) {\n            setMessages([]);\n            setError(\"Server is starting up. Please try again in a moment.\");\n            return;\n          }\n          const text = await response.text().catch(() => \"\");\n          throw new Error(`When fetching /api/messages/${matchId}, the response was [${response.status}] ${response.statusText} ${text}`);\n        }\n        const data = await response.json();\n        const nextMessages = Array.isArray(data?.messages) ? data.messages : [];\n        setMessages(nextMessages);\n\n        // Existing: keep any cached match summaries fresh\n        queryClient.invalidateQueries({\n          queryKey: [\"matchesSummary\", userId]\n        });\n\n        // /api/messages marks the one-time \"SYSTEM_HINT\" as read.\n        queryClient.invalidateQueries({\n          queryKey: [\"matchesForBadge\", userId]\n        });\n      } catch (err) {\n        if (err?.name === \"AbortError\") {\n          return;\n        }\n        console.error(\"Error loading messages:\", err);\n        setError(err?.message ? String(err.message) : \"Could not load messages for this match.\");\n      } finally {\n        messagesInFlightRef.current = false;\n      }\n    }, [matchId, queryClient]);\n    const loadUserAndMessages = async () => {\n      if (!matchId) {\n        setLoading(true);\n        return;\n      }\n      try {\n        setError(null);\n        const userData = await AsyncStorage.default.getItem(\"user\");\n        if (!userData) {\n          setUser(null);\n          setError(\"You need to log in again.\");\n          return;\n        }\n        const parsedUser = JSON.parse(userData);\n        setUser(parsedUser);\n        await markMatchesSeen(parsedUser.id);\n        await Promise.all([loadMatchInfo(parsedUser.id), loadMessages(parsedUser.id)]);\n      } catch (err) {\n        console.error(\"Error loading conversation:\", err);\n        setError(err?.message ? String(err.message) : \"Could not load this chat.\");\n      } finally {\n        setLoading(false);\n      }\n    };\n    (0, _react.useEffect)(() => {\n      // IMPORTANT: matchId can arrive slightly after first render in expo-router.\n      // If we only run once, the thread will never load.\n      loadUserAndMessages();\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [matchId]);\n    const reloadMessages = (0, _react.useCallback)(async () => {\n      const uid = user?.id;\n      if (!uid) return;\n      if (!matchId) return;\n      await loadMessages(uid);\n    }, [loadMessages, matchId, user?.id]);\n    return {\n      loading,\n      error,\n      messages,\n      setMessages,\n      user,\n      matchInfo,\n      reloadMessages\n    };\n  }\n  _s(useConversation, \"renhz+rIyWGZsxQAWGK0ZydEfRg=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient];\n  });\n});","lineCount":218,"map":[[13,2,5,0,"exports"],[13,9,5,0],[13,10,5,0,"useConversation"],[13,25,5,0],[13,28,5,0,"useConversation"],[13,43,5,0],[14,2,1,0],[14,6,1,0,"_react"],[14,12,1,0],[14,15,1,0,"require"],[14,22,1,0],[14,23,1,0,"_dependencyMap"],[14,37,1,0],[15,2,2,0],[15,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[15,42,2,0],[15,45,2,0,"require"],[15,52,2,0],[15,53,2,0,"_dependencyMap"],[15,67,2,0],[16,2,2,0],[16,6,2,0,"AsyncStorage"],[16,18,2,0],[16,21,2,0,"_interopDefault"],[16,36,2,0],[16,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,73,2,0],[17,2,3,0],[17,6,3,0,"_tanstackReactQuery"],[17,25,3,0],[17,28,3,0,"require"],[17,35,3,0],[17,36,3,0,"_dependencyMap"],[17,50,3,0],[18,2,5,7],[18,11,5,16,"useConversation"],[18,26,5,31,"useConversation"],[18,27,5,32,"matchId"],[18,34,5,39],[18,36,5,41],[19,4,5,41,"_s"],[19,6,5,41],[20,4,6,2],[20,10,6,8,"queryClient"],[20,21,6,19],[20,24,6,22],[20,28,6,22,"useQueryClient"],[20,47,6,36],[20,48,6,36,"useQueryClient"],[20,62,6,36],[20,64,6,37],[20,65,6,38],[21,4,7,2],[21,10,7,8],[21,11,7,9,"loading"],[21,18,7,16],[21,20,7,18,"setLoading"],[21,30,7,28],[21,31,7,29],[21,34,7,32],[21,38,7,32,"useState"],[21,44,7,40],[21,45,7,40,"useState"],[21,53,7,40],[21,55,7,41],[21,59,7,45],[21,60,7,46],[22,4,8,2],[22,10,8,8],[22,11,8,9,"messages"],[22,19,8,17],[22,21,8,19,"setMessages"],[22,32,8,30],[22,33,8,31],[22,36,8,34],[22,40,8,34,"useState"],[22,46,8,42],[22,47,8,42,"useState"],[22,55,8,42],[22,57,8,43],[22,59,8,45],[22,60,8,46],[23,4,9,2],[23,10,9,8],[23,11,9,9,"user"],[23,15,9,13],[23,17,9,15,"setUser"],[23,24,9,22],[23,25,9,23],[23,28,9,26],[23,32,9,26,"useState"],[23,38,9,34],[23,39,9,34,"useState"],[23,47,9,34],[23,49,9,35],[23,53,9,39],[23,54,9,40],[24,4,10,2],[24,10,10,8],[24,11,10,9,"matchInfo"],[24,20,10,18],[24,22,10,20,"setMatchInfo"],[24,34,10,32],[24,35,10,33],[24,38,10,36],[24,42,10,36,"useState"],[24,48,10,44],[24,49,10,44,"useState"],[24,57,10,44],[24,59,10,45],[24,63,10,49],[24,64,10,50],[25,4,11,2],[25,10,11,8],[25,11,11,9,"error"],[25,16,11,14],[25,18,11,16,"setError"],[25,26,11,24],[25,27,11,25],[25,30,11,28],[25,34,11,28,"useState"],[25,40,11,36],[25,41,11,36,"useState"],[25,49,11,36],[25,51,11,37],[25,55,11,41],[25,56,11,42],[27,4,13,2],[28,4,14,2],[29,4,15,2],[29,10,15,8,"messagesAbortRef"],[29,26,15,24],[29,29,15,27],[29,33,15,27,"useRef"],[29,39,15,33],[29,40,15,33,"useRef"],[29,46,15,33],[29,48,15,34],[29,52,15,38],[29,53,15,39],[30,4,16,2],[30,10,16,8,"messagesInFlightRef"],[30,29,16,27],[30,32,16,30],[30,36,16,30,"useRef"],[30,42,16,36],[30,43,16,36,"useRef"],[30,49,16,36],[30,51,16,37],[30,56,16,42],[30,57,16,43],[31,4,17,2],[31,10,17,8,"lastMessagesFetchAtRef"],[31,32,17,30],[31,35,17,33],[31,39,17,33,"useRef"],[31,45,17,39],[31,46,17,39,"useRef"],[31,52,17,39],[31,54,17,40],[31,55,17,41],[31,56,17,42],[32,4,18,2],[32,10,18,8,"rateLimitedUntilRef"],[32,29,18,27],[32,32,18,30],[32,36,18,30,"useRef"],[32,42,18,36],[32,43,18,36,"useRef"],[32,49,18,36],[32,51,18,37],[32,52,18,38],[32,53,18,39],[33,4,20,2],[33,10,20,8,"markMatchesSeen"],[33,25,20,23],[33,28,20,26],[33,32,20,26,"useCallback"],[33,38,20,37],[33,39,20,37,"useCallback"],[33,50,20,37],[33,52,21,4],[33,58,21,11,"userId"],[33,64,21,17],[33,68,21,22],[34,6,22,6],[34,10,22,10],[35,8,23,8],[35,14,23,14,"resp"],[35,18,23,18],[35,21,23,21],[35,27,23,27,"fetch"],[35,32,23,32],[35,33,23,33],[35,57,23,57],[35,59,23,59],[36,10,24,10,"method"],[36,16,24,16],[36,18,24,18],[36,24,24,24],[37,10,25,10,"headers"],[37,17,25,17],[37,19,25,19],[38,12,25,21],[38,26,25,35],[38,28,25,37],[39,10,25,56],[39,11,25,57],[40,10,26,10,"body"],[40,14,26,14],[40,16,26,16,"JSON"],[40,20,26,20],[40,21,26,21,"stringify"],[40,30,26,30],[40,31,26,31],[41,12,26,33,"userId"],[42,10,26,40],[42,11,26,41],[43,8,27,8],[43,9,27,9],[43,10,27,10],[44,8,28,8],[44,12,28,12,"resp"],[44,16,28,16],[44,17,28,17,"ok"],[44,19,28,19],[44,21,28,21],[45,10,29,10,"queryClient"],[45,21,29,21],[45,22,29,22,"invalidateQueries"],[45,39,29,39],[45,40,29,40],[46,12,30,12,"queryKey"],[46,20,30,20],[46,22,30,22],[46,23,30,23],[46,39,30,39],[46,41,30,41,"userId"],[46,47,30,47],[47,10,31,10],[47,11,31,11],[47,12,31,12],[48,10,32,10],[49,10,33,10,"queryClient"],[49,21,33,21],[49,22,33,22,"invalidateQueries"],[49,39,33,39],[49,40,33,40],[50,12,34,12,"queryKey"],[50,20,34,20],[50,22,34,22],[50,23,34,23],[50,40,34,40],[50,42,34,42,"userId"],[50,48,34,48],[51,10,35,10],[51,11,35,11],[51,12,35,12],[52,8,36,8],[53,6,37,6],[53,7,37,7],[53,8,37,8],[53,15,37,15,"e"],[53,16,37,16],[53,18,37,18],[54,8,38,8,"console"],[54,15,38,15],[54,16,38,16,"error"],[54,21,38,21],[54,22,38,22],[54,51,38,51],[54,53,38,53,"e"],[54,54,38,54],[54,55,38,55],[55,6,39,6],[56,4,40,4],[56,5,40,5],[56,7,41,4],[56,8,41,5,"queryClient"],[56,19,41,16],[56,20,42,2],[56,21,42,3],[57,4,44,2],[57,10,44,8,"loadMatchInfo"],[57,23,44,21],[57,26,44,24],[57,32,44,31,"userId"],[57,38,44,37],[57,42,44,42],[58,6,45,4],[58,10,45,8],[58,11,45,9,"matchId"],[58,18,45,16],[58,20,45,18],[59,6,46,4],[59,10,46,8],[60,8,47,6],[60,14,47,12,"response"],[60,22,47,20],[60,25,47,23],[60,31,47,29,"fetch"],[60,36,47,34],[60,37,47,35],[60,53,47,51,"matchId"],[60,60,47,58],[60,71,47,69,"userId"],[60,77,47,75],[60,79,47,77],[60,80,47,78],[61,8,48,6],[61,12,48,10],[61,13,48,11,"response"],[61,21,48,19],[61,22,48,20,"ok"],[61,24,48,22],[61,26,48,24],[62,10,49,8],[62,14,49,12,"response"],[62,22,49,20],[62,23,49,21,"status"],[62,29,49,27],[62,34,49,32],[62,37,49,35],[62,39,49,37],[63,12,50,10,"setMatchInfo"],[63,24,50,22],[63,25,50,23],[63,29,50,27],[63,30,50,28],[64,12,51,10,"setError"],[64,20,51,18],[64,21,51,20,"prev"],[64,25,51,24],[64,29,51,29,"prev"],[64,33,51,33],[64,37,51,37],[64,73,51,73],[64,74,51,74],[65,12,52,10],[66,10,53,8],[68,10,55,8],[69,10,56,8],[69,14,57,10,"response"],[69,22,57,18],[69,23,57,19,"status"],[69,29,57,25],[69,34,57,30],[69,37,57,33],[69,41,58,10,"response"],[69,49,58,18],[69,50,58,19,"status"],[69,56,58,25],[69,61,58,30],[69,64,58,33],[69,68,59,10,"response"],[69,76,59,18],[69,77,59,19,"status"],[69,83,59,25],[69,88,59,30],[69,91,59,33],[69,93,60,10],[70,12,61,10,"setMatchInfo"],[70,24,61,22],[70,25,61,23],[70,29,61,27],[70,30,61,28],[71,12,62,10,"setError"],[71,20,62,18],[71,21,63,13,"prev"],[71,25,63,17],[71,29,64,14,"prev"],[71,33,64,18],[71,37,64,22],[71,91,65,10],[71,92,65,11],[72,12,66,10],[73,10,67,8],[74,10,69,8],[74,16,69,14,"text"],[74,20,69,18],[74,23,69,21],[74,29,69,27,"response"],[74,37,69,35],[74,38,69,36,"text"],[74,42,69,40],[74,43,69,41],[74,44,69,42],[74,45,69,43,"catch"],[74,50,69,48],[74,51,69,49],[74,57,69,55],[74,59,69,57],[74,60,69,58],[75,10,70,8],[75,16,70,14],[75,20,70,18,"Error"],[75,25,70,23],[75,26,71,10],[75,56,71,40,"matchId"],[75,63,71,47],[75,86,71,70,"response"],[75,94,71,78],[75,95,71,79,"status"],[75,101,71,85],[75,106,71,90,"response"],[75,114,71,98],[75,115,71,99,"statusText"],[75,125,71,109],[75,129,71,113,"text"],[75,133,71,117],[75,135,72,8],[75,136,72,9],[76,8,73,6],[77,8,74,6],[77,14,74,12,"data"],[77,18,74,16],[77,21,74,19],[77,27,74,25,"response"],[77,35,74,33],[77,36,74,34,"json"],[77,40,74,38],[77,41,74,39],[77,42,74,40],[78,8,75,6,"setMatchInfo"],[78,20,75,18],[78,21,75,19,"data"],[78,25,75,23],[78,27,75,25,"match"],[78,32,75,30],[78,36,75,34],[78,40,75,38],[78,41,75,39],[79,6,76,4],[79,7,76,5],[79,8,76,6],[79,15,76,13,"err"],[79,18,76,16],[79,20,76,18],[80,8,77,6,"console"],[80,15,77,13],[80,16,77,14,"error"],[80,21,77,19],[80,22,77,20],[80,49,77,47],[80,51,77,49,"err"],[80,54,77,52],[80,55,77,53],[81,8,78,6,"setMatchInfo"],[81,20,78,18],[81,21,78,19],[81,25,78,23],[81,26,78,24],[83,8,80,6],[84,8,81,6,"setError"],[84,16,81,14],[84,17,82,9,"prev"],[84,21,82,13],[84,25,83,10,"prev"],[84,29,83,14],[84,34,84,11,"err"],[84,37,84,14],[84,39,84,16,"message"],[84,46,84,23],[84,49,84,26,"String"],[84,55,84,32],[84,56,84,33,"err"],[84,59,84,36],[84,60,84,37,"message"],[84,67,84,44],[84,68,84,45],[84,71,84,48],[84,99,84,76],[84,100,85,6],[84,101,85,7],[85,6,86,4],[86,4,87,2],[86,5,87,3],[87,4,89,2],[87,10,89,8,"loadMessages"],[87,22,89,20],[87,25,89,23],[87,29,89,23,"useCallback"],[87,35,89,34],[87,36,89,34,"useCallback"],[87,47,89,34],[87,49,90,4],[87,55,90,11,"userId"],[87,61,90,17],[87,65,90,22],[88,6,91,6],[88,10,91,10],[88,11,91,11,"matchId"],[88,18,91,18],[88,20,91,20],[89,6,93,6],[89,12,93,12,"now"],[89,15,93,15],[89,18,93,18,"Date"],[89,22,93,22],[89,23,93,23,"now"],[89,26,93,26],[89,27,93,27],[89,28,93,28],[90,6,94,6],[90,10,94,10,"now"],[90,13,94,13],[90,16,94,16,"rateLimitedUntilRef"],[90,35,94,35],[90,36,94,36,"current"],[90,43,94,43],[90,45,94,45],[91,8,95,8],[92,6,96,6],[94,6,98,6],[95,6,99,6],[95,10,99,10,"now"],[95,13,99,13],[95,16,99,16,"lastMessagesFetchAtRef"],[95,38,99,38],[95,39,99,39,"current"],[95,46,99,46],[95,49,99,49],[95,52,99,52],[95,54,99,54],[96,8,100,8],[97,6,101,6],[99,6,103,6],[100,6,104,6],[100,10,104,10],[101,8,105,8],[101,12,105,12,"messagesAbortRef"],[101,28,105,28],[101,29,105,29,"current"],[101,36,105,36],[101,38,105,38],[102,10,106,10,"messagesAbortRef"],[102,26,106,26],[102,27,106,27,"current"],[102,34,106,34],[102,35,106,35,"abort"],[102,40,106,40],[102,41,106,41],[102,42,106,42],[103,8,107,8],[104,6,108,6],[104,7,108,7],[104,8,108,8],[104,14,108,14],[105,8,109,8],[106,6,109,8],[107,6,112,6],[107,12,112,12,"controller"],[107,22,112,22],[107,25,112,25],[107,29,112,29,"AbortController"],[107,44,112,44],[107,45,112,45],[107,46,112,46],[108,6,113,6,"messagesAbortRef"],[108,22,113,22],[108,23,113,23,"current"],[108,30,113,30],[108,33,113,33,"controller"],[108,43,113,43],[109,6,114,6,"lastMessagesFetchAtRef"],[109,28,114,28],[109,29,114,29,"current"],[109,36,114,36],[109,39,114,39,"now"],[109,42,114,42],[111,6,116,6],[112,6,117,6],[112,10,117,10,"messagesInFlightRef"],[112,29,117,29],[112,30,117,30,"current"],[112,37,117,37],[112,39,117,39],[113,8,118,8],[114,6,119,6],[115,6,121,6,"messagesInFlightRef"],[115,25,121,25],[115,26,121,26,"current"],[115,33,121,33],[115,36,121,36],[115,40,121,40],[116,6,123,6],[116,10,123,10],[117,8,124,8],[117,14,124,14,"response"],[117,22,124,22],[117,25,124,25],[117,31,124,31,"fetch"],[117,36,124,36],[117,37,125,10],[117,54,125,27,"matchId"],[117,61,125,34],[117,72,125,45,"userId"],[117,78,125,51],[117,80,125,53],[117,82,126,10],[118,10,127,12,"signal"],[118,16,127,18],[118,18,127,20,"controller"],[118,28,127,30],[118,29,127,31,"signal"],[119,8,128,10],[119,9,129,8],[119,10,129,9],[120,8,131,8],[120,12,131,12],[120,13,131,13,"response"],[120,21,131,21],[120,22,131,22,"ok"],[120,24,131,24],[120,26,131,26],[121,10,132,10],[121,14,132,14,"response"],[121,22,132,22],[121,23,132,23,"status"],[121,29,132,29],[121,34,132,34],[121,37,132,37],[121,39,132,39],[122,12,133,12],[123,12,134,12,"rateLimitedUntilRef"],[123,31,134,31],[123,32,134,32,"current"],[123,39,134,39],[123,42,134,42,"Date"],[123,46,134,46],[123,47,134,47,"now"],[123,50,134,50],[123,51,134,51],[123,52,134,52],[123,55,134,55],[123,59,134,59],[124,12,135,12],[125,10,136,10],[126,10,138,10],[126,14,138,14,"response"],[126,22,138,22],[126,23,138,23,"status"],[126,29,138,29],[126,34,138,34],[126,37,138,37],[126,39,138,39],[127,12,139,12,"setMessages"],[127,23,139,23],[127,24,139,24],[127,26,139,26],[127,27,139,27],[128,12,140,12,"setError"],[128,20,140,20],[128,21,140,21],[128,56,140,56],[128,57,140,57],[129,12,141,12],[130,10,142,10],[131,10,144,10],[131,14,144,14,"response"],[131,22,144,22],[131,23,144,23,"status"],[131,29,144,29],[131,34,144,34],[131,37,144,37],[131,39,144,39],[132,12,145,12,"setMessages"],[132,23,145,23],[132,24,145,24],[132,26,145,26],[132,27,145,27],[133,12,146,12,"setError"],[133,20,146,20],[133,21,146,21],[133,57,146,57],[133,58,146,58],[134,12,147,12],[135,10,148,10],[137,10,150,10],[138,10,151,10],[138,14,152,12,"response"],[138,22,152,20],[138,23,152,21,"status"],[138,29,152,27],[138,34,152,32],[138,37,152,35],[138,41,153,12,"response"],[138,49,153,20],[138,50,153,21,"status"],[138,56,153,27],[138,61,153,32],[138,64,153,35],[138,68,154,12,"response"],[138,76,154,20],[138,77,154,21,"status"],[138,83,154,27],[138,88,154,32],[138,91,154,35],[138,93,155,12],[139,12,156,12,"setMessages"],[139,23,156,23],[139,24,156,24],[139,26,156,26],[139,27,156,27],[140,12,157,12,"setError"],[140,20,157,20],[140,21,157,21],[140,75,157,75],[140,76,157,76],[141,12,158,12],[142,10,159,10],[143,10,161,10],[143,16,161,16,"text"],[143,20,161,20],[143,23,161,23],[143,29,161,29,"response"],[143,37,161,37],[143,38,161,38,"text"],[143,42,161,42],[143,43,161,43],[143,44,161,44],[143,45,161,45,"catch"],[143,50,161,50],[143,51,161,51],[143,57,161,57],[143,59,161,59],[143,60,161,60],[144,10,162,10],[144,16,162,16],[144,20,162,20,"Error"],[144,25,162,25],[144,26,163,12],[144,57,163,43,"matchId"],[144,64,163,50],[144,87,163,73,"response"],[144,95,163,81],[144,96,163,82,"status"],[144,102,163,88],[144,107,163,93,"response"],[144,115,163,101],[144,116,163,102,"statusText"],[144,126,163,112],[144,130,163,116,"text"],[144,134,163,120],[144,136,164,10],[144,137,164,11],[145,8,165,8],[146,8,167,8],[146,14,167,14,"data"],[146,18,167,18],[146,21,167,21],[146,27,167,27,"response"],[146,35,167,35],[146,36,167,36,"json"],[146,40,167,40],[146,41,167,41],[146,42,167,42],[147,8,168,8],[147,14,168,14,"nextMessages"],[147,26,168,26],[147,29,168,29,"Array"],[147,34,168,34],[147,35,168,35,"isArray"],[147,42,168,42],[147,43,168,43,"data"],[147,47,168,47],[147,49,168,49,"messages"],[147,57,168,57],[147,58,168,58],[147,61,168,61,"data"],[147,65,168,65],[147,66,168,66,"messages"],[147,74,168,74],[147,77,168,77],[147,79,168,79],[148,8,169,8,"setMessages"],[148,19,169,19],[148,20,169,20,"nextMessages"],[148,32,169,32],[148,33,169,33],[150,8,171,8],[151,8,172,8,"queryClient"],[151,19,172,19],[151,20,172,20,"invalidateQueries"],[151,37,172,37],[151,38,172,38],[152,10,172,40,"queryKey"],[152,18,172,48],[152,20,172,50],[152,21,172,51],[152,37,172,67],[152,39,172,69,"userId"],[152,45,172,75],[153,8,172,77],[153,9,172,78],[153,10,172,79],[155,8,174,8],[156,8,175,8,"queryClient"],[156,19,175,19],[156,20,175,20,"invalidateQueries"],[156,37,175,37],[156,38,175,38],[157,10,176,10,"queryKey"],[157,18,176,18],[157,20,176,20],[157,21,176,21],[157,38,176,38],[157,40,176,40,"userId"],[157,46,176,46],[158,8,177,8],[158,9,177,9],[158,10,177,10],[159,6,178,6],[159,7,178,7],[159,8,178,8],[159,15,178,15,"err"],[159,18,178,18],[159,20,178,20],[160,8,179,8],[160,12,179,12,"err"],[160,15,179,15],[160,17,179,17,"name"],[160,21,179,21],[160,26,179,26],[160,38,179,38],[160,40,179,40],[161,10,180,10],[162,8,181,8],[163,8,183,8,"console"],[163,15,183,15],[163,16,183,16,"error"],[163,21,183,21],[163,22,183,22],[163,47,183,47],[163,49,183,49,"err"],[163,52,183,52],[163,53,183,53],[164,8,184,8,"setError"],[164,16,184,16],[164,17,185,10,"err"],[164,20,185,13],[164,22,185,15,"message"],[164,29,185,22],[164,32,186,14,"String"],[164,38,186,20],[164,39,186,21,"err"],[164,42,186,24],[164,43,186,25,"message"],[164,50,186,32],[164,51,186,33],[164,54,187,14],[164,95,188,8],[164,96,188,9],[165,6,189,6],[165,7,189,7],[165,16,189,16],[166,8,190,8,"messagesInFlightRef"],[166,27,190,27],[166,28,190,28,"current"],[166,35,190,35],[166,38,190,38],[166,43,190,43],[167,6,191,6],[168,4,192,4],[168,5,192,5],[168,7,193,4],[168,8,193,5,"matchId"],[168,15,193,12],[168,17,193,14,"queryClient"],[168,28,193,25],[168,29,194,2],[168,30,194,3],[169,4,196,2],[169,10,196,8,"loadUserAndMessages"],[169,29,196,27],[169,32,196,30],[169,38,196,30,"loadUserAndMessages"],[169,39,196,30],[169,44,196,42],[170,6,197,4],[170,10,197,8],[170,11,197,9,"matchId"],[170,18,197,16],[170,20,197,18],[171,8,198,6,"setLoading"],[171,18,198,16],[171,19,198,17],[171,23,198,21],[171,24,198,22],[172,8,199,6],[173,6,200,4],[174,6,202,4],[174,10,202,8],[175,8,203,6,"setError"],[175,16,203,14],[175,17,203,15],[175,21,203,19],[175,22,203,20],[176,8,204,6],[176,14,204,12,"userData"],[176,22,204,20],[176,25,204,23],[176,31,204,29,"AsyncStorage"],[176,43,204,41],[176,44,204,41,"default"],[176,51,204,41],[176,52,204,42,"getItem"],[176,59,204,49],[176,60,204,50],[176,66,204,56],[176,67,204,57],[177,8,205,6],[177,12,205,10],[177,13,205,11,"userData"],[177,21,205,19],[177,23,205,21],[178,10,206,8,"setUser"],[178,17,206,15],[178,18,206,16],[178,22,206,20],[178,23,206,21],[179,10,207,8,"setError"],[179,18,207,16],[179,19,207,17],[179,46,207,44],[179,47,207,45],[180,10,208,8],[181,8,209,6],[182,8,211,6],[182,14,211,12,"parsedUser"],[182,24,211,22],[182,27,211,25,"JSON"],[182,31,211,29],[182,32,211,30,"parse"],[182,37,211,35],[182,38,211,36,"userData"],[182,46,211,44],[182,47,211,45],[183,8,212,6,"setUser"],[183,15,212,13],[183,16,212,14,"parsedUser"],[183,26,212,24],[183,27,212,25],[184,8,213,6],[184,14,213,12,"markMatchesSeen"],[184,29,213,27],[184,30,213,28,"parsedUser"],[184,40,213,38],[184,41,213,39,"id"],[184,43,213,41],[184,44,213,42],[185,8,214,6],[185,14,214,12,"Promise"],[185,21,214,19],[185,22,214,20,"all"],[185,25,214,23],[185,26,214,24],[185,27,215,8,"loadMatchInfo"],[185,40,215,21],[185,41,215,22,"parsedUser"],[185,51,215,32],[185,52,215,33,"id"],[185,54,215,35],[185,55,215,36],[185,57,216,8,"loadMessages"],[185,69,216,20],[185,70,216,21,"parsedUser"],[185,80,216,31],[185,81,216,32,"id"],[185,83,216,34],[185,84,216,35],[185,85,217,7],[185,86,217,8],[186,6,218,4],[186,7,218,5],[186,8,218,6],[186,15,218,13,"err"],[186,18,218,16],[186,20,218,18],[187,8,219,6,"console"],[187,15,219,13],[187,16,219,14,"error"],[187,21,219,19],[187,22,219,20],[187,51,219,49],[187,53,219,51,"err"],[187,56,219,54],[187,57,219,55],[188,8,220,6,"setError"],[188,16,220,14],[188,17,221,8,"err"],[188,20,221,11],[188,22,221,13,"message"],[188,29,221,20],[188,32,221,23,"String"],[188,38,221,29],[188,39,221,30,"err"],[188,42,221,33],[188,43,221,34,"message"],[188,50,221,41],[188,51,221,42],[188,54,221,45],[188,81,222,6],[188,82,222,7],[189,6,223,4],[189,7,223,5],[189,16,223,14],[190,8,224,6,"setLoading"],[190,18,224,16],[190,19,224,17],[190,24,224,22],[190,25,224,23],[191,6,225,4],[192,4,226,2],[192,5,226,3],[193,4,228,2],[193,8,228,2,"useEffect"],[193,14,228,11],[193,15,228,11,"useEffect"],[193,24,228,11],[193,26,228,12],[193,32,228,18],[194,6,229,4],[195,6,230,4],[196,6,231,4,"loadUserAndMessages"],[196,25,231,23],[196,26,231,24],[196,27,231,25],[197,6,232,4],[198,4,233,2],[198,5,233,3],[198,7,233,5],[198,8,233,6,"matchId"],[198,15,233,13],[198,16,233,14],[198,17,233,15],[199,4,235,2],[199,10,235,8,"reloadMessages"],[199,24,235,22],[199,27,235,25],[199,31,235,25,"useCallback"],[199,37,235,36],[199,38,235,36,"useCallback"],[199,49,235,36],[199,51,235,37],[199,63,235,49],[200,6,236,4],[200,12,236,10,"uid"],[200,15,236,13],[200,18,236,16,"user"],[200,22,236,20],[200,24,236,22,"id"],[200,26,236,24],[201,6,237,4],[201,10,237,8],[201,11,237,9,"uid"],[201,14,237,12],[201,16,237,14],[202,6,238,4],[202,10,238,8],[202,11,238,9,"matchId"],[202,18,238,16],[202,20,238,18],[203,6,239,4],[203,12,239,10,"loadMessages"],[203,24,239,22],[203,25,239,23,"uid"],[203,28,239,26],[203,29,239,27],[204,4,240,2],[204,5,240,3],[204,7,240,5],[204,8,240,6,"loadMessages"],[204,20,240,18],[204,22,240,20,"matchId"],[204,29,240,27],[204,31,240,29,"user"],[204,35,240,33],[204,37,240,35,"id"],[204,39,240,37],[204,40,240,38],[204,41,240,39],[205,4,242,2],[205,11,242,9],[206,6,243,4,"loading"],[206,13,243,11],[207,6,244,4,"error"],[207,11,244,9],[208,6,245,4,"messages"],[208,14,245,12],[209,6,246,4,"setMessages"],[209,17,246,15],[210,6,247,4,"user"],[210,10,247,8],[211,6,248,4,"matchInfo"],[211,15,248,13],[212,6,249,4,"reloadMessages"],[213,4,250,2],[213,5,250,3],[214,2,251,0],[215,2,251,1,"_s"],[215,4,251,1],[215,5,5,16,"useConversation"],[215,20,5,31],[216,4,5,31],[216,12,6,22,"useQueryClient"],[216,31,6,36],[216,32,6,36,"useQueryClient"],[216,46,6,36],[217,2,6,36],[218,0,6,36],[218,3]],"functionMap":{"names":["<global>","useConversation","markMatchesSeen","loadMatchInfo","setError$argument_0","response.text._catch$argument_0","loadMessages","loadUserAndMessages","useEffect$argument_0","reloadMessages"],"mappings":"AAA;OCI;ICgB;KDmB;wBEI;mBCO,sDD;YCY;4EDC;iDEK,QF;QCa;6EDE;GFG;IKG;mDDuE,QC;KL+B;8BMI;GN8B;YOE;GPK;qCQE;GRK;CDW"},"hasCjsExports":false},"type":"js/module"}]}