{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"./attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":135,"index":135}}],"key":"UMlNobrmssIvLA9C9D03xjrDrQE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"extractTargetInfo\", {\n    enumerable: true,\n    get: function () {\n      return extractTargetInfo;\n    }\n  });\n  Object.defineProperty(exports, \"getRequestArguments\", {\n    enumerable: true,\n    get: function () {\n      return getRequestArguments;\n    }\n  });\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _attributesJs = require(_dependencyMap[1], \"./attributes.js\");\n  /**\n   * Method configuration and request processing for MCP server instrumentation\n   */\n\n  /**\n   * Configuration for MCP methods to extract targets and arguments\n   * @internal Maps method names to their extraction configuration\n   */\n  var METHOD_CONFIGS = {\n    'tools/call': {\n      targetField: 'name',\n      targetAttribute: _attributesJs.MCP_TOOL_NAME_ATTRIBUTE,\n      captureArguments: true,\n      argumentsField: 'arguments'\n    },\n    'resources/read': {\n      targetField: 'uri',\n      targetAttribute: _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE,\n      captureUri: true\n    },\n    'resources/subscribe': {\n      targetField: 'uri',\n      targetAttribute: _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE\n    },\n    'resources/unsubscribe': {\n      targetField: 'uri',\n      targetAttribute: _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE\n    },\n    'prompts/get': {\n      targetField: 'name',\n      targetAttribute: _attributesJs.MCP_PROMPT_NAME_ATTRIBUTE,\n      captureName: true,\n      captureArguments: true,\n      argumentsField: 'arguments'\n    }\n  };\n\n  /**\n   * Extracts target info from method and params based on method type\n   * @param method - MCP method name\n   * @param params - Method parameters\n   * @returns Target name and attributes for span instrumentation\n   */\n  function extractTargetInfo(method, params) {\n    var config = METHOD_CONFIGS[method];\n    if (!config) {\n      return {\n        attributes: {}\n      };\n    }\n    var target = config.targetField && typeof params?.[config.targetField] === 'string' ? params[config.targetField] : undefined;\n    return {\n      target,\n      attributes: target && config.targetAttribute ? {\n        [config.targetAttribute]: target\n      } : {}\n    };\n  }\n\n  /**\n   * Extracts request arguments based on method type\n   * @param method - MCP method name\n   * @param params - Method parameters\n   * @returns Arguments as span attributes with mcp.request.argument prefix\n   */\n  function getRequestArguments(method, params) {\n    var args = {};\n    var config = METHOD_CONFIGS[method];\n    if (!config) {\n      return args;\n    }\n    if (config.captureArguments && config.argumentsField && params?.[config.argumentsField]) {\n      var argumentsObj = params[config.argumentsField];\n      if (typeof argumentsObj === 'object' && argumentsObj !== null) {\n        for (var _ref of Object.entries(argumentsObj)) {\n          var _ref2 = (0, _slicedToArray.default)(_ref, 2);\n          var key = _ref2[0];\n          var value = _ref2[1];\n          args[`${_attributesJs.MCP_REQUEST_ARGUMENT}.${key.toLowerCase()}`] = JSON.stringify(value);\n        }\n      }\n    }\n    if (config.captureUri && params?.uri) {\n      args[`${_attributesJs.MCP_REQUEST_ARGUMENT}.uri`] = JSON.stringify(params.uri);\n    }\n    if (config.captureName && params?.name) {\n      args[`${_attributesJs.MCP_REQUEST_ARGUMENT}.name`] = JSON.stringify(params.name);\n    }\n    return args;\n  }\n});","lineCount":117,"map":[[12,2,103,0,"Object"],[12,8,103,0],[12,9,103,0,"defineProperty"],[12,23,103,0],[12,24,103,0,"exports"],[12,31,103,0],[13,4,103,0,"enumerable"],[13,14,103,0],[14,4,103,0,"get"],[14,7,103,0],[14,18,103,0,"get"],[14,19,103,0],[15,6,103,0],[15,13,103,9,"extractTargetInfo"],[15,30,103,26],[16,4,103,26],[17,2,103,26],[18,2,103,0,"Object"],[18,8,103,0],[18,9,103,0,"defineProperty"],[18,23,103,0],[18,24,103,0,"exports"],[18,31,103,0],[19,4,103,0,"enumerable"],[19,14,103,0],[20,4,103,0,"get"],[20,7,103,0],[20,18,103,0,"get"],[20,19,103,0],[21,6,103,0],[21,13,103,28,"getRequestArguments"],[21,32,103,47],[22,4,103,47],[23,2,103,47],[24,2,103,50],[24,6,103,50,"_babelRuntimeHelpersSlicedToArray"],[24,39,103,50],[24,42,103,50,"require"],[24,49,103,50],[24,50,103,50,"_dependencyMap"],[24,64,103,50],[25,2,103,50],[25,6,103,50,"_slicedToArray"],[25,20,103,50],[25,23,103,50,"_interopDefault"],[25,38,103,50],[25,39,103,50,"_babelRuntimeHelpersSlicedToArray"],[25,72,103,50],[26,2,1,0],[26,6,1,0,"_attributesJs"],[26,19,1,0],[26,22,1,0,"require"],[26,29,1,0],[26,30,1,0,"_dependencyMap"],[26,44,1,0],[27,2,3,0],[28,0,4,0],[29,0,5,0],[31,2,8,0],[32,0,9,0],[33,0,10,0],[34,0,11,0],[35,2,12,0],[35,6,12,6,"METHOD_CONFIGS"],[35,20,12,20],[35,23,12,23],[36,4,13,2],[36,16,13,14],[36,18,13,16],[37,6,14,4,"targetField"],[37,17,14,15],[37,19,14,17],[37,25,14,23],[38,6,15,4,"targetAttribute"],[38,21,15,19],[38,23,15,21,"MCP_TOOL_NAME_ATTRIBUTE"],[38,36,15,44],[38,37,15,44,"MCP_TOOL_NAME_ATTRIBUTE"],[38,60,15,44],[39,6,16,4,"captureArguments"],[39,22,16,20],[39,24,16,22],[39,28,16,26],[40,6,17,4,"argumentsField"],[40,20,17,18],[40,22,17,20],[41,4,18,2],[41,5,18,3],[42,4,19,2],[42,20,19,18],[42,22,19,20],[43,6,20,4,"targetField"],[43,17,20,15],[43,19,20,17],[43,24,20,22],[44,6,21,4,"targetAttribute"],[44,21,21,19],[44,23,21,21,"MCP_RESOURCE_URI_ATTRIBUTE"],[44,36,21,47],[44,37,21,47,"MCP_RESOURCE_URI_ATTRIBUTE"],[44,63,21,47],[45,6,22,4,"captureUri"],[45,16,22,14],[45,18,22,16],[46,4,23,2],[46,5,23,3],[47,4,24,2],[47,25,24,23],[47,27,24,25],[48,6,25,4,"targetField"],[48,17,25,15],[48,19,25,17],[48,24,25,22],[49,6,26,4,"targetAttribute"],[49,21,26,19],[49,23,26,21,"MCP_RESOURCE_URI_ATTRIBUTE"],[49,36,26,47],[49,37,26,47,"MCP_RESOURCE_URI_ATTRIBUTE"],[50,4,27,2],[50,5,27,3],[51,4,28,2],[51,27,28,25],[51,29,28,27],[52,6,29,4,"targetField"],[52,17,29,15],[52,19,29,17],[52,24,29,22],[53,6,30,4,"targetAttribute"],[53,21,30,19],[53,23,30,21,"MCP_RESOURCE_URI_ATTRIBUTE"],[53,36,30,47],[53,37,30,47,"MCP_RESOURCE_URI_ATTRIBUTE"],[54,4,31,2],[54,5,31,3],[55,4,32,2],[55,17,32,15],[55,19,32,17],[56,6,33,4,"targetField"],[56,17,33,15],[56,19,33,17],[56,25,33,23],[57,6,34,4,"targetAttribute"],[57,21,34,19],[57,23,34,21,"MCP_PROMPT_NAME_ATTRIBUTE"],[57,36,34,46],[57,37,34,46,"MCP_PROMPT_NAME_ATTRIBUTE"],[57,62,34,46],[58,6,35,4,"captureName"],[58,17,35,15],[58,19,35,17],[58,23,35,21],[59,6,36,4,"captureArguments"],[59,22,36,20],[59,24,36,22],[59,28,36,26],[60,6,37,4,"argumentsField"],[60,20,37,18],[60,22,37,20],[61,4,38,2],[62,2,39,0],[62,3,39,1],[64,2,41,0],[65,0,42,0],[66,0,43,0],[67,0,44,0],[68,0,45,0],[69,0,46,0],[70,2,47,0],[70,11,47,9,"extractTargetInfo"],[70,28,47,26,"extractTargetInfo"],[70,29,48,2,"method"],[70,35,48,8],[70,37,49,2,"params"],[70,43,49,8],[70,45,52,1],[71,4,53,2],[71,8,53,8,"config"],[71,14,53,14],[71,17,53,17,"METHOD_CONFIGS"],[71,31,53,31],[71,32,53,32,"method"],[71,38,53,38],[71,39,53,39],[72,4,54,2],[72,8,54,6],[72,9,54,7,"config"],[72,15,54,13],[72,17,54,15],[73,6,55,4],[73,13,55,11],[74,8,55,13,"attributes"],[74,18,55,23],[74,20,55,25],[74,21,55,26],[75,6,55,28],[75,7,55,29],[76,4,56,2],[77,4,58,2],[77,8,58,8,"target"],[77,14,58,14],[77,17,59,4,"config"],[77,23,59,10],[77,24,59,11,"targetField"],[77,35,59,22],[77,39,59,26],[77,46,59,33,"params"],[77,52,59,39],[77,55,59,42,"config"],[77,61,59,48],[77,62,59,49,"targetField"],[77,73,59,60],[77,74,59,61],[77,79,59,66],[77,87,59,74],[77,90,60,9,"params"],[77,96,60,15],[77,97,60,16,"config"],[77,103,60,22],[77,104,60,23,"targetField"],[77,115,60,34],[77,116,60,35],[77,119,61,8,"undefined"],[77,128,61,17],[78,4,63,2],[78,11,63,9],[79,6,64,4,"target"],[79,12,64,10],[80,6,65,4,"attributes"],[80,16,65,14],[80,18,65,16,"target"],[80,24,65,22],[80,28,65,26,"config"],[80,34,65,32],[80,35,65,33,"targetAttribute"],[80,50,65,48],[80,53,65,51],[81,8,65,53],[81,9,65,54,"config"],[81,15,65,60],[81,16,65,61,"targetAttribute"],[81,31,65,76],[81,34,65,79,"target"],[82,6,65,86],[82,7,65,87],[82,10,65,90],[82,11,65,91],[83,4,66,2],[83,5,66,3],[84,2,67,0],[86,2,69,0],[87,0,70,0],[88,0,71,0],[89,0,72,0],[90,0,73,0],[91,0,74,0],[92,2,75,0],[92,11,75,9,"getRequestArguments"],[92,30,75,28,"getRequestArguments"],[92,31,75,29,"method"],[92,37,75,35],[92,39,75,37,"params"],[92,45,75,43],[92,47,75,45],[93,4,76,2],[93,8,76,8,"args"],[93,12,76,12],[93,15,76,15],[93,16,76,16],[93,17,76,17],[94,4,77,2],[94,8,77,8,"config"],[94,14,77,14],[94,17,77,17,"METHOD_CONFIGS"],[94,31,77,31],[94,32,77,32,"method"],[94,38,77,38],[94,39,77,39],[95,4,79,2],[95,8,79,6],[95,9,79,7,"config"],[95,15,79,13],[95,17,79,15],[96,6,80,4],[96,13,80,11,"args"],[96,17,80,15],[97,4,81,2],[98,4,83,2],[98,8,83,6,"config"],[98,14,83,12],[98,15,83,13,"captureArguments"],[98,31,83,29],[98,35,83,33,"config"],[98,41,83,39],[98,42,83,40,"argumentsField"],[98,56,83,54],[98,60,83,58,"params"],[98,66,83,64],[98,69,83,67,"config"],[98,75,83,73],[98,76,83,74,"argumentsField"],[98,90,83,88],[98,91,83,89],[98,93,83,91],[99,6,84,4],[99,10,84,10,"argumentsObj"],[99,22,84,22],[99,25,84,25,"params"],[99,31,84,31],[99,32,84,32,"config"],[99,38,84,38],[99,39,84,39,"argumentsField"],[99,53,84,53],[99,54,84,54],[100,6,85,4],[100,10,85,8],[100,17,85,15,"argumentsObj"],[100,29,85,27],[100,34,85,32],[100,42,85,40],[100,46,85,44,"argumentsObj"],[100,58,85,56],[100,63,85,61],[100,67,85,65],[100,69,85,67],[101,8,86,6],[101,17,86,6,"_ref"],[101,21,86,6],[101,25,86,33,"Object"],[101,31,86,39],[101,32,86,40,"entries"],[101,39,86,47],[101,40,86,48,"argumentsObj"],[101,52,86,61],[101,53,86,62],[101,55,86,64],[102,10,86,64],[102,14,86,64,"_ref2"],[102,19,86,64],[102,26,86,64,"_slicedToArray"],[102,40,86,64],[102,41,86,64,"default"],[102,48,86,64],[102,50,86,64,"_ref"],[102,54,86,64],[103,10,86,64],[103,14,86,18,"key"],[103,17,86,21],[103,20,86,21,"_ref2"],[103,25,86,21],[104,10,86,21],[104,14,86,23,"value"],[104,19,86,28],[104,22,86,28,"_ref2"],[104,27,86,28],[105,10,87,8,"args"],[105,14,87,12],[105,15,87,13],[105,18,87,16,"MCP_REQUEST_ARGUMENT"],[105,31,87,36],[105,32,87,36,"MCP_REQUEST_ARGUMENT"],[105,52,87,36],[105,56,87,40,"key"],[105,59,87,43],[105,60,87,44,"toLowerCase"],[105,71,87,55],[105,72,87,56],[105,73,87,57],[105,75,87,59],[105,76,87,60],[105,79,87,63,"JSON"],[105,83,87,67],[105,84,87,68,"stringify"],[105,93,87,77],[105,94,87,78,"value"],[105,99,87,83],[105,100,87,84],[106,8,88,6],[107,6,89,4],[108,4,90,2],[109,4,92,2],[109,8,92,6,"config"],[109,14,92,12],[109,15,92,13,"captureUri"],[109,25,92,23],[109,29,92,27,"params"],[109,35,92,33],[109,37,92,35,"uri"],[109,40,92,38],[109,42,92,40],[110,6,93,4,"args"],[110,10,93,8],[110,11,93,9],[110,14,93,12,"MCP_REQUEST_ARGUMENT"],[110,27,93,32],[110,28,93,32,"MCP_REQUEST_ARGUMENT"],[110,48,93,32],[110,54,93,38],[110,55,93,39],[110,58,93,42,"JSON"],[110,62,93,46],[110,63,93,47,"stringify"],[110,72,93,56],[110,73,93,57,"params"],[110,79,93,63],[110,80,93,64,"uri"],[110,83,93,67],[110,84,93,68],[111,4,94,2],[112,4,96,2],[112,8,96,6,"config"],[112,14,96,12],[112,15,96,13,"captureName"],[112,26,96,24],[112,30,96,28,"params"],[112,36,96,34],[112,38,96,36,"name"],[112,42,96,40],[112,44,96,42],[113,6,97,4,"args"],[113,10,97,8],[113,11,97,9],[113,14,97,12,"MCP_REQUEST_ARGUMENT"],[113,27,97,32],[113,28,97,32,"MCP_REQUEST_ARGUMENT"],[113,48,97,32],[113,55,97,39],[113,56,97,40],[113,59,97,43,"JSON"],[113,63,97,47],[113,64,97,48,"stringify"],[113,73,97,57],[113,74,97,58,"params"],[113,80,97,64],[113,81,97,65,"name"],[113,85,97,69],[113,86,97,70],[114,4,98,2],[115,4,100,2],[115,11,100,9,"args"],[115,15,100,13],[116,2,101,0],[117,0,101,1],[117,3]],"functionMap":{"names":["<global>","extractTargetInfo","getRequestArguments"],"mappings":"AAA;AC8C;CDoB;AEQ;CF0B"},"hasCjsExports":false},"type":"js/module"}]}