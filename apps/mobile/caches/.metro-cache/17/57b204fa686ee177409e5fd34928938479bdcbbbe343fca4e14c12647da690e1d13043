{"dependencies":[{"name":"tslib","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":14,"index":152},"end":{"line":4,"column":30,"index":168}}],"key":"vm88vOsSPZItrLOmMEyUuGkd1y4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.createSidecarMedium = exports.createMedium = void 0;\n  var tslib_1 = require(_dependencyMap[0], \"tslib\");\n  function ItoI(a) {\n    return a;\n  }\n  function innerCreateMedium(defaults, middleware) {\n    if (middleware === void 0) {\n      middleware = ItoI;\n    }\n    var buffer = [];\n    var assigned = false;\n    var medium = {\n      read: function () {\n        if (assigned) {\n          throw new Error('Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.');\n        }\n        if (buffer.length) {\n          return buffer[buffer.length - 1];\n        }\n        return defaults;\n      },\n      useMedium: function (data) {\n        var item = middleware(data, assigned);\n        buffer.push(item);\n        return function () {\n          buffer = buffer.filter(function (x) {\n            return x !== item;\n          });\n        };\n      },\n      assignSyncMedium: function (cb) {\n        assigned = true;\n        while (buffer.length) {\n          var cbs = buffer;\n          buffer = [];\n          cbs.forEach(cb);\n        }\n        buffer = {\n          push: function (x) {\n            return cb(x);\n          },\n          filter: function () {\n            return buffer;\n          }\n        };\n      },\n      assignMedium: function (cb) {\n        assigned = true;\n        var pendingQueue = [];\n        if (buffer.length) {\n          var cbs = buffer;\n          buffer = [];\n          cbs.forEach(cb);\n          pendingQueue = buffer;\n        }\n        var executeQueue = function () {\n          var cbs = pendingQueue;\n          pendingQueue = [];\n          cbs.forEach(cb);\n        };\n        var cycle = function () {\n          return Promise.resolve().then(executeQueue);\n        };\n        cycle();\n        buffer = {\n          push: function (x) {\n            pendingQueue.push(x);\n            cycle();\n          },\n          filter: function (filter) {\n            pendingQueue = pendingQueue.filter(filter);\n            return buffer;\n          }\n        };\n      }\n    };\n    return medium;\n  }\n  function createMedium(defaults, middleware) {\n    if (middleware === void 0) {\n      middleware = ItoI;\n    }\n    return innerCreateMedium(defaults, middleware);\n  }\n  exports.createMedium = createMedium;\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  function createSidecarMedium(options) {\n    if (options === void 0) {\n      options = {};\n    }\n    var medium = innerCreateMedium(null);\n    medium.options = tslib_1.__assign({\n      async: true,\n      ssr: false\n    }, options);\n    return medium;\n  }\n  exports.createSidecarMedium = createSidecarMedium;\n});","lineCount":105,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"createSidecarMedium"],[7,29,3,27],[7,32,3,30,"exports"],[7,39,3,37],[7,40,3,38,"createMedium"],[7,52,3,50],[7,55,3,53],[7,60,3,58],[7,61,3,59],[8,2,4,0],[8,6,4,4,"tslib_1"],[8,13,4,11],[8,16,4,14,"require"],[8,23,4,21],[8,24,4,21,"_dependencyMap"],[8,38,4,21],[8,50,4,29],[8,51,4,30],[9,2,5,0],[9,11,5,9,"ItoI"],[9,15,5,13,"ItoI"],[9,16,5,14,"a"],[9,17,5,15],[9,19,5,17],[10,4,6,4],[10,11,6,11,"a"],[10,12,6,12],[11,2,7,0],[12,2,8,0],[12,11,8,9,"innerCreateMedium"],[12,28,8,26,"innerCreateMedium"],[12,29,8,27,"defaults"],[12,37,8,35],[12,39,8,37,"middleware"],[12,49,8,47],[12,51,8,49],[13,4,9,4],[13,8,9,8,"middleware"],[13,18,9,18],[13,23,9,23],[13,28,9,28],[13,29,9,29],[13,31,9,31],[14,6,9,33,"middleware"],[14,16,9,43],[14,19,9,46,"ItoI"],[14,23,9,50],[15,4,9,52],[16,4,10,4],[16,8,10,8,"buffer"],[16,14,10,14],[16,17,10,17],[16,19,10,19],[17,4,11,4],[17,8,11,8,"assigned"],[17,16,11,16],[17,19,11,19],[17,24,11,24],[18,4,12,4],[18,8,12,8,"medium"],[18,14,12,14],[18,17,12,17],[19,6,13,8,"read"],[19,10,13,12],[19,12,13,14],[19,21,13,14,"read"],[19,22,13,14],[19,24,13,26],[20,8,14,12],[20,12,14,16,"assigned"],[20,20,14,24],[20,22,14,26],[21,10,15,16],[21,16,15,22],[21,20,15,26,"Error"],[21,25,15,31],[21,26,15,32],[21,124,15,130],[21,125,15,131],[22,8,16,12],[23,8,17,12],[23,12,17,16,"buffer"],[23,18,17,22],[23,19,17,23,"length"],[23,25,17,29],[23,27,17,31],[24,10,18,16],[24,17,18,23,"buffer"],[24,23,18,29],[24,24,18,30,"buffer"],[24,30,18,36],[24,31,18,37,"length"],[24,37,18,43],[24,40,18,46],[24,41,18,47],[24,42,18,48],[25,8,19,12],[26,8,20,12],[26,15,20,19,"defaults"],[26,23,20,27],[27,6,21,8],[27,7,21,9],[28,6,22,8,"useMedium"],[28,15,22,17],[28,17,22,19],[28,26,22,19,"useMedium"],[28,27,22,29,"data"],[28,31,22,33],[28,33,22,35],[29,8,23,12],[29,12,23,16,"item"],[29,16,23,20],[29,19,23,23,"middleware"],[29,29,23,33],[29,30,23,34,"data"],[29,34,23,38],[29,36,23,40,"assigned"],[29,44,23,48],[29,45,23,49],[30,8,24,12,"buffer"],[30,14,24,18],[30,15,24,19,"push"],[30,19,24,23],[30,20,24,24,"item"],[30,24,24,28],[30,25,24,29],[31,8,25,12],[31,15,25,19],[31,27,25,31],[32,10,26,16,"buffer"],[32,16,26,22],[32,19,26,25,"buffer"],[32,25,26,31],[32,26,26,32,"filter"],[32,32,26,38],[32,33,26,39],[32,43,26,49,"x"],[32,44,26,50],[32,46,26,52],[33,12,26,54],[33,19,26,61,"x"],[33,20,26,62],[33,25,26,67,"item"],[33,29,26,71],[34,10,26,73],[34,11,26,74],[34,12,26,75],[35,8,27,12],[35,9,27,13],[36,6,28,8],[36,7,28,9],[37,6,29,8,"assignSyncMedium"],[37,22,29,24],[37,24,29,26],[37,33,29,26,"assignSyncMedium"],[37,34,29,36,"cb"],[37,36,29,38],[37,38,29,40],[38,8,30,12,"assigned"],[38,16,30,20],[38,19,30,23],[38,23,30,27],[39,8,31,12],[39,15,31,19,"buffer"],[39,21,31,25],[39,22,31,26,"length"],[39,28,31,32],[39,30,31,34],[40,10,32,16],[40,14,32,20,"cbs"],[40,17,32,23],[40,20,32,26,"buffer"],[40,26,32,32],[41,10,33,16,"buffer"],[41,16,33,22],[41,19,33,25],[41,21,33,27],[42,10,34,16,"cbs"],[42,13,34,19],[42,14,34,20,"forEach"],[42,21,34,27],[42,22,34,28,"cb"],[42,24,34,30],[42,25,34,31],[43,8,35,12],[44,8,36,12,"buffer"],[44,14,36,18],[44,17,36,21],[45,10,37,16,"push"],[45,14,37,20],[45,16,37,22],[45,25,37,22,"push"],[45,26,37,32,"x"],[45,27,37,33],[45,29,37,35],[46,12,37,37],[46,19,37,44,"cb"],[46,21,37,46],[46,22,37,47,"x"],[46,23,37,48],[46,24,37,49],[47,10,37,51],[47,11,37,52],[48,10,38,16,"filter"],[48,16,38,22],[48,18,38,24],[48,27,38,24,"filter"],[48,28,38,24],[48,30,38,36],[49,12,38,38],[49,19,38,45,"buffer"],[49,25,38,51],[50,10,38,53],[51,8,39,12],[51,9,39,13],[52,6,40,8],[52,7,40,9],[53,6,41,8,"assignMedium"],[53,18,41,20],[53,20,41,22],[53,29,41,22,"assignMedium"],[53,30,41,32,"cb"],[53,32,41,34],[53,34,41,36],[54,8,42,12,"assigned"],[54,16,42,20],[54,19,42,23],[54,23,42,27],[55,8,43,12],[55,12,43,16,"pendingQueue"],[55,24,43,28],[55,27,43,31],[55,29,43,33],[56,8,44,12],[56,12,44,16,"buffer"],[56,18,44,22],[56,19,44,23,"length"],[56,25,44,29],[56,27,44,31],[57,10,45,16],[57,14,45,20,"cbs"],[57,17,45,23],[57,20,45,26,"buffer"],[57,26,45,32],[58,10,46,16,"buffer"],[58,16,46,22],[58,19,46,25],[58,21,46,27],[59,10,47,16,"cbs"],[59,13,47,19],[59,14,47,20,"forEach"],[59,21,47,27],[59,22,47,28,"cb"],[59,24,47,30],[59,25,47,31],[60,10,48,16,"pendingQueue"],[60,22,48,28],[60,25,48,31,"buffer"],[60,31,48,37],[61,8,49,12],[62,8,50,12],[62,12,50,16,"executeQueue"],[62,24,50,28],[62,27,50,31],[62,36,50,31,"executeQueue"],[62,37,50,31],[62,39,50,43],[63,10,51,16],[63,14,51,20,"cbs"],[63,17,51,23],[63,20,51,26,"pendingQueue"],[63,32,51,38],[64,10,52,16,"pendingQueue"],[64,22,52,28],[64,25,52,31],[64,27,52,33],[65,10,53,16,"cbs"],[65,13,53,19],[65,14,53,20,"forEach"],[65,21,53,27],[65,22,53,28,"cb"],[65,24,53,30],[65,25,53,31],[66,8,54,12],[66,9,54,13],[67,8,55,12],[67,12,55,16,"cycle"],[67,17,55,21],[67,20,55,24],[67,29,55,24,"cycle"],[67,30,55,24],[67,32,55,36],[68,10,55,38],[68,17,55,45,"Promise"],[68,24,55,52],[68,25,55,53,"resolve"],[68,32,55,60],[68,33,55,61],[68,34,55,62],[68,35,55,63,"then"],[68,39,55,67],[68,40,55,68,"executeQueue"],[68,52,55,80],[68,53,55,81],[69,8,55,83],[69,9,55,84],[70,8,56,12,"cycle"],[70,13,56,17],[70,14,56,18],[70,15,56,19],[71,8,57,12,"buffer"],[71,14,57,18],[71,17,57,21],[72,10,58,16,"push"],[72,14,58,20],[72,16,58,22],[72,25,58,22,"push"],[72,26,58,32,"x"],[72,27,58,33],[72,29,58,35],[73,12,59,20,"pendingQueue"],[73,24,59,32],[73,25,59,33,"push"],[73,29,59,37],[73,30,59,38,"x"],[73,31,59,39],[73,32,59,40],[74,12,60,20,"cycle"],[74,17,60,25],[74,18,60,26],[74,19,60,27],[75,10,61,16],[75,11,61,17],[76,10,62,16,"filter"],[76,16,62,22],[76,18,62,24],[76,27,62,24,"filter"],[76,28,62,34,"filter"],[76,34,62,40],[76,36,62,42],[77,12,63,20,"pendingQueue"],[77,24,63,32],[77,27,63,35,"pendingQueue"],[77,39,63,47],[77,40,63,48,"filter"],[77,46,63,54],[77,47,63,55,"filter"],[77,53,63,61],[77,54,63,62],[78,12,64,20],[78,19,64,27,"buffer"],[78,25,64,33],[79,10,65,16],[80,8,66,12],[80,9,66,13],[81,6,67,8],[82,4,68,4],[82,5,68,5],[83,4,69,4],[83,11,69,11,"medium"],[83,17,69,17],[84,2,70,0],[85,2,71,0],[85,11,71,9,"createMedium"],[85,23,71,21,"createMedium"],[85,24,71,22,"defaults"],[85,32,71,30],[85,34,71,32,"middleware"],[85,44,71,42],[85,46,71,44],[86,4,72,4],[86,8,72,8,"middleware"],[86,18,72,18],[86,23,72,23],[86,28,72,28],[86,29,72,29],[86,31,72,31],[87,6,72,33,"middleware"],[87,16,72,43],[87,19,72,46,"ItoI"],[87,23,72,50],[88,4,72,52],[89,4,73,4],[89,11,73,11,"innerCreateMedium"],[89,28,73,28],[89,29,73,29,"defaults"],[89,37,73,37],[89,39,73,39,"middleware"],[89,49,73,49],[89,50,73,50],[90,2,74,0],[91,2,75,0,"exports"],[91,9,75,7],[91,10,75,8,"createMedium"],[91,22,75,20],[91,25,75,23,"createMedium"],[91,37,75,35],[92,2,76,0],[93,2,77,0],[93,11,77,9,"createSidecarMedium"],[93,30,77,28,"createSidecarMedium"],[93,31,77,29,"options"],[93,38,77,36],[93,40,77,38],[94,4,78,4],[94,8,78,8,"options"],[94,15,78,15],[94,20,78,20],[94,25,78,25],[94,26,78,26],[94,28,78,28],[95,6,78,30,"options"],[95,13,78,37],[95,16,78,40],[95,17,78,41],[95,18,78,42],[96,4,78,44],[97,4,79,4],[97,8,79,8,"medium"],[97,14,79,14],[97,17,79,17,"innerCreateMedium"],[97,34,79,34],[97,35,79,35],[97,39,79,39],[97,40,79,40],[98,4,80,4,"medium"],[98,10,80,10],[98,11,80,11,"options"],[98,18,80,18],[98,21,80,21,"tslib_1"],[98,28,80,28],[98,29,80,29,"__assign"],[98,37,80,37],[98,38,80,38],[99,6,80,40,"async"],[99,11,80,45],[99,13,80,47],[99,17,80,51],[100,6,80,53,"ssr"],[100,9,80,56],[100,11,80,58],[101,4,80,64],[101,5,80,65],[101,7,80,67,"options"],[101,14,80,74],[101,15,80,75],[102,4,81,4],[102,11,81,11,"medium"],[102,17,81,17],[103,2,82,0],[104,2,83,0,"exports"],[104,9,83,7],[104,10,83,8,"createSidecarMedium"],[104,29,83,27],[104,32,83,30,"createSidecarMedium"],[104,51,83,49],[105,0,83,50],[105,3]],"functionMap":{"names":["<global>","ItoI","innerCreateMedium","read","useMedium","<anonymous>","buffer.filter$argument_0","assignSyncMedium","buffer.push","buffer.filter","assignMedium","executeQueue","cycle","createMedium","createSidecarMedium"],"mappings":"AAA;ACI;CDE;AEC;cCK;SDQ;mBEC;mBCG;uCCC,mCD;aDC;SFC;0BKC;sBCQ,8BD;wBEC,8BF;SLE;sBQC;+BCS;aDI;wBEC,4DF;sBFG;iBEG;wBDC;iBCG;SRE;CFG;AaC;CbG;AcG;CdK"},"hasCjsExports":true},"type":"js/module"}]}