{"dependencies":[{"name":"./retry_operation","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":1,"column":21,"index":21},"end":{"line":1,"column":49,"index":49}}],"key":"QFUzt92ihpkApPl8UZc+aV0axx4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var RetryOperation = require(_dependencyMap[0], \"./retry_operation\");\n  exports.operation = function (options) {\n    var timeouts = exports.timeouts(options);\n    return new RetryOperation(timeouts, {\n      forever: options && (options.forever || options.retries === Infinity),\n      unref: options && options.unref,\n      maxRetryTime: options && options.maxRetryTime\n    });\n  };\n  exports.timeouts = function (options) {\n    if (options instanceof Array) {\n      return [].concat(options);\n    }\n    var opts = {\n      retries: 10,\n      factor: 2,\n      minTimeout: 1 * 1000,\n      maxTimeout: Infinity,\n      randomize: false\n    };\n    for (var key in options) {\n      opts[key] = options[key];\n    }\n    if (opts.minTimeout > opts.maxTimeout) {\n      throw new Error('minTimeout is greater than maxTimeout');\n    }\n    var timeouts = [];\n    for (var i = 0; i < opts.retries; i++) {\n      timeouts.push(this.createTimeout(i, opts));\n    }\n    if (options && options.forever && !timeouts.length) {\n      timeouts.push(this.createTimeout(i, opts));\n    }\n\n    // sort the array numerically ascending\n    timeouts.sort(function (a, b) {\n      return a - b;\n    });\n    return timeouts;\n  };\n  exports.createTimeout = function (attempt, opts) {\n    var random = opts.randomize ? Math.random() + 1 : 1;\n    var timeout = Math.round(random * Math.max(opts.minTimeout, 1) * Math.pow(opts.factor, attempt));\n    timeout = Math.min(timeout, opts.maxTimeout);\n    return timeout;\n  };\n  exports.wrap = function (obj, options, methods) {\n    if (options instanceof Array) {\n      methods = options;\n      options = null;\n    }\n    if (!methods) {\n      methods = [];\n      for (var key in obj) {\n        if (typeof obj[key] === 'function') {\n          methods.push(key);\n        }\n      }\n    }\n    for (var i = 0; i < methods.length; i++) {\n      var method = methods[i];\n      var original = obj[method];\n      obj[method] = function retryWrapper(original) {\n        var op = exports.operation(options);\n        var args = Array.prototype.slice.call(arguments, 1);\n        var callback = args.pop();\n        args.push(function (err) {\n          if (op.retry(err)) {\n            return;\n          }\n          if (err) {\n            arguments[0] = op.mainError();\n          }\n          callback.apply(this, arguments);\n        });\n        op.attempt(function () {\n          original.apply(obj, args);\n        });\n      }.bind(obj, original);\n      obj[method].options = options;\n    }\n  };\n});","lineCount":84,"map":[[2,2,1,0],[2,6,1,4,"RetryOperation"],[2,20,1,18],[2,23,1,21,"require"],[2,30,1,28],[2,31,1,28,"_dependencyMap"],[2,45,1,28],[2,69,1,48],[2,70,1,49],[3,2,3,0,"exports"],[3,9,3,7],[3,10,3,8,"operation"],[3,19,3,17],[3,22,3,20],[3,32,3,29,"options"],[3,39,3,36],[3,41,3,38],[4,4,4,2],[4,8,4,6,"timeouts"],[4,16,4,14],[4,19,4,17,"exports"],[4,26,4,24],[4,27,4,25,"timeouts"],[4,35,4,33],[4,36,4,34,"options"],[4,43,4,41],[4,44,4,42],[5,4,5,2],[5,11,5,9],[5,15,5,13,"RetryOperation"],[5,29,5,27],[5,30,5,28,"timeouts"],[5,38,5,36],[5,40,5,38],[6,6,6,6,"forever"],[6,13,6,13],[6,15,6,15,"options"],[6,22,6,22],[6,27,6,27,"options"],[6,34,6,34],[6,35,6,35,"forever"],[6,42,6,42],[6,46,6,46,"options"],[6,53,6,53],[6,54,6,54,"retries"],[6,61,6,61],[6,66,6,66,"Infinity"],[6,74,6,74],[6,75,6,75],[7,6,7,6,"unref"],[7,11,7,11],[7,13,7,13,"options"],[7,20,7,20],[7,24,7,24,"options"],[7,31,7,31],[7,32,7,32,"unref"],[7,37,7,37],[8,6,8,6,"maxRetryTime"],[8,18,8,18],[8,20,8,20,"options"],[8,27,8,27],[8,31,8,31,"options"],[8,38,8,38],[8,39,8,39,"maxRetryTime"],[9,4,9,2],[9,5,9,3],[9,6,9,4],[10,2,10,0],[10,3,10,1],[11,2,12,0,"exports"],[11,9,12,7],[11,10,12,8,"timeouts"],[11,18,12,16],[11,21,12,19],[11,31,12,28,"options"],[11,38,12,35],[11,40,12,37],[12,4,13,2],[12,8,13,6,"options"],[12,15,13,13],[12,27,13,25,"Array"],[12,32,13,30],[12,34,13,32],[13,6,14,4],[13,13,14,11],[13,15,14,13],[13,16,14,14,"concat"],[13,22,14,20],[13,23,14,21,"options"],[13,30,14,28],[13,31,14,29],[14,4,15,2],[15,4,17,2],[15,8,17,6,"opts"],[15,12,17,10],[15,15,17,13],[16,6,18,4,"retries"],[16,13,18,11],[16,15,18,13],[16,17,18,15],[17,6,19,4,"factor"],[17,12,19,10],[17,14,19,12],[17,15,19,13],[18,6,20,4,"minTimeout"],[18,16,20,14],[18,18,20,16],[18,19,20,17],[18,22,20,20],[18,26,20,24],[19,6,21,4,"maxTimeout"],[19,16,21,14],[19,18,21,16,"Infinity"],[19,26,21,24],[20,6,22,4,"randomize"],[20,15,22,13],[20,17,22,15],[21,4,23,2],[21,5,23,3],[22,4,24,2],[22,9,24,7],[22,13,24,11,"key"],[22,16,24,14],[22,20,24,18,"options"],[22,27,24,25],[22,29,24,27],[23,6,25,4,"opts"],[23,10,25,8],[23,11,25,9,"key"],[23,14,25,12],[23,15,25,13],[23,18,25,16,"options"],[23,25,25,23],[23,26,25,24,"key"],[23,29,25,27],[23,30,25,28],[24,4,26,2],[25,4,28,2],[25,8,28,6,"opts"],[25,12,28,10],[25,13,28,11,"minTimeout"],[25,23,28,21],[25,26,28,24,"opts"],[25,30,28,28],[25,31,28,29,"maxTimeout"],[25,41,28,39],[25,43,28,41],[26,6,29,4],[26,12,29,10],[26,16,29,14,"Error"],[26,21,29,19],[26,22,29,20],[26,61,29,59],[26,62,29,60],[27,4,30,2],[28,4,32,2],[28,8,32,6,"timeouts"],[28,16,32,14],[28,19,32,17],[28,21,32,19],[29,4,33,2],[29,9,33,7],[29,13,33,11,"i"],[29,14,33,12],[29,17,33,15],[29,18,33,16],[29,20,33,18,"i"],[29,21,33,19],[29,24,33,22,"opts"],[29,28,33,26],[29,29,33,27,"retries"],[29,36,33,34],[29,38,33,36,"i"],[29,39,33,37],[29,41,33,39],[29,43,33,41],[30,6,34,4,"timeouts"],[30,14,34,12],[30,15,34,13,"push"],[30,19,34,17],[30,20,34,18],[30,24,34,22],[30,25,34,23,"createTimeout"],[30,38,34,36],[30,39,34,37,"i"],[30,40,34,38],[30,42,34,40,"opts"],[30,46,34,44],[30,47,34,45],[30,48,34,46],[31,4,35,2],[32,4,37,2],[32,8,37,6,"options"],[32,15,37,13],[32,19,37,17,"options"],[32,26,37,24],[32,27,37,25,"forever"],[32,34,37,32],[32,38,37,36],[32,39,37,37,"timeouts"],[32,47,37,45],[32,48,37,46,"length"],[32,54,37,52],[32,56,37,54],[33,6,38,4,"timeouts"],[33,14,38,12],[33,15,38,13,"push"],[33,19,38,17],[33,20,38,18],[33,24,38,22],[33,25,38,23,"createTimeout"],[33,38,38,36],[33,39,38,37,"i"],[33,40,38,38],[33,42,38,40,"opts"],[33,46,38,44],[33,47,38,45],[33,48,38,46],[34,4,39,2],[36,4,41,2],[37,4,42,2,"timeouts"],[37,12,42,10],[37,13,42,11,"sort"],[37,17,42,15],[37,18,42,16],[37,28,42,25,"a"],[37,29,42,26],[37,31,42,27,"b"],[37,32,42,28],[37,34,42,30],[38,6,43,4],[38,13,43,11,"a"],[38,14,43,12],[38,17,43,15,"b"],[38,18,43,16],[39,4,44,2],[39,5,44,3],[39,6,44,4],[40,4,46,2],[40,11,46,9,"timeouts"],[40,19,46,17],[41,2,47,0],[41,3,47,1],[42,2,49,0,"exports"],[42,9,49,7],[42,10,49,8,"createTimeout"],[42,23,49,21],[42,26,49,24],[42,36,49,33,"attempt"],[42,43,49,40],[42,45,49,42,"opts"],[42,49,49,46],[42,51,49,48],[43,4,50,2],[43,8,50,6,"random"],[43,14,50,12],[43,17,50,16,"opts"],[43,21,50,20],[43,22,50,21,"randomize"],[43,31,50,30],[43,34,51,7,"Math"],[43,38,51,11],[43,39,51,12,"random"],[43,45,51,18],[43,46,51,19],[43,47,51,20],[43,50,51,23],[43,51,51,24],[43,54,52,6],[43,55,52,7],[44,4,54,2],[44,8,54,6,"timeout"],[44,15,54,13],[44,18,54,16,"Math"],[44,22,54,20],[44,23,54,21,"round"],[44,28,54,26],[44,29,54,27,"random"],[44,35,54,33],[44,38,54,36,"Math"],[44,42,54,40],[44,43,54,41,"max"],[44,46,54,44],[44,47,54,45,"opts"],[44,51,54,49],[44,52,54,50,"minTimeout"],[44,62,54,60],[44,64,54,62],[44,65,54,63],[44,66,54,64],[44,69,54,67,"Math"],[44,73,54,71],[44,74,54,72,"pow"],[44,77,54,75],[44,78,54,76,"opts"],[44,82,54,80],[44,83,54,81,"factor"],[44,89,54,87],[44,91,54,89,"attempt"],[44,98,54,96],[44,99,54,97],[44,100,54,98],[45,4,55,2,"timeout"],[45,11,55,9],[45,14,55,12,"Math"],[45,18,55,16],[45,19,55,17,"min"],[45,22,55,20],[45,23,55,21,"timeout"],[45,30,55,28],[45,32,55,30,"opts"],[45,36,55,34],[45,37,55,35,"maxTimeout"],[45,47,55,45],[45,48,55,46],[46,4,57,2],[46,11,57,9,"timeout"],[46,18,57,16],[47,2,58,0],[47,3,58,1],[48,2,60,0,"exports"],[48,9,60,7],[48,10,60,8,"wrap"],[48,14,60,12],[48,17,60,15],[48,27,60,24,"obj"],[48,30,60,27],[48,32,60,29,"options"],[48,39,60,36],[48,41,60,38,"methods"],[48,48,60,45],[48,50,60,47],[49,4,61,2],[49,8,61,6,"options"],[49,15,61,13],[49,27,61,25,"Array"],[49,32,61,30],[49,34,61,32],[50,6,62,4,"methods"],[50,13,62,11],[50,16,62,14,"options"],[50,23,62,21],[51,6,63,4,"options"],[51,13,63,11],[51,16,63,14],[51,20,63,18],[52,4,64,2],[53,4,66,2],[53,8,66,6],[53,9,66,7,"methods"],[53,16,66,14],[53,18,66,16],[54,6,67,4,"methods"],[54,13,67,11],[54,16,67,14],[54,18,67,16],[55,6,68,4],[55,11,68,9],[55,15,68,13,"key"],[55,18,68,16],[55,22,68,20,"obj"],[55,25,68,23],[55,27,68,25],[56,8,69,6],[56,12,69,10],[56,19,69,17,"obj"],[56,22,69,20],[56,23,69,21,"key"],[56,26,69,24],[56,27,69,25],[56,32,69,30],[56,42,69,40],[56,44,69,42],[57,10,70,8,"methods"],[57,17,70,15],[57,18,70,16,"push"],[57,22,70,20],[57,23,70,21,"key"],[57,26,70,24],[57,27,70,25],[58,8,71,6],[59,6,72,4],[60,4,73,2],[61,4,75,2],[61,9,75,7],[61,13,75,11,"i"],[61,14,75,12],[61,17,75,15],[61,18,75,16],[61,20,75,18,"i"],[61,21,75,19],[61,24,75,22,"methods"],[61,31,75,29],[61,32,75,30,"length"],[61,38,75,36],[61,40,75,38,"i"],[61,41,75,39],[61,43,75,41],[61,45,75,43],[62,6,76,4],[62,10,76,8,"method"],[62,16,76,14],[62,19,76,19,"methods"],[62,26,76,26],[62,27,76,27,"i"],[62,28,76,28],[62,29,76,29],[63,6,77,4],[63,10,77,8,"original"],[63,18,77,16],[63,21,77,19,"obj"],[63,24,77,22],[63,25,77,23,"method"],[63,31,77,29],[63,32,77,30],[64,6,79,4,"obj"],[64,9,79,7],[64,10,79,8,"method"],[64,16,79,14],[64,17,79,15],[64,20,79,18],[64,29,79,27,"retryWrapper"],[64,41,79,39,"retryWrapper"],[64,42,79,40,"original"],[64,50,79,48],[64,52,79,50],[65,8,80,6],[65,12,80,10,"op"],[65,14,80,12],[65,17,80,21,"exports"],[65,24,80,28],[65,25,80,29,"operation"],[65,34,80,38],[65,35,80,39,"options"],[65,42,80,46],[65,43,80,47],[66,8,81,6],[66,12,81,10,"args"],[66,16,81,14],[66,19,81,21,"Array"],[66,24,81,26],[66,25,81,27,"prototype"],[66,34,81,36],[66,35,81,37,"slice"],[66,40,81,42],[66,41,81,43,"call"],[66,45,81,47],[66,46,81,48,"arguments"],[66,55,81,57],[66,57,81,59],[66,58,81,60],[66,59,81,61],[67,8,82,6],[67,12,82,10,"callback"],[67,20,82,18],[67,23,82,21,"args"],[67,27,82,25],[67,28,82,26,"pop"],[67,31,82,29],[67,32,82,30],[67,33,82,31],[68,8,84,6,"args"],[68,12,84,10],[68,13,84,11,"push"],[68,17,84,15],[68,18,84,16],[68,28,84,25,"err"],[68,31,84,28],[68,33,84,30],[69,10,85,8],[69,14,85,12,"op"],[69,16,85,14],[69,17,85,15,"retry"],[69,22,85,20],[69,23,85,21,"err"],[69,26,85,24],[69,27,85,25],[69,29,85,27],[70,12,86,10],[71,10,87,8],[72,10,88,8],[72,14,88,12,"err"],[72,17,88,15],[72,19,88,17],[73,12,89,10,"arguments"],[73,21,89,19],[73,22,89,20],[73,23,89,21],[73,24,89,22],[73,27,89,25,"op"],[73,29,89,27],[73,30,89,28,"mainError"],[73,39,89,37],[73,40,89,38],[73,41,89,39],[74,10,90,8],[75,10,91,8,"callback"],[75,18,91,16],[75,19,91,17,"apply"],[75,24,91,22],[75,25,91,23],[75,29,91,27],[75,31,91,29,"arguments"],[75,40,91,38],[75,41,91,39],[76,8,92,6],[76,9,92,7],[76,10,92,8],[77,8,94,6,"op"],[77,10,94,8],[77,11,94,9,"attempt"],[77,18,94,16],[77,19,94,17],[77,31,94,28],[78,10,95,8,"original"],[78,18,95,16],[78,19,95,17,"apply"],[78,24,95,22],[78,25,95,23,"obj"],[78,28,95,26],[78,30,95,28,"args"],[78,34,95,32],[78,35,95,33],[79,8,96,6],[79,9,96,7],[79,10,96,8],[80,6,97,4],[80,7,97,5],[80,8,97,6,"bind"],[80,12,97,10],[80,13,97,11,"obj"],[80,16,97,14],[80,18,97,16,"original"],[80,26,97,24],[80,27,97,25],[81,6,98,4,"obj"],[81,9,98,7],[81,10,98,8,"method"],[81,16,98,14],[81,17,98,15],[81,18,98,16,"options"],[81,25,98,23],[81,28,98,26,"options"],[81,35,98,33],[82,4,99,2],[83,2,100,0],[83,3,100,1],[84,0,100,2],[84,3]],"functionMap":{"names":["<global>","exports.operation","exports.timeouts","timeouts.sort$argument_0","exports.createTimeout","exports.wrap","retryWrapper","args.push$argument_0","op.attempt$argument_0"],"mappings":"AAA;oBCE;CDO;mBEE;gBC8B;GDE;CFG;wBIE;CJS;eKE;kBCmB;gBCK;ODQ;iBEE;OFE;KDC;CLG"},"hasCjsExports":true},"type":"js/module"}]}