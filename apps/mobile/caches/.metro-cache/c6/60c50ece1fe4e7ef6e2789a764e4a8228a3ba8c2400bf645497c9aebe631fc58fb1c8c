{"dependencies":[{"name":"@babel/runtime/helpers/awaitAsyncGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"WZI4BLbsoFmfGv92jc0fZy7RWkQ=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/wrapAsyncGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"NV7M0GAEWUGvIKMnZy5Y7CrLwN8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/asyncIterator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"iAa+RToycgxigMSWyQzterF69/I=","exportNames":["*"],"imports":1}},{"name":"../../exports.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"EZPmsHt7bn9JJ4Y0grXw/CrOow0=","exportNames":["*"],"imports":1}},{"name":"../spanstatus.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":53,"index":106}}],"key":"oo3PNTzeCFGehsy4DLcuUh8qvTg=","exportNames":["*"],"imports":1}},{"name":"../ai/gen-ai-attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":193,"index":300}}],"key":"nKHaXfEjIYF1icPUCGJgR0o1cZ8=","exportNames":["*"],"imports":1}},{"name":"./constants.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":301},"end":{"line":4,"column":54,"index":355}}],"key":"46QfplZMuoT7/1B4GqMDknw8q/g=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":356},"end":{"line":5,"column":132,"index":488}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"instrumentStream\", {\n    enumerable: true,\n    get: function () {\n      return instrumentStream;\n    }\n  });\n  var _babelRuntimeHelpersAwaitAsyncGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/awaitAsyncGenerator\");\n  var _awaitAsyncGenerator = _interopDefault(_babelRuntimeHelpersAwaitAsyncGenerator);\n  var _babelRuntimeHelpersWrapAsyncGenerator = require(_dependencyMap[1], \"@babel/runtime/helpers/wrapAsyncGenerator\");\n  var _wrapAsyncGenerator = _interopDefault(_babelRuntimeHelpersWrapAsyncGenerator);\n  var _babelRuntimeHelpersAsyncIterator = require(_dependencyMap[2], \"@babel/runtime/helpers/asyncIterator\");\n  var _asyncIterator = _interopDefault(_babelRuntimeHelpersAsyncIterator);\n  var _exportsJs = require(_dependencyMap[3], \"../../exports.js\");\n  var _spanstatusJs = require(_dependencyMap[4], \"../spanstatus.js\");\n  var _aiGenAiAttributesJs = require(_dependencyMap[5], \"../ai/gen-ai-attributes.js\");\n  var _constantsJs = require(_dependencyMap[6], \"./constants.js\");\n  var _utilsJs = require(_dependencyMap[7], \"./utils.js\");\n  /**\n   * State object used to accumulate information from a stream of OpenAI events/chunks.\n   */\n\n  /**\n   * Processes tool calls from a chat completion chunk delta.\n   * Follows the pattern: accumulate by index, then convert to array at the end.\n   *\n   * @param toolCalls - Array of tool calls from the delta.\n   * @param state - The current streaming state to update.\n   *\n   *  @see https://platform.openai.com/docs/guides/function-calling#streaming\n   */\n  function processChatCompletionToolCalls(toolCalls, state) {\n    for (var toolCall of toolCalls) {\n      var index = toolCall.index;\n      if (index === undefined || !toolCall.function) continue;\n\n      // Initialize tool call if this is the first chunk for this index\n      if (!(index in state.chatCompletionToolCalls)) {\n        state.chatCompletionToolCalls[index] = {\n          ...toolCall,\n          function: {\n            name: toolCall.function.name,\n            arguments: toolCall.function.arguments || ''\n          }\n        };\n      } else {\n        // Accumulate function arguments from subsequent chunks\n        var existingToolCall = state.chatCompletionToolCalls[index];\n        if (toolCall.function.arguments && existingToolCall?.function) {\n          existingToolCall.function.arguments += toolCall.function.arguments;\n        }\n      }\n    }\n  }\n\n  /**\n   * Processes a single OpenAI ChatCompletionChunk event, updating the streaming state.\n   *\n   * @param chunk - The ChatCompletionChunk event to process.\n   * @param state - The current streaming state to update.\n   * @param recordOutputs - Whether to record output text fragments.\n   */\n  function processChatCompletionChunk(chunk, state, recordOutputs) {\n    state.responseId = chunk.id ?? state.responseId;\n    state.responseModel = chunk.model ?? state.responseModel;\n    state.responseTimestamp = chunk.created ?? state.responseTimestamp;\n    if (chunk.usage) {\n      // For stream responses, the input tokens remain constant across all events in the stream.\n      // Output tokens, however, are only finalized in the last event.\n      // Since we can't guarantee that the last event will include usage data or even be a typed event,\n      // we update the output token values on every event that includes them.\n      // This ensures that output token usage is always set, even if the final event lacks it.\n      state.promptTokens = chunk.usage.prompt_tokens;\n      state.completionTokens = chunk.usage.completion_tokens;\n      state.totalTokens = chunk.usage.total_tokens;\n    }\n    for (var choice of chunk.choices ?? []) {\n      if (recordOutputs) {\n        if (choice.delta?.content) {\n          state.responseTexts.push(choice.delta.content);\n        }\n\n        // Handle tool calls from delta\n        if (choice.delta?.tool_calls) {\n          processChatCompletionToolCalls(choice.delta.tool_calls, state);\n        }\n      }\n      if (choice.finish_reason) {\n        state.finishReasons.push(choice.finish_reason);\n      }\n    }\n  }\n\n  /**\n   * Processes a single OpenAI Responses API streaming event, updating the streaming state and span.\n   *\n   * @param streamEvent - The event to process (may be an error or unknown object).\n   * @param state - The current streaming state to update.\n   * @param recordOutputs - Whether to record output text fragments.\n   * @param span - The span to update with error status if needed.\n   */\n  function processResponsesApiEvent(streamEvent, state, recordOutputs, span) {\n    if (!(streamEvent && typeof streamEvent === 'object')) {\n      state.eventTypes.push('unknown:non-object');\n      return;\n    }\n    if (streamEvent instanceof Error) {\n      span.setStatus({\n        code: _spanstatusJs.SPAN_STATUS_ERROR,\n        message: 'internal_error'\n      });\n      (0, _exportsJs.captureException)(streamEvent, {\n        mechanism: {\n          handled: false,\n          type: 'auto.ai.openai.stream-response'\n        }\n      });\n      return;\n    }\n    if (!('type' in streamEvent)) return;\n    var event = streamEvent;\n    if (!_constantsJs.RESPONSE_EVENT_TYPES.includes(event.type)) {\n      state.eventTypes.push(event.type);\n      return;\n    }\n\n    // Handle output text delta\n    if (recordOutputs) {\n      // Handle tool call events for Responses API\n      if (event.type === 'response.output_item.done' && 'item' in event) {\n        state.responsesApiToolCalls.push(event.item);\n      }\n      if (event.type === 'response.output_text.delta' && 'delta' in event && event.delta) {\n        state.responseTexts.push(event.delta);\n        return;\n      }\n    }\n    if ('response' in event) {\n      var response = event.response;\n      state.responseId = response.id ?? state.responseId;\n      state.responseModel = response.model ?? state.responseModel;\n      state.responseTimestamp = response.created_at ?? state.responseTimestamp;\n      if (response.usage) {\n        // For stream responses, the input tokens remain constant across all events in the stream.\n        // Output tokens, however, are only finalized in the last event.\n        // Since we can't guarantee that the last event will include usage data or even be a typed event,\n        // we update the output token values on every event that includes them.\n        // This ensures that output token usage is always set, even if the final event lacks it.\n        state.promptTokens = response.usage.input_tokens;\n        state.completionTokens = response.usage.output_tokens;\n        state.totalTokens = response.usage.total_tokens;\n      }\n      if (response.status) {\n        state.finishReasons.push(response.status);\n      }\n      if (recordOutputs && response.output_text) {\n        state.responseTexts.push(response.output_text);\n      }\n    }\n  }\n\n  /**\n   * Instruments a stream of OpenAI events, updating the provided span with relevant attributes and\n   * optionally recording output text. This function yields each event from the input stream as it is processed.\n   *\n   * @template T - The type of events in the stream.\n   * @param stream - The async iterable stream of events to instrument.\n   * @param span - The span to add attributes to and to finish at the end of the stream.\n   * @param recordOutputs - Whether to record output text fragments in the span.\n   * @returns An async generator yielding each event from the input stream.\n   */\n  function instrumentStream(_x, _x2, _x3) {\n    return _instrumentStream.apply(this, arguments);\n  }\n  function _instrumentStream() {\n    _instrumentStream = (0, _wrapAsyncGenerator.default)(function* (stream, span, recordOutputs) {\n      var state = {\n        eventTypes: [],\n        responseTexts: [],\n        finishReasons: [],\n        responseId: '',\n        responseModel: '',\n        responseTimestamp: 0,\n        promptTokens: undefined,\n        completionTokens: undefined,\n        totalTokens: undefined,\n        chatCompletionToolCalls: {},\n        responsesApiToolCalls: []\n      };\n      try {\n        var _iteratorAbruptCompletion = false;\n        var _didIteratorError = false;\n        var _iteratorError;\n        try {\n          for (var _iterator = (0, _asyncIterator.default)(stream), _step; _iteratorAbruptCompletion = !(_step = yield (0, _awaitAsyncGenerator.default)(_iterator.next())).done; _iteratorAbruptCompletion = false) {\n            var event = _step.value;\n            {\n              if ((0, _utilsJs.isChatCompletionChunk)(event)) {\n                processChatCompletionChunk(event, state, recordOutputs);\n              } else if ((0, _utilsJs.isResponsesApiStreamEvent)(event)) {\n                processResponsesApiEvent(event, state, recordOutputs, span);\n              }\n              yield event;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (_iteratorAbruptCompletion && _iterator.return != null) {\n              yield (0, _awaitAsyncGenerator.default)(_iterator.return());\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n      } finally {\n        (0, _utilsJs.setCommonResponseAttributes)(span, state.responseId, state.responseModel, state.responseTimestamp);\n        (0, _utilsJs.setTokenUsageAttributes)(span, state.promptTokens, state.completionTokens, state.totalTokens);\n        span.setAttributes({\n          [_aiGenAiAttributesJs.GEN_AI_RESPONSE_STREAMING_ATTRIBUTE]: true\n        });\n        if (state.finishReasons.length) {\n          span.setAttributes({\n            [_aiGenAiAttributesJs.GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE]: JSON.stringify(state.finishReasons)\n          });\n        }\n        if (recordOutputs && state.responseTexts.length) {\n          span.setAttributes({\n            [_aiGenAiAttributesJs.GEN_AI_RESPONSE_TEXT_ATTRIBUTE]: state.responseTexts.join('')\n          });\n        }\n\n        // Set tool calls attribute if any were accumulated\n        var chatCompletionToolCallsArray = Object.values(state.chatCompletionToolCalls);\n        var allToolCalls = [...chatCompletionToolCallsArray, ...state.responsesApiToolCalls];\n        if (allToolCalls.length > 0) {\n          span.setAttributes({\n            [_aiGenAiAttributesJs.GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE]: JSON.stringify(allToolCalls)\n          });\n        }\n        span.end();\n      }\n    });\n    return _instrumentStream.apply(this, arguments);\n  }\n});","lineCount":260,"map":[[12,2,233,0,"Object"],[12,8,233,0],[12,9,233,0,"defineProperty"],[12,23,233,0],[12,24,233,0,"exports"],[12,31,233,0],[13,4,233,0,"enumerable"],[13,14,233,0],[14,4,233,0,"get"],[14,7,233,0],[14,18,233,0,"get"],[14,19,233,0],[15,6,233,0],[15,13,233,9,"instrumentStream"],[15,29,233,25],[16,4,233,25],[17,2,233,25],[18,2,233,28],[18,6,233,28,"_babelRuntimeHelpersAwaitAsyncGenerator"],[18,45,233,28],[18,48,233,28,"require"],[18,55,233,28],[18,56,233,28,"_dependencyMap"],[18,70,233,28],[19,2,233,28],[19,6,233,28,"_awaitAsyncGenerator"],[19,26,233,28],[19,29,233,28,"_interopDefault"],[19,44,233,28],[19,45,233,28,"_babelRuntimeHelpersAwaitAsyncGenerator"],[19,84,233,28],[20,2,233,28],[20,6,233,28,"_babelRuntimeHelpersWrapAsyncGenerator"],[20,44,233,28],[20,47,233,28,"require"],[20,54,233,28],[20,55,233,28,"_dependencyMap"],[20,69,233,28],[21,2,233,28],[21,6,233,28,"_wrapAsyncGenerator"],[21,25,233,28],[21,28,233,28,"_interopDefault"],[21,43,233,28],[21,44,233,28,"_babelRuntimeHelpersWrapAsyncGenerator"],[21,82,233,28],[22,2,233,28],[22,6,233,28,"_babelRuntimeHelpersAsyncIterator"],[22,39,233,28],[22,42,233,28,"require"],[22,49,233,28],[22,50,233,28,"_dependencyMap"],[22,64,233,28],[23,2,233,28],[23,6,233,28,"_asyncIterator"],[23,20,233,28],[23,23,233,28,"_interopDefault"],[23,38,233,28],[23,39,233,28,"_babelRuntimeHelpersAsyncIterator"],[23,72,233,28],[24,2,1,0],[24,6,1,0,"_exportsJs"],[24,16,1,0],[24,19,1,0,"require"],[24,26,1,0],[24,27,1,0,"_dependencyMap"],[24,41,1,0],[25,2,2,0],[25,6,2,0,"_spanstatusJs"],[25,19,2,0],[25,22,2,0,"require"],[25,29,2,0],[25,30,2,0,"_dependencyMap"],[25,44,2,0],[26,2,3,0],[26,6,3,0,"_aiGenAiAttributesJs"],[26,26,3,0],[26,29,3,0,"require"],[26,36,3,0],[26,37,3,0,"_dependencyMap"],[26,51,3,0],[27,2,4,0],[27,6,4,0,"_constantsJs"],[27,18,4,0],[27,21,4,0,"require"],[27,28,4,0],[27,29,4,0,"_dependencyMap"],[27,43,4,0],[28,2,5,0],[28,6,5,0,"_utilsJs"],[28,14,5,0],[28,17,5,0,"require"],[28,24,5,0],[28,25,5,0,"_dependencyMap"],[28,39,5,0],[29,2,7,0],[30,0,8,0],[31,0,9,0],[33,2,11,0],[34,0,12,0],[35,0,13,0],[36,0,14,0],[37,0,15,0],[38,0,16,0],[39,0,17,0],[40,0,18,0],[41,0,19,0],[42,2,20,0],[42,11,20,9,"processChatCompletionToolCalls"],[42,41,20,39,"processChatCompletionToolCalls"],[42,42,20,40,"toolCalls"],[42,51,20,49],[42,53,20,51,"state"],[42,58,20,56],[42,60,20,58],[43,4,21,2],[43,9,21,7],[43,13,21,13,"toolCall"],[43,21,21,21],[43,25,21,25,"toolCalls"],[43,34,21,34],[43,36,21,36],[44,6,22,4],[44,10,22,10,"index"],[44,15,22,15],[44,18,22,18,"toolCall"],[44,26,22,26],[44,27,22,27,"index"],[44,32,22,32],[45,6,23,4],[45,10,23,8,"index"],[45,15,23,13],[45,20,23,18,"undefined"],[45,29,23,27],[45,33,23,31],[45,34,23,32,"toolCall"],[45,42,23,40],[45,43,23,41,"function"],[45,51,23,49],[45,53,23,51],[47,6,25,4],[48,6,26,4],[48,10,26,8],[48,12,26,10,"index"],[48,17,26,15],[48,21,26,19,"state"],[48,26,26,24],[48,27,26,25,"chatCompletionToolCalls"],[48,50,26,48],[48,51,26,49],[48,53,26,51],[49,8,27,6,"state"],[49,13,27,11],[49,14,27,12,"chatCompletionToolCalls"],[49,37,27,35],[49,38,27,36,"index"],[49,43,27,41],[49,44,27,42],[49,47,27,45],[50,10,28,8],[50,13,28,11,"toolCall"],[50,21,28,19],[51,10,29,8,"function"],[51,18,29,16],[51,20,29,18],[52,12,30,10,"name"],[52,16,30,14],[52,18,30,16,"toolCall"],[52,26,30,24],[52,27,30,25,"function"],[52,35,30,33],[52,36,30,34,"name"],[52,40,30,38],[53,12,31,10,"arguments"],[53,21,31,19],[53,23,31,21,"toolCall"],[53,31,31,29],[53,32,31,30,"function"],[53,40,31,38],[53,41,31,39,"arguments"],[53,50,31,48],[53,54,31,52],[54,10,32,8],[55,8,33,6],[55,9,33,7],[56,6,34,4],[56,7,34,5],[56,13,34,11],[57,8,35,6],[58,8,36,6],[58,12,36,12,"existingToolCall"],[58,28,36,28],[58,31,36,31,"state"],[58,36,36,36],[58,37,36,37,"chatCompletionToolCalls"],[58,60,36,60],[58,61,36,61,"index"],[58,66,36,66],[58,67,36,67],[59,8,37,6],[59,12,37,10,"toolCall"],[59,20,37,18],[59,21,37,19,"function"],[59,29,37,27],[59,30,37,28,"arguments"],[59,39,37,37],[59,43,37,41,"existingToolCall"],[59,59,37,57],[59,61,37,59,"function"],[59,69,37,67],[59,71,37,69],[60,10,38,8,"existingToolCall"],[60,26,38,24],[60,27,38,25,"function"],[60,35,38,33],[60,36,38,34,"arguments"],[60,45,38,43],[60,49,38,47,"toolCall"],[60,57,38,55],[60,58,38,56,"function"],[60,66,38,64],[60,67,38,65,"arguments"],[60,76,38,74],[61,8,39,6],[62,6,40,4],[63,4,41,2],[64,2,42,0],[66,2,44,0],[67,0,45,0],[68,0,46,0],[69,0,47,0],[70,0,48,0],[71,0,49,0],[72,0,50,0],[73,2,51,0],[73,11,51,9,"processChatCompletionChunk"],[73,37,51,35,"processChatCompletionChunk"],[73,38,51,36,"chunk"],[73,43,51,41],[73,45,51,43,"state"],[73,50,51,48],[73,52,51,50,"recordOutputs"],[73,65,51,63],[73,67,51,65],[74,4,52,2,"state"],[74,9,52,7],[74,10,52,8,"responseId"],[74,20,52,18],[74,23,52,21,"chunk"],[74,28,52,26],[74,29,52,27,"id"],[74,31,52,29],[74,35,52,33,"state"],[74,40,52,38],[74,41,52,39,"responseId"],[74,51,52,49],[75,4,53,2,"state"],[75,9,53,7],[75,10,53,8,"responseModel"],[75,23,53,21],[75,26,53,24,"chunk"],[75,31,53,29],[75,32,53,30,"model"],[75,37,53,35],[75,41,53,39,"state"],[75,46,53,44],[75,47,53,45,"responseModel"],[75,60,53,58],[76,4,54,2,"state"],[76,9,54,7],[76,10,54,8,"responseTimestamp"],[76,27,54,25],[76,30,54,28,"chunk"],[76,35,54,33],[76,36,54,34,"created"],[76,43,54,41],[76,47,54,45,"state"],[76,52,54,50],[76,53,54,51,"responseTimestamp"],[76,70,54,68],[77,4,56,2],[77,8,56,6,"chunk"],[77,13,56,11],[77,14,56,12,"usage"],[77,19,56,17],[77,21,56,19],[78,6,57,4],[79,6,58,4],[80,6,59,4],[81,6,60,4],[82,6,61,4],[83,6,62,4,"state"],[83,11,62,9],[83,12,62,10,"promptTokens"],[83,24,62,22],[83,27,62,25,"chunk"],[83,32,62,30],[83,33,62,31,"usage"],[83,38,62,36],[83,39,62,37,"prompt_tokens"],[83,52,62,50],[84,6,63,4,"state"],[84,11,63,9],[84,12,63,10,"completionTokens"],[84,28,63,26],[84,31,63,29,"chunk"],[84,36,63,34],[84,37,63,35,"usage"],[84,42,63,40],[84,43,63,41,"completion_tokens"],[84,60,63,58],[85,6,64,4,"state"],[85,11,64,9],[85,12,64,10,"totalTokens"],[85,23,64,21],[85,26,64,24,"chunk"],[85,31,64,29],[85,32,64,30,"usage"],[85,37,64,35],[85,38,64,36,"total_tokens"],[85,50,64,48],[86,4,65,2],[87,4,67,2],[87,9,67,7],[87,13,67,13,"choice"],[87,19,67,19],[87,23,67,23,"chunk"],[87,28,67,28],[87,29,67,29,"choices"],[87,36,67,36],[87,40,67,40],[87,42,67,42],[87,44,67,44],[88,6,68,4],[88,10,68,8,"recordOutputs"],[88,23,68,21],[88,25,68,23],[89,8,69,6],[89,12,69,10,"choice"],[89,18,69,16],[89,19,69,17,"delta"],[89,24,69,22],[89,26,69,24,"content"],[89,33,69,31],[89,35,69,33],[90,10,70,8,"state"],[90,15,70,13],[90,16,70,14,"responseTexts"],[90,29,70,27],[90,30,70,28,"push"],[90,34,70,32],[90,35,70,33,"choice"],[90,41,70,39],[90,42,70,40,"delta"],[90,47,70,45],[90,48,70,46,"content"],[90,55,70,53],[90,56,70,54],[91,8,71,6],[93,8,73,6],[94,8,74,6],[94,12,74,10,"choice"],[94,18,74,16],[94,19,74,17,"delta"],[94,24,74,22],[94,26,74,24,"tool_calls"],[94,36,74,34],[94,38,74,36],[95,10,75,8,"processChatCompletionToolCalls"],[95,40,75,38],[95,41,75,39,"choice"],[95,47,75,45],[95,48,75,46,"delta"],[95,53,75,51],[95,54,75,52,"tool_calls"],[95,64,75,62],[95,66,75,64,"state"],[95,71,75,69],[95,72,75,70],[96,8,76,6],[97,6,77,4],[98,6,78,4],[98,10,78,8,"choice"],[98,16,78,14],[98,17,78,15,"finish_reason"],[98,30,78,28],[98,32,78,30],[99,8,79,6,"state"],[99,13,79,11],[99,14,79,12,"finishReasons"],[99,27,79,25],[99,28,79,26,"push"],[99,32,79,30],[99,33,79,31,"choice"],[99,39,79,37],[99,40,79,38,"finish_reason"],[99,53,79,51],[99,54,79,52],[100,6,80,4],[101,4,81,2],[102,2,82,0],[104,2,84,0],[105,0,85,0],[106,0,86,0],[107,0,87,0],[108,0,88,0],[109,0,89,0],[110,0,90,0],[111,0,91,0],[112,2,92,0],[112,11,92,9,"processResponsesApiEvent"],[112,35,92,33,"processResponsesApiEvent"],[112,36,93,2,"streamEvent"],[112,47,93,13],[112,49,94,2,"state"],[112,54,94,7],[112,56,95,2,"recordOutputs"],[112,69,95,15],[112,71,96,2,"span"],[112,75,96,6],[112,77,97,2],[113,4,98,2],[113,8,98,6],[113,10,98,8,"streamEvent"],[113,21,98,19],[113,25,98,23],[113,32,98,30,"streamEvent"],[113,43,98,41],[113,48,98,46],[113,56,98,54],[113,57,98,55],[113,59,98,57],[114,6,99,4,"state"],[114,11,99,9],[114,12,99,10,"eventTypes"],[114,22,99,20],[114,23,99,21,"push"],[114,27,99,25],[114,28,99,26],[114,48,99,46],[114,49,99,47],[115,6,100,4],[116,4,101,2],[117,4,102,2],[117,8,102,6,"streamEvent"],[117,19,102,17],[117,31,102,29,"Error"],[117,36,102,34],[117,38,102,36],[118,6,103,4,"span"],[118,10,103,8],[118,11,103,9,"setStatus"],[118,20,103,18],[118,21,103,19],[119,8,103,21,"code"],[119,12,103,25],[119,14,103,27,"SPAN_STATUS_ERROR"],[119,27,103,44],[119,28,103,44,"SPAN_STATUS_ERROR"],[119,45,103,44],[120,8,103,46,"message"],[120,15,103,53],[120,17,103,55],[121,6,103,72],[121,7,103,73],[121,8,103,74],[122,6,104,4],[122,10,104,4,"captureException"],[122,20,104,20],[122,21,104,20,"captureException"],[122,37,104,20],[122,39,104,21,"streamEvent"],[122,50,104,32],[122,52,104,34],[123,8,105,6,"mechanism"],[123,17,105,15],[123,19,105,17],[124,10,106,8,"handled"],[124,17,106,15],[124,19,106,17],[124,24,106,22],[125,10,107,8,"type"],[125,14,107,12],[125,16,107,14],[126,8,108,6],[127,6,109,4],[127,7,109,5],[127,8,109,6],[128,6,110,4],[129,4,111,2],[130,4,113,2],[130,8,113,6],[130,10,113,8],[130,16,113,14],[130,20,113,18,"streamEvent"],[130,31,113,29],[130,32,113,30],[130,34,113,32],[131,4,114,2],[131,8,114,8,"event"],[131,13,114,13],[131,16,114,16,"streamEvent"],[131,27,114,27],[132,4,116,2],[132,8,116,6],[132,9,116,7,"RESPONSE_EVENT_TYPES"],[132,21,116,27],[132,22,116,27,"RESPONSE_EVENT_TYPES"],[132,42,116,27],[132,43,116,28,"includes"],[132,51,116,36],[132,52,116,37,"event"],[132,57,116,42],[132,58,116,43,"type"],[132,62,116,47],[132,63,116,48],[132,65,116,50],[133,6,117,4,"state"],[133,11,117,9],[133,12,117,10,"eventTypes"],[133,22,117,20],[133,23,117,21,"push"],[133,27,117,25],[133,28,117,26,"event"],[133,33,117,31],[133,34,117,32,"type"],[133,38,117,36],[133,39,117,37],[134,6,118,4],[135,4,119,2],[137,4,121,2],[138,4,122,2],[138,8,122,6,"recordOutputs"],[138,21,122,19],[138,23,122,21],[139,6,123,4],[140,6,124,4],[140,10,124,8,"event"],[140,15,124,13],[140,16,124,14,"type"],[140,20,124,18],[140,25,124,23],[140,52,124,50],[140,56,124,54],[140,62,124,60],[140,66,124,64,"event"],[140,71,124,69],[140,73,124,71],[141,8,125,6,"state"],[141,13,125,11],[141,14,125,12,"responsesApiToolCalls"],[141,35,125,33],[141,36,125,34,"push"],[141,40,125,38],[141,41,125,39,"event"],[141,46,125,44],[141,47,125,45,"item"],[141,51,125,49],[141,52,125,50],[142,6,126,4],[143,6,128,4],[143,10,128,8,"event"],[143,15,128,13],[143,16,128,14,"type"],[143,20,128,18],[143,25,128,23],[143,53,128,51],[143,57,128,55],[143,64,128,62],[143,68,128,66,"event"],[143,73,128,71],[143,77,128,75,"event"],[143,82,128,80],[143,83,128,81,"delta"],[143,88,128,86],[143,90,128,88],[144,8,129,6,"state"],[144,13,129,11],[144,14,129,12,"responseTexts"],[144,27,129,25],[144,28,129,26,"push"],[144,32,129,30],[144,33,129,31,"event"],[144,38,129,36],[144,39,129,37,"delta"],[144,44,129,42],[144,45,129,43],[145,8,130,6],[146,6,131,4],[147,4,132,2],[148,4,134,2],[148,8,134,6],[148,18,134,16],[148,22,134,20,"event"],[148,27,134,25],[148,29,134,27],[149,6,135,4],[149,10,135,12,"response"],[149,18,135,20],[149,21,135,25,"event"],[149,26,135,30],[149,27,135,12,"response"],[149,35,135,20],[150,6,136,4,"state"],[150,11,136,9],[150,12,136,10,"responseId"],[150,22,136,20],[150,25,136,23,"response"],[150,33,136,31],[150,34,136,32,"id"],[150,36,136,34],[150,40,136,38,"state"],[150,45,136,43],[150,46,136,44,"responseId"],[150,56,136,54],[151,6,137,4,"state"],[151,11,137,9],[151,12,137,10,"responseModel"],[151,25,137,23],[151,28,137,26,"response"],[151,36,137,34],[151,37,137,35,"model"],[151,42,137,40],[151,46,137,44,"state"],[151,51,137,49],[151,52,137,50,"responseModel"],[151,65,137,63],[152,6,138,4,"state"],[152,11,138,9],[152,12,138,10,"responseTimestamp"],[152,29,138,27],[152,32,138,30,"response"],[152,40,138,38],[152,41,138,39,"created_at"],[152,51,138,49],[152,55,138,53,"state"],[152,60,138,58],[152,61,138,59,"responseTimestamp"],[152,78,138,76],[153,6,140,4],[153,10,140,8,"response"],[153,18,140,16],[153,19,140,17,"usage"],[153,24,140,22],[153,26,140,24],[154,8,141,6],[155,8,142,6],[156,8,143,6],[157,8,144,6],[158,8,145,6],[159,8,146,6,"state"],[159,13,146,11],[159,14,146,12,"promptTokens"],[159,26,146,24],[159,29,146,27,"response"],[159,37,146,35],[159,38,146,36,"usage"],[159,43,146,41],[159,44,146,42,"input_tokens"],[159,56,146,54],[160,8,147,6,"state"],[160,13,147,11],[160,14,147,12,"completionTokens"],[160,30,147,28],[160,33,147,31,"response"],[160,41,147,39],[160,42,147,40,"usage"],[160,47,147,45],[160,48,147,46,"output_tokens"],[160,61,147,59],[161,8,148,6,"state"],[161,13,148,11],[161,14,148,12,"totalTokens"],[161,25,148,23],[161,28,148,26,"response"],[161,36,148,34],[161,37,148,35,"usage"],[161,42,148,40],[161,43,148,41,"total_tokens"],[161,55,148,53],[162,6,149,4],[163,6,151,4],[163,10,151,8,"response"],[163,18,151,16],[163,19,151,17,"status"],[163,25,151,23],[163,27,151,25],[164,8,152,6,"state"],[164,13,152,11],[164,14,152,12,"finishReasons"],[164,27,152,25],[164,28,152,26,"push"],[164,32,152,30],[164,33,152,31,"response"],[164,41,152,39],[164,42,152,40,"status"],[164,48,152,46],[164,49,152,47],[165,6,153,4],[166,6,155,4],[166,10,155,8,"recordOutputs"],[166,23,155,21],[166,27,155,25,"response"],[166,35,155,33],[166,36,155,34,"output_text"],[166,47,155,45],[166,49,155,47],[167,8,156,6,"state"],[167,13,156,11],[167,14,156,12,"responseTexts"],[167,27,156,25],[167,28,156,26,"push"],[167,32,156,30],[167,33,156,31,"response"],[167,41,156,39],[167,42,156,40,"output_text"],[167,53,156,51],[167,54,156,52],[168,6,157,4],[169,4,158,2],[170,2,159,0],[172,2,161,0],[173,0,162,0],[174,0,163,0],[175,0,164,0],[176,0,165,0],[177,0,166,0],[178,0,167,0],[179,0,168,0],[180,0,169,0],[181,0,170,0],[182,2,161,0],[182,11,171,16,"instrumentStream"],[182,27,171,32,"instrumentStream"],[182,28,171,32,"_x"],[182,30,171,32],[182,32,171,32,"_x2"],[182,35,171,32],[182,37,171,32,"_x3"],[182,40,171,32],[183,4,171,32],[183,11,171,32,"_instrumentStream"],[183,28,171,32],[183,29,171,32,"apply"],[183,34,171,32],[183,41,171,32,"arguments"],[183,50,171,32],[184,2,171,32],[185,2,171,32],[185,11,171,32,"_instrumentStream"],[185,29,171,32],[186,4,171,32,"_instrumentStream"],[186,21,171,32],[186,28,171,32,"_wrapAsyncGenerator"],[186,47,171,32],[186,48,171,32,"default"],[186,55,171,32],[186,57,171,0],[186,68,172,2,"stream"],[186,74,172,8],[186,76,173,2,"span"],[186,80,173,6],[186,82,174,2,"recordOutputs"],[186,95,174,15],[186,97,175,2],[187,6,176,2],[187,10,176,8,"state"],[187,15,176,13],[187,18,176,16],[188,8,177,4,"eventTypes"],[188,18,177,14],[188,20,177,16],[188,22,177,18],[189,8,178,4,"responseTexts"],[189,21,178,17],[189,23,178,19],[189,25,178,21],[190,8,179,4,"finishReasons"],[190,21,179,17],[190,23,179,19],[190,25,179,21],[191,8,180,4,"responseId"],[191,18,180,14],[191,20,180,16],[191,22,180,18],[192,8,181,4,"responseModel"],[192,21,181,17],[192,23,181,19],[192,25,181,21],[193,8,182,4,"responseTimestamp"],[193,25,182,21],[193,27,182,23],[193,28,182,24],[194,8,183,4,"promptTokens"],[194,20,183,16],[194,22,183,18,"undefined"],[194,31,183,27],[195,8,184,4,"completionTokens"],[195,24,184,20],[195,26,184,22,"undefined"],[195,35,184,31],[196,8,185,4,"totalTokens"],[196,19,185,15],[196,21,185,17,"undefined"],[196,30,185,26],[197,8,186,4,"chatCompletionToolCalls"],[197,31,186,27],[197,33,186,29],[197,34,186,30],[197,35,186,31],[198,8,187,4,"responsesApiToolCalls"],[198,29,187,25],[198,31,187,27],[199,6,188,2],[199,7,188,3],[200,6,190,2],[200,10,190,6],[201,8,190,6],[201,12,190,6,"_iteratorAbruptCompletion"],[201,37,190,6],[202,8,190,6],[202,12,190,6,"_didIteratorError"],[202,29,190,6],[203,8,190,6],[203,12,190,6,"_iteratorError"],[203,26,190,6],[204,8,190,6],[205,10,191,4],[205,19,191,4,"_iterator"],[205,28,191,4],[205,35,191,4,"_asyncIterator"],[205,49,191,4],[205,50,191,4,"default"],[205,57,191,4],[205,59,191,30,"stream"],[205,65,191,36],[205,68,191,36,"_step"],[205,73,191,36],[205,75,191,36,"_iteratorAbruptCompletion"],[205,100,191,36],[205,105,191,36,"_step"],[205,110,191,36],[205,123,191,36,"_awaitAsyncGenerator"],[205,143,191,36],[205,144,191,36,"default"],[205,151,191,36],[205,153,191,36,"_iterator"],[205,162,191,36],[205,163,191,36,"next"],[205,167,191,36],[205,172,191,36,"done"],[205,176,191,36],[205,178,191,36,"_iteratorAbruptCompletion"],[205,203,191,36],[205,213,191,38],[206,12,191,38],[206,16,191,21,"event"],[206,21,191,26],[206,24,191,26,"_step"],[206,29,191,26],[206,30,191,26,"value"],[206,35,191,26],[207,12,191,26],[208,14,192,6],[208,18,192,10],[208,22,192,10,"isChatCompletionChunk"],[208,30,192,31],[208,31,192,31,"isChatCompletionChunk"],[208,52,192,31],[208,54,192,32,"event"],[208,59,192,37],[208,60,192,38],[208,62,192,40],[209,16,193,8,"processChatCompletionChunk"],[209,42,193,34],[209,43,193,35,"event"],[209,48,193,40],[209,50,193,43,"state"],[209,55,193,48],[209,57,193,50,"recordOutputs"],[209,70,193,63],[209,71,193,64],[210,14,194,6],[210,15,194,7],[210,21,194,13],[210,25,194,17],[210,29,194,17,"isResponsesApiStreamEvent"],[210,37,194,42],[210,38,194,42,"isResponsesApiStreamEvent"],[210,63,194,42],[210,65,194,43,"event"],[210,70,194,48],[210,71,194,49],[210,73,194,51],[211,16,195,8,"processResponsesApiEvent"],[211,40,195,32],[211,41,195,33,"event"],[211,46,195,38],[211,48,195,41,"state"],[211,53,195,46],[211,55,195,48,"recordOutputs"],[211,68,195,61],[211,70,195,63,"span"],[211,74,195,67],[211,75,195,68],[212,14,196,6],[213,14,197,6],[213,20,197,12,"event"],[213,25,197,17],[214,12,197,18],[215,10,198,4],[216,8,198,5],[216,17,198,5,"err"],[216,20,198,5],[217,10,198,5,"_didIteratorError"],[217,27,198,5],[218,10,198,5,"_iteratorError"],[218,24,198,5],[218,27,198,5,"err"],[218,30,198,5],[219,8,198,5],[220,10,198,5],[221,12,198,5],[221,16,198,5,"_iteratorAbruptCompletion"],[221,41,198,5],[221,45,198,5,"_iterator"],[221,54,198,5],[221,55,198,5,"return"],[221,61,198,5],[222,14,198,5],[222,24,198,5,"_awaitAsyncGenerator"],[222,44,198,5],[222,45,198,5,"default"],[222,52,198,5],[222,54,198,5,"_iterator"],[222,63,198,5],[222,64,198,5,"return"],[222,70,198,5],[223,12,198,5],[224,10,198,5],[225,12,198,5],[225,16,198,5,"_didIteratorError"],[225,33,198,5],[226,14,198,5],[226,20,198,5,"_iteratorError"],[226,34,198,5],[227,12,198,5],[228,10,198,5],[229,8,198,5],[230,6,199,2],[230,7,199,3],[230,16,199,12],[231,8,200,4],[231,12,200,4,"setCommonResponseAttributes"],[231,20,200,31],[231,21,200,31,"setCommonResponseAttributes"],[231,48,200,31],[231,50,200,32,"span"],[231,54,200,36],[231,56,200,38,"state"],[231,61,200,43],[231,62,200,44,"responseId"],[231,72,200,54],[231,74,200,56,"state"],[231,79,200,61],[231,80,200,62,"responseModel"],[231,93,200,75],[231,95,200,77,"state"],[231,100,200,82],[231,101,200,83,"responseTimestamp"],[231,118,200,100],[231,119,200,101],[232,8,201,4],[232,12,201,4,"setTokenUsageAttributes"],[232,20,201,27],[232,21,201,27,"setTokenUsageAttributes"],[232,44,201,27],[232,46,201,28,"span"],[232,50,201,32],[232,52,201,34,"state"],[232,57,201,39],[232,58,201,40,"promptTokens"],[232,70,201,52],[232,72,201,54,"state"],[232,77,201,59],[232,78,201,60,"completionTokens"],[232,94,201,76],[232,96,201,78,"state"],[232,101,201,83],[232,102,201,84,"totalTokens"],[232,113,201,95],[232,114,201,96],[233,8,203,4,"span"],[233,12,203,8],[233,13,203,9,"setAttributes"],[233,26,203,22],[233,27,203,23],[234,10,204,6],[234,11,204,7,"GEN_AI_RESPONSE_STREAMING_ATTRIBUTE"],[234,31,204,42],[234,32,204,42,"GEN_AI_RESPONSE_STREAMING_ATTRIBUTE"],[234,67,204,42],[234,70,204,45],[235,8,205,4],[235,9,205,5],[235,10,205,6],[236,8,207,4],[236,12,207,8,"state"],[236,17,207,13],[236,18,207,14,"finishReasons"],[236,31,207,27],[236,32,207,28,"length"],[236,38,207,34],[236,40,207,36],[237,10,208,6,"span"],[237,14,208,10],[237,15,208,11,"setAttributes"],[237,28,208,24],[237,29,208,25],[238,12,209,8],[238,13,209,9,"GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE"],[238,33,209,49],[238,34,209,49,"GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE"],[238,74,209,49],[238,77,209,52,"JSON"],[238,81,209,56],[238,82,209,57,"stringify"],[238,91,209,66],[238,92,209,67,"state"],[238,97,209,72],[238,98,209,73,"finishReasons"],[238,111,209,86],[239,10,210,6],[239,11,210,7],[239,12,210,8],[240,8,211,4],[241,8,213,4],[241,12,213,8,"recordOutputs"],[241,25,213,21],[241,29,213,25,"state"],[241,34,213,30],[241,35,213,31,"responseTexts"],[241,48,213,44],[241,49,213,45,"length"],[241,55,213,51],[241,57,213,53],[242,10,214,6,"span"],[242,14,214,10],[242,15,214,11,"setAttributes"],[242,28,214,24],[242,29,214,25],[243,12,215,8],[243,13,215,9,"GEN_AI_RESPONSE_TEXT_ATTRIBUTE"],[243,33,215,39],[243,34,215,39,"GEN_AI_RESPONSE_TEXT_ATTRIBUTE"],[243,64,215,39],[243,67,215,42,"state"],[243,72,215,47],[243,73,215,48,"responseTexts"],[243,86,215,61],[243,87,215,62,"join"],[243,91,215,66],[243,92,215,67],[243,94,215,69],[244,10,216,6],[244,11,216,7],[244,12,216,8],[245,8,217,4],[247,8,219,4],[248,8,220,4],[248,12,220,10,"chatCompletionToolCallsArray"],[248,40,220,38],[248,43,220,41,"Object"],[248,49,220,47],[248,50,220,48,"values"],[248,56,220,54],[248,57,220,55,"state"],[248,62,220,60],[248,63,220,61,"chatCompletionToolCalls"],[248,86,220,84],[248,87,220,85],[249,8,221,4],[249,12,221,10,"allToolCalls"],[249,24,221,22],[249,27,221,25],[249,28,221,26],[249,31,221,29,"chatCompletionToolCallsArray"],[249,59,221,57],[249,61,221,59],[249,64,221,62,"state"],[249,69,221,67],[249,70,221,68,"responsesApiToolCalls"],[249,91,221,89],[249,92,221,90],[250,8,223,4],[250,12,223,8,"allToolCalls"],[250,24,223,20],[250,25,223,21,"length"],[250,31,223,27],[250,34,223,30],[250,35,223,31],[250,37,223,33],[251,10,224,6,"span"],[251,14,224,10],[251,15,224,11,"setAttributes"],[251,28,224,24],[251,29,224,25],[252,12,225,8],[252,13,225,9,"GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE"],[252,33,225,45],[252,34,225,45,"GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE"],[252,70,225,45],[252,73,225,48,"JSON"],[252,77,225,52],[252,78,225,53,"stringify"],[252,87,225,62],[252,88,225,63,"allToolCalls"],[252,100,225,75],[253,10,226,6],[253,11,226,7],[253,12,226,8],[254,8,227,4],[255,8,229,4,"span"],[255,12,229,8],[255,13,229,9,"end"],[255,16,229,12],[255,17,229,13],[255,18,229,14],[256,6,230,2],[257,4,231,0],[257,5,231,1],[258,4,231,1],[258,11,231,1,"_instrumentStream"],[258,28,231,1],[258,29,231,1,"apply"],[258,34,231,1],[258,41,231,1,"arguments"],[258,50,231,1],[259,2,231,1],[260,0,231,1],[260,3]],"functionMap":{"names":["<global>","processChatCompletionToolCalls","processChatCompletionChunk","processResponsesApiEvent","instrumentStream"],"mappings":"AAA;ACmB;CDsB;AES;CF+B;AGU;CHmE;AIY;CJ4D"},"hasCjsExports":false},"type":"js/module"}]}