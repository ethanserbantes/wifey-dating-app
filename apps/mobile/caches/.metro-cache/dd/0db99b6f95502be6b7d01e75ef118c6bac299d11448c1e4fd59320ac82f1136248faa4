{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":66,"index":66}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-navigation/native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":67},"end":{"line":2,"column":58,"index":125}}],"key":"yKhyWCfwa1gXEwEbMKnWHykYbZ4=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":126},"end":{"line":3,"column":55,"index":181}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/hooks/usePendingDateFeedback","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":182},"end":{"line":4,"column":72,"index":254}}],"key":"62Z9chell6H1kn1gDwIkzD2hBE4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useMessagesFeedback = useMessagesFeedback;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2], \"react\");\n  var _reactNavigationNative = require(_dependencyMap[3], \"@react-navigation/native\");\n  var _tanstackReactQuery = require(_dependencyMap[4], \"@tanstack/react-query\");\n  var _hooksUsePendingDateFeedback = require(_dependencyMap[5], \"@/hooks/usePendingDateFeedback\");\n  function useMessagesFeedback(user) {\n    _s();\n    var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      feedbackOpen = _useState2[0],\n      setFeedbackOpen = _useState2[1];\n    var _useState3 = (0, _react.useState)(null),\n      _useState4 = (0, _slicedToArray.default)(_useState3, 2),\n      activeFeedback = _useState4[0],\n      setActiveFeedback = _useState4[1];\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var pendingKey = (0, _react.useMemo)(() => {\n      var uid = Number(user?.id);\n      return [\"pendingDateFeedback\", uid];\n    }, [user?.id]);\n    var pendingFeedbackQuery = (0, _hooksUsePendingDateFeedback.usePendingDateFeedback)(user?.id);\n    var maybeOpenFeedbackPrompt = (0, _react.useCallback)(pending => {\n      if (feedbackOpen) return;\n      var list = Array.isArray(pending) ? pending : [];\n      if (list.length === 0) return;\n      var first = list[0];\n      setActiveFeedback(first);\n      setFeedbackOpen(true);\n    }, [feedbackOpen]);\n    (0, _react.useEffect)(() => {\n      if (!user?.id) return;\n      if (!pendingFeedbackQuery.isSuccess) return;\n      var pending = pendingFeedbackQuery.data?.pending || [];\n      maybeOpenFeedbackPrompt(pending);\n    }, [maybeOpenFeedbackPrompt, pendingFeedbackQuery.data?.pending, pendingFeedbackQuery.isSuccess, user?.id]);\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) {\n        return;\n      }\n      pendingFeedbackQuery.refetch().then(result => {\n        var pending = result?.data?.pending || [];\n        maybeOpenFeedbackPrompt(pending);\n      }).catch(e => {\n        console.error(e);\n      });\n    }, [maybeOpenFeedbackPrompt, pendingFeedbackQuery, user?.id]));\n    var handleFeedbackSubmitted = (0, _react.useCallback)(/*#__PURE__*/(0, _asyncToGenerator.default)(function* () {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        matchId = _ref2.matchId;\n      setFeedbackOpen(false);\n      setActiveFeedback(null);\n      try {\n        if (Number.isFinite(Number(matchId))) {\n          queryClient.setQueryData(pendingKey, old => {\n            var oldPending = Array.isArray(old?.pending) ? old.pending : [];\n            return {\n              pending: oldPending.filter(p => Number(p?.matchId) !== Number(matchId))\n            };\n          });\n        }\n      } catch (e) {\n        console.error(e);\n      }\n      try {\n        var result = yield pendingFeedbackQuery.refetch();\n        var pending = result?.data?.pending || [];\n        if (pending.length > 0) {\n          setActiveFeedback(pending[0]);\n          setFeedbackOpen(true);\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    }), [pendingFeedbackQuery, pendingKey, queryClient]);\n    return {\n      feedbackOpen,\n      activeFeedback,\n      handleFeedbackSubmitted\n    };\n  }\n  _s(useMessagesFeedback, \"tTxvmg8W8wIldFwPMolIHOEy2JY=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _hooksUsePendingDateFeedback.usePendingDateFeedback, _reactNavigationNative.useFocusEffect];\n  });\n});","lineCount":100,"map":[[13,2,6,0,"exports"],[13,9,6,0],[13,10,6,0,"useMessagesFeedback"],[13,29,6,0],[13,32,6,0,"useMessagesFeedback"],[13,51,6,0],[14,2,99,1],[14,6,99,1,"_babelRuntimeHelpersAsyncToGenerator"],[14,42,99,1],[14,45,99,1,"require"],[14,52,99,1],[14,53,99,1,"_dependencyMap"],[14,67,99,1],[15,2,99,1],[15,6,99,1,"_asyncToGenerator"],[15,23,99,1],[15,26,99,1,"_interopDefault"],[15,41,99,1],[15,42,99,1,"_babelRuntimeHelpersAsyncToGenerator"],[15,78,99,1],[16,2,99,1],[16,6,99,1,"_babelRuntimeHelpersSlicedToArray"],[16,39,99,1],[16,42,99,1,"require"],[16,49,99,1],[16,50,99,1,"_dependencyMap"],[16,64,99,1],[17,2,99,1],[17,6,99,1,"_slicedToArray"],[17,20,99,1],[17,23,99,1,"_interopDefault"],[17,38,99,1],[17,39,99,1,"_babelRuntimeHelpersSlicedToArray"],[17,72,99,1],[18,2,1,0],[18,6,1,0,"_react"],[18,12,1,0],[18,15,1,0,"require"],[18,22,1,0],[18,23,1,0,"_dependencyMap"],[18,37,1,0],[19,2,2,0],[19,6,2,0,"_reactNavigationNative"],[19,28,2,0],[19,31,2,0,"require"],[19,38,2,0],[19,39,2,0,"_dependencyMap"],[19,53,2,0],[20,2,3,0],[20,6,3,0,"_tanstackReactQuery"],[20,25,3,0],[20,28,3,0,"require"],[20,35,3,0],[20,36,3,0,"_dependencyMap"],[20,50,3,0],[21,2,4,0],[21,6,4,0,"_hooksUsePendingDateFeedback"],[21,34,4,0],[21,37,4,0,"require"],[21,44,4,0],[21,45,4,0,"_dependencyMap"],[21,59,4,0],[22,2,6,7],[22,11,6,16,"useMessagesFeedback"],[22,30,6,35,"useMessagesFeedback"],[22,31,6,36,"user"],[22,35,6,40],[22,37,6,42],[23,4,6,42,"_s"],[23,6,6,42],[24,4,7,2],[24,8,7,2,"_useState"],[24,17,7,2],[24,20,7,42],[24,24,7,42,"useState"],[24,30,7,50],[24,31,7,50,"useState"],[24,39,7,50],[24,41,7,51],[24,46,7,56],[24,47,7,57],[25,6,7,57,"_useState2"],[25,16,7,57],[25,23,7,57,"_slicedToArray"],[25,37,7,57],[25,38,7,57,"default"],[25,45,7,57],[25,47,7,57,"_useState"],[25,56,7,57],[26,6,7,9,"feedbackOpen"],[26,18,7,21],[26,21,7,21,"_useState2"],[26,31,7,21],[27,6,7,23,"setFeedbackOpen"],[27,21,7,38],[27,24,7,38,"_useState2"],[27,34,7,38],[28,4,8,2],[28,8,8,2,"_useState3"],[28,18,8,2],[28,21,8,46],[28,25,8,46,"useState"],[28,31,8,54],[28,32,8,54,"useState"],[28,40,8,54],[28,42,8,55],[28,46,8,59],[28,47,8,60],[29,6,8,60,"_useState4"],[29,16,8,60],[29,23,8,60,"_slicedToArray"],[29,37,8,60],[29,38,8,60,"default"],[29,45,8,60],[29,47,8,60,"_useState3"],[29,57,8,60],[30,6,8,9,"activeFeedback"],[30,20,8,23],[30,23,8,23,"_useState4"],[30,33,8,23],[31,6,8,25,"setActiveFeedback"],[31,23,8,42],[31,26,8,42,"_useState4"],[31,36,8,42],[32,4,9,2],[32,8,9,8,"queryClient"],[32,19,9,19],[32,22,9,22],[32,26,9,22,"useQueryClient"],[32,45,9,36],[32,46,9,36,"useQueryClient"],[32,60,9,36],[32,62,9,37],[32,63,9,38],[33,4,11,2],[33,8,11,8,"pendingKey"],[33,18,11,18],[33,21,11,21],[33,25,11,21,"useMemo"],[33,31,11,28],[33,32,11,28,"useMemo"],[33,39,11,28],[33,41,11,29],[33,47,11,35],[34,6,12,4],[34,10,12,10,"uid"],[34,13,12,13],[34,16,12,16,"Number"],[34,22,12,22],[34,23,12,23,"user"],[34,27,12,27],[34,29,12,29,"id"],[34,31,12,31],[34,32,12,32],[35,6,13,4],[35,13,13,11],[35,14,13,12],[35,35,13,33],[35,37,13,35,"uid"],[35,40,13,38],[35,41,13,39],[36,4,14,2],[36,5,14,3],[36,7,14,5],[36,8,14,6,"user"],[36,12,14,10],[36,14,14,12,"id"],[36,16,14,14],[36,17,14,15],[36,18,14,16],[37,4,16,2],[37,8,16,8,"pendingFeedbackQuery"],[37,28,16,28],[37,31,16,31],[37,35,16,31,"usePendingDateFeedback"],[37,63,16,53],[37,64,16,53,"usePendingDateFeedback"],[37,86,16,53],[37,88,16,54,"user"],[37,92,16,58],[37,94,16,60,"id"],[37,96,16,62],[37,97,16,63],[38,4,18,2],[38,8,18,8,"maybeOpenFeedbackPrompt"],[38,31,18,31],[38,34,18,34],[38,38,18,34,"useCallback"],[38,44,18,45],[38,45,18,45,"useCallback"],[38,56,18,45],[38,58,19,5,"pending"],[38,65,19,12],[38,69,19,17],[39,6,20,6],[39,10,20,10,"feedbackOpen"],[39,22,20,22],[39,24,20,24],[40,6,21,6],[40,10,21,12,"list"],[40,14,21,16],[40,17,21,19,"Array"],[40,22,21,24],[40,23,21,25,"isArray"],[40,30,21,32],[40,31,21,33,"pending"],[40,38,21,40],[40,39,21,41],[40,42,21,44,"pending"],[40,49,21,51],[40,52,21,54],[40,54,21,56],[41,6,22,6],[41,10,22,10,"list"],[41,14,22,14],[41,15,22,15,"length"],[41,21,22,21],[41,26,22,26],[41,27,22,27],[41,29,22,29],[42,6,23,6],[42,10,23,12,"first"],[42,15,23,17],[42,18,23,20,"list"],[42,22,23,24],[42,23,23,25],[42,24,23,26],[42,25,23,27],[43,6,24,6,"setActiveFeedback"],[43,23,24,23],[43,24,24,24,"first"],[43,29,24,29],[43,30,24,30],[44,6,25,6,"setFeedbackOpen"],[44,21,25,21],[44,22,25,22],[44,26,25,26],[44,27,25,27],[45,4,26,4],[45,5,26,5],[45,7,27,4],[45,8,27,5,"feedbackOpen"],[45,20,27,17],[45,21,28,2],[45,22,28,3],[46,4,30,2],[46,8,30,2,"useEffect"],[46,14,30,11],[46,15,30,11,"useEffect"],[46,24,30,11],[46,26,30,12],[46,32,30,18],[47,6,31,4],[47,10,31,8],[47,11,31,9,"user"],[47,15,31,13],[47,17,31,15,"id"],[47,19,31,17],[47,21,31,19],[48,6,32,4],[48,10,32,8],[48,11,32,9,"pendingFeedbackQuery"],[48,31,32,29],[48,32,32,30,"isSuccess"],[48,41,32,39],[48,43,32,41],[49,6,33,4],[49,10,33,10,"pending"],[49,17,33,17],[49,20,33,20,"pendingFeedbackQuery"],[49,40,33,40],[49,41,33,41,"data"],[49,45,33,45],[49,47,33,47,"pending"],[49,54,33,54],[49,58,33,58],[49,60,33,60],[50,6,34,4,"maybeOpenFeedbackPrompt"],[50,29,34,27],[50,30,34,28,"pending"],[50,37,34,35],[50,38,34,36],[51,4,35,2],[51,5,35,3],[51,7,35,5],[51,8,36,4,"maybeOpenFeedbackPrompt"],[51,31,36,27],[51,33,37,4,"pendingFeedbackQuery"],[51,53,37,24],[51,54,37,25,"data"],[51,58,37,29],[51,60,37,31,"pending"],[51,67,37,38],[51,69,38,4,"pendingFeedbackQuery"],[51,89,38,24],[51,90,38,25,"isSuccess"],[51,99,38,34],[51,101,39,4,"user"],[51,105,39,8],[51,107,39,10,"id"],[51,109,39,12],[51,110,40,3],[51,111,40,4],[52,4,42,2],[52,8,42,2,"useFocusEffect"],[52,30,42,16],[52,31,42,16,"useFocusEffect"],[52,45,42,16],[52,47,43,4],[52,51,43,4,"useCallback"],[52,57,43,15],[52,58,43,15,"useCallback"],[52,69,43,15],[52,71,43,16],[52,77,43,22],[53,6,44,6],[53,10,44,10],[53,11,44,11,"user"],[53,15,44,15],[53,17,44,17,"id"],[53,19,44,19],[53,21,44,21],[54,8,45,8],[55,6,46,6],[56,6,48,6,"pendingFeedbackQuery"],[56,26,48,26],[56,27,49,9,"refetch"],[56,34,49,16],[56,35,49,17],[56,36,49,18],[56,37,50,9,"then"],[56,41,50,13],[56,42,50,15,"result"],[56,48,50,21],[56,52,50,26],[57,8,51,10],[57,12,51,16,"pending"],[57,19,51,23],[57,22,51,26,"result"],[57,28,51,32],[57,30,51,34,"data"],[57,34,51,38],[57,36,51,40,"pending"],[57,43,51,47],[57,47,51,51],[57,49,51,53],[58,8,52,10,"maybeOpenFeedbackPrompt"],[58,31,52,33],[58,32,52,34,"pending"],[58,39,52,41],[58,40,52,42],[59,6,53,8],[59,7,53,9],[59,8,53,10],[59,9,54,9,"catch"],[59,14,54,14],[59,15,54,16,"e"],[59,16,54,17],[59,20,54,22],[60,8,55,10,"console"],[60,15,55,17],[60,16,55,18,"error"],[60,21,55,23],[60,22,55,24,"e"],[60,23,55,25],[60,24,55,26],[61,6,56,8],[61,7,56,9],[61,8,56,10],[62,4,57,4],[62,5,57,5],[62,7,57,7],[62,8,57,8,"maybeOpenFeedbackPrompt"],[62,31,57,31],[62,33,57,33,"pendingFeedbackQuery"],[62,53,57,53],[62,55,57,55,"user"],[62,59,57,59],[62,61,57,61,"id"],[62,63,57,63],[62,64,57,64],[62,65,58,2],[62,66,58,3],[63,4,60,2],[63,8,60,8,"handleFeedbackSubmitted"],[63,31,60,31],[63,34,60,34],[63,38,60,34,"useCallback"],[63,44,60,45],[63,45,60,45,"useCallback"],[63,56,60,45],[63,75,60,45,"_asyncToGenerator"],[63,92,60,45],[63,93,60,45,"default"],[63,100,60,45],[63,102,61,4],[63,115,61,32],[64,6,61,32],[64,10,61,32,"_ref2"],[64,15,61,32],[64,18,61,32,"arguments"],[64,27,61,32],[64,28,61,32,"length"],[64,34,61,32],[64,42,61,32,"arguments"],[64,51,61,32],[64,59,61,32,"undefined"],[64,68,61,32],[64,71,61,32,"arguments"],[64,80,61,32],[64,86,61,25],[64,87,61,26],[64,88,61,27],[65,8,61,13,"matchId"],[65,15,61,20],[65,18,61,20,"_ref2"],[65,23,61,20],[65,24,61,13,"matchId"],[65,31,61,20],[66,6,62,6,"setFeedbackOpen"],[66,21,62,21],[66,22,62,22],[66,27,62,27],[66,28,62,28],[67,6,63,6,"setActiveFeedback"],[67,23,63,23],[67,24,63,24],[67,28,63,28],[67,29,63,29],[68,6,65,6],[68,10,65,10],[69,8,66,8],[69,12,66,12,"Number"],[69,18,66,18],[69,19,66,19,"isFinite"],[69,27,66,27],[69,28,66,28,"Number"],[69,34,66,34],[69,35,66,35,"matchId"],[69,42,66,42],[69,43,66,43],[69,44,66,44],[69,46,66,46],[70,10,67,10,"queryClient"],[70,21,67,21],[70,22,67,22,"setQueryData"],[70,34,67,34],[70,35,67,35,"pendingKey"],[70,45,67,45],[70,47,67,48,"old"],[70,50,67,51],[70,54,67,56],[71,12,68,12],[71,16,68,18,"oldPending"],[71,26,68,28],[71,29,68,31,"Array"],[71,34,68,36],[71,35,68,37,"isArray"],[71,42,68,44],[71,43,68,45,"old"],[71,46,68,48],[71,48,68,50,"pending"],[71,55,68,57],[71,56,68,58],[71,59,68,61,"old"],[71,62,68,64],[71,63,68,65,"pending"],[71,70,68,72],[71,73,68,75],[71,75,68,77],[72,12,69,12],[72,19,69,19],[73,14,70,14,"pending"],[73,21,70,21],[73,23,70,23,"oldPending"],[73,33,70,33],[73,34,70,34,"filter"],[73,40,70,40],[73,41,71,17,"p"],[73,42,71,18],[73,46,71,23,"Number"],[73,52,71,29],[73,53,71,30,"p"],[73,54,71,31],[73,56,71,33,"matchId"],[73,63,71,40],[73,64,71,41],[73,69,71,46,"Number"],[73,75,71,52],[73,76,71,53,"matchId"],[73,83,71,60],[73,84,72,14],[74,12,73,12],[74,13,73,13],[75,10,74,10],[75,11,74,11],[75,12,74,12],[76,8,75,8],[77,6,76,6],[77,7,76,7],[77,8,76,8],[77,15,76,15,"e"],[77,16,76,16],[77,18,76,18],[78,8,77,8,"console"],[78,15,77,15],[78,16,77,16,"error"],[78,21,77,21],[78,22,77,22,"e"],[78,23,77,23],[78,24,77,24],[79,6,78,6],[80,6,80,6],[80,10,80,10],[81,8,81,8],[81,12,81,14,"result"],[81,18,81,20],[81,27,81,29,"pendingFeedbackQuery"],[81,47,81,49],[81,48,81,50,"refetch"],[81,55,81,57],[81,56,81,58],[81,57,81,59],[82,8,82,8],[82,12,82,14,"pending"],[82,19,82,21],[82,22,82,24,"result"],[82,28,82,30],[82,30,82,32,"data"],[82,34,82,36],[82,36,82,38,"pending"],[82,43,82,45],[82,47,82,49],[82,49,82,51],[83,8,83,8],[83,12,83,12,"pending"],[83,19,83,19],[83,20,83,20,"length"],[83,26,83,26],[83,29,83,29],[83,30,83,30],[83,32,83,32],[84,10,84,10,"setActiveFeedback"],[84,27,84,27],[84,28,84,28,"pending"],[84,35,84,35],[84,36,84,36],[84,37,84,37],[84,38,84,38],[84,39,84,39],[85,10,85,10,"setFeedbackOpen"],[85,25,85,25],[85,26,85,26],[85,30,85,30],[85,31,85,31],[86,8,86,8],[87,6,87,6],[87,7,87,7],[87,8,87,8],[87,15,87,15,"e"],[87,16,87,16],[87,18,87,18],[88,8,88,8,"console"],[88,15,88,15],[88,16,88,16,"error"],[88,21,88,21],[88,22,88,22,"e"],[88,23,88,23],[88,24,88,24],[89,6,89,6],[90,4,90,4],[90,5,90,5],[90,8,91,4],[90,9,91,5,"pendingFeedbackQuery"],[90,29,91,25],[90,31,91,27,"pendingKey"],[90,41,91,37],[90,43,91,39,"queryClient"],[90,54,91,50],[90,55,92,2],[90,56,92,3],[91,4,94,2],[91,11,94,9],[92,6,95,4,"feedbackOpen"],[92,18,95,16],[93,6,96,4,"activeFeedback"],[93,20,96,18],[94,6,97,4,"handleFeedbackSubmitted"],[95,4,98,2],[95,5,98,3],[96,2,99,0],[97,2,99,1,"_s"],[97,4,99,1],[97,5,6,16,"useMessagesFeedback"],[97,24,6,35],[98,4,6,35],[98,12,9,22,"useQueryClient"],[98,31,9,36],[98,32,9,36,"useQueryClient"],[98,46,9,36],[98,48,16,31,"usePendingDateFeedback"],[98,76,16,53],[98,77,16,53,"usePendingDateFeedback"],[98,99,16,53],[98,101,42,2,"useFocusEffect"],[98,123,42,16],[98,124,42,16,"useFocusEffect"],[98,138,42,16],[99,2,42,16],[100,0,42,16],[100,3]],"functionMap":{"names":["<global>","useMessagesFeedback","useMemo$argument_0","maybeOpenFeedbackPrompt","useEffect$argument_0","useFocusEffect$argument_0","pendingFeedbackQuery.refetch.then$argument_0","pendingFeedbackQuery.refetch.then._catch$argument_0","handleFeedbackSubmitted","queryClient.setQueryData$argument_1","oldPending.filter$argument_0"],"mappings":"AAA;OCK;6BCK;GDG;IEK;KFO;YGI;GHK;gBIQ;cCO;SDG;eEC;SFE;KJC;IOI;+CCM;gBCI,6CD;WDG;KPgB;CDS"},"hasCjsExports":false},"type":"js/module"}]}