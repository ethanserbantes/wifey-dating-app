{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":99,"index":99}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}},{"name":"../types.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":100},"end":{"line":2,"column":37,"index":137}}],"key":"8cLkkKYebhz8179+ortY3/pylDg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"addHistoryInstrumentationHandler\", {\n    enumerable: true,\n    get: function () {\n      return addHistoryInstrumentationHandler;\n    }\n  });\n  Object.defineProperty(exports, \"instrumentHistory\", {\n    enumerable: true,\n    get: function () {\n      return instrumentHistory;\n    }\n  });\n  var _sentryCore = require(_dependencyMap[0]);\n  var _typesJs = require(_dependencyMap[1]);\n  var lastHref;\n\n  /**\n   * Add an instrumentation handler for when a fetch request happens.\n   * The handler function is called once when the request starts and once when it ends,\n   * which can be identified by checking if it has an `endTimestamp`.\n   *\n   * Use at your own risk, this might break without changelog notice, only used internally.\n   * @hidden\n   */\n  function addHistoryInstrumentationHandler(handler) {\n    var type = 'history';\n    (0, _sentryCore.addHandler)(type, handler);\n    (0, _sentryCore.maybeInstrument)(type, instrumentHistory);\n  }\n\n  /**\n   * Exported just for testing\n   */\n  function instrumentHistory() {\n    // The `popstate` event may also be triggered on `pushState`, but it may not always reliably be emitted by the browser\n    // Which is why we also monkey-patch methods below, in addition to this\n    _typesJs.WINDOW.addEventListener('popstate', () => {\n      var to = _typesJs.WINDOW.location.href;\n      // keep track of the current URL state, as we always receive only the updated state\n      var from = lastHref;\n      lastHref = to;\n      if (from === to) {\n        return;\n      }\n      var handlerData = {\n        from,\n        to\n      };\n      (0, _sentryCore.triggerHandlers)('history', handlerData);\n    });\n\n    // Just guard against this not being available, in weird environments\n    if (!(0, _sentryCore.supportsHistory)()) {\n      return;\n    }\n    function historyReplacementFunction(originalHistoryFunction) {\n      return function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n        var url = args.length > 2 ? args[2] : undefined;\n        if (url) {\n          var from = lastHref;\n\n          // Ensure the URL is absolute\n          // this can be either a path, then it is relative to the current origin\n          // or a full URL of the current origin - other origins are not allowed\n          // See: https://developer.mozilla.org/en-US/docs/Web/API/History/pushState#url\n          // coerce to string (this is what pushState does)\n          var to = getAbsoluteUrl(String(url));\n\n          // keep track of the current URL state, as we always receive only the updated state\n          lastHref = to;\n          if (from === to) {\n            return originalHistoryFunction.apply(this, args);\n          }\n          var handlerData = {\n            from,\n            to\n          };\n          (0, _sentryCore.triggerHandlers)('history', handlerData);\n        }\n        return originalHistoryFunction.apply(this, args);\n      };\n    }\n    (0, _sentryCore.fill)(_typesJs.WINDOW.history, 'pushState', historyReplacementFunction);\n    (0, _sentryCore.fill)(_typesJs.WINDOW.history, 'replaceState', historyReplacementFunction);\n  }\n  function getAbsoluteUrl(urlOrPath) {\n    try {\n      var url = new URL(urlOrPath, _typesJs.WINDOW.location.origin);\n      return url.toString();\n    } catch {\n      // fallback, just do nothing\n      return urlOrPath;\n    }\n  }\n});","lineCount":104,"map":[[7,2,86,0,"Object"],[7,8,86,0],[7,9,86,0,"defineProperty"],[7,23,86,0],[7,24,86,0,"exports"],[7,31,86,0],[8,4,86,0,"enumerable"],[8,14,86,0],[9,4,86,0,"get"],[9,7,86,0],[9,18,86,0,"get"],[9,19,86,0],[10,6,86,0],[10,13,86,9,"addHistoryInstrumentationHandler"],[10,45,86,41],[11,4,86,41],[12,2,86,41],[13,2,86,0,"Object"],[13,8,86,0],[13,9,86,0,"defineProperty"],[13,23,86,0],[13,24,86,0,"exports"],[13,31,86,0],[14,4,86,0,"enumerable"],[14,14,86,0],[15,4,86,0,"get"],[15,7,86,0],[15,18,86,0,"get"],[15,19,86,0],[16,6,86,0],[16,13,86,43,"instrumentHistory"],[16,30,86,60],[17,4,86,60],[18,2,86,60],[19,2,1,0],[19,6,1,0,"_sentryCore"],[19,17,1,0],[19,20,1,0,"require"],[19,27,1,0],[19,28,1,0,"_dependencyMap"],[19,42,1,0],[20,2,2,0],[20,6,2,0,"_typesJs"],[20,14,2,0],[20,17,2,0,"require"],[20,24,2,0],[20,25,2,0,"_dependencyMap"],[20,39,2,0],[21,2,4,0],[21,6,4,4,"lastHref"],[21,14,4,12],[23,2,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,2,14,0],[31,11,14,9,"addHistoryInstrumentationHandler"],[31,43,14,41,"addHistoryInstrumentationHandler"],[31,44,14,42,"handler"],[31,51,14,49],[31,53,14,51],[32,4,15,2],[32,8,15,8,"type"],[32,12,15,12],[32,15,15,15],[32,24,15,24],[33,4,16,2],[33,8,16,2,"addHandler"],[33,19,16,12],[33,20,16,12,"addHandler"],[33,30,16,12],[33,32,16,13,"type"],[33,36,16,17],[33,38,16,19,"handler"],[33,45,16,26],[33,46,16,27],[34,4,17,2],[34,8,17,2,"maybeInstrument"],[34,19,17,17],[34,20,17,17,"maybeInstrument"],[34,35,17,17],[34,37,17,18,"type"],[34,41,17,22],[34,43,17,24,"instrumentHistory"],[34,60,17,41],[34,61,17,42],[35,2,18,0],[37,2,20,0],[38,0,21,0],[39,0,22,0],[40,2,23,0],[40,11,23,9,"instrumentHistory"],[40,28,23,26,"instrumentHistory"],[40,29,23,26],[40,31,23,29],[41,4,24,2],[42,4,25,2],[43,4,26,2,"WINDOW"],[43,12,26,8],[43,13,26,8,"WINDOW"],[43,19,26,8],[43,20,26,9,"addEventListener"],[43,36,26,25],[43,37,26,26],[43,47,26,36],[43,49,26,38],[43,55,26,44],[44,6,27,4],[44,10,27,10,"to"],[44,12,27,12],[44,15,27,15,"WINDOW"],[44,23,27,21],[44,24,27,21,"WINDOW"],[44,30,27,21],[44,31,27,22,"location"],[44,39,27,30],[44,40,27,31,"href"],[44,44,27,35],[45,6,28,4],[46,6,29,4],[46,10,29,10,"from"],[46,14,29,14],[46,17,29,17,"lastHref"],[46,25,29,25],[47,6,30,4,"lastHref"],[47,14,30,12],[47,17,30,15,"to"],[47,19,30,17],[48,6,32,4],[48,10,32,8,"from"],[48,14,32,12],[48,19,32,17,"to"],[48,21,32,19],[48,23,32,21],[49,8,33,6],[50,6,34,4],[51,6,36,4],[51,10,36,10,"handlerData"],[51,21,36,21],[51,24,36,24],[52,8,36,26,"from"],[52,12,36,30],[53,8,36,32,"to"],[54,6,36,35],[54,7,36,36],[55,6,37,4],[55,10,37,4,"triggerHandlers"],[55,21,37,19],[55,22,37,19,"triggerHandlers"],[55,37,37,19],[55,39,37,20],[55,48,37,29],[55,50,37,31,"handlerData"],[55,61,37,42],[55,62,37,43],[56,4,38,2],[56,5,38,3],[56,6,38,4],[58,4,40,2],[59,4,41,2],[59,8,41,6],[59,9,41,7],[59,13,41,7,"supportsHistory"],[59,24,41,22],[59,25,41,22,"supportsHistory"],[59,40,41,22],[59,42,41,23],[59,43,41,24],[59,45,41,26],[60,6,42,4],[61,4,43,2],[62,4,45,2],[62,13,45,11,"historyReplacementFunction"],[62,39,45,37,"historyReplacementFunction"],[62,40,45,38,"originalHistoryFunction"],[62,63,45,61],[62,65,45,63],[63,6,46,4],[63,13,46,11],[63,25,46,31],[64,8,46,31],[64,17,46,31,"_len"],[64,21,46,31],[64,24,46,31,"arguments"],[64,33,46,31],[64,34,46,31,"length"],[64,40,46,31],[64,42,46,25,"args"],[64,46,46,29],[64,53,46,29,"Array"],[64,58,46,29],[64,59,46,29,"_len"],[64,63,46,29],[64,66,46,29,"_key"],[64,70,46,29],[64,76,46,29,"_key"],[64,80,46,29],[64,83,46,29,"_len"],[64,87,46,29],[64,89,46,29,"_key"],[64,93,46,29],[65,10,46,25,"args"],[65,14,46,29],[65,15,46,29,"_key"],[65,19,46,29],[65,23,46,29,"arguments"],[65,32,46,29],[65,33,46,29,"_key"],[65,37,46,29],[66,8,46,29],[67,8,47,6],[67,12,47,12,"url"],[67,15,47,15],[67,18,47,18,"args"],[67,22,47,22],[67,23,47,23,"length"],[67,29,47,29],[67,32,47,32],[67,33,47,33],[67,36,47,36,"args"],[67,40,47,40],[67,41,47,41],[67,42,47,42],[67,43,47,43],[67,46,47,46,"undefined"],[67,55,47,55],[68,8,48,6],[68,12,48,10,"url"],[68,15,48,13],[68,17,48,15],[69,10,49,8],[69,14,49,14,"from"],[69,18,49,18],[69,21,49,21,"lastHref"],[69,29,49,29],[71,10,51,8],[72,10,52,8],[73,10,53,8],[74,10,54,8],[75,10,55,8],[76,10,56,8],[76,14,56,14,"to"],[76,16,56,16],[76,19,56,19,"getAbsoluteUrl"],[76,33,56,33],[76,34,56,34,"String"],[76,40,56,40],[76,41,56,41,"url"],[76,44,56,44],[76,45,56,45],[76,46,56,46],[78,10,58,8],[79,10,59,8,"lastHref"],[79,18,59,16],[79,21,59,19,"to"],[79,23,59,21],[80,10,61,8],[80,14,61,12,"from"],[80,18,61,16],[80,23,61,21,"to"],[80,25,61,23],[80,27,61,25],[81,12,62,10],[81,19,62,17,"originalHistoryFunction"],[81,42,62,40],[81,43,62,41,"apply"],[81,48,62,46],[81,49,62,47],[81,53,62,51],[81,55,62,53,"args"],[81,59,62,57],[81,60,62,58],[82,10,63,8],[83,10,65,8],[83,14,65,14,"handlerData"],[83,25,65,25],[83,28,65,28],[84,12,65,30,"from"],[84,16,65,34],[85,12,65,36,"to"],[86,10,65,39],[86,11,65,40],[87,10,66,8],[87,14,66,8,"triggerHandlers"],[87,25,66,23],[87,26,66,23,"triggerHandlers"],[87,41,66,23],[87,43,66,24],[87,52,66,33],[87,54,66,35,"handlerData"],[87,65,66,46],[87,66,66,47],[88,8,67,6],[89,8,68,6],[89,15,68,13,"originalHistoryFunction"],[89,38,68,36],[89,39,68,37,"apply"],[89,44,68,42],[89,45,68,43],[89,49,68,47],[89,51,68,49,"args"],[89,55,68,53],[89,56,68,54],[90,6,69,4],[90,7,69,5],[91,4,70,2],[92,4,72,2],[92,8,72,2,"fill"],[92,19,72,6],[92,20,72,6,"fill"],[92,24,72,6],[92,26,72,7,"WINDOW"],[92,34,72,13],[92,35,72,13,"WINDOW"],[92,41,72,13],[92,42,72,14,"history"],[92,49,72,21],[92,51,72,23],[92,62,72,34],[92,64,72,36,"historyReplacementFunction"],[92,90,72,62],[92,91,72,63],[93,4,73,2],[93,8,73,2,"fill"],[93,19,73,6],[93,20,73,6,"fill"],[93,24,73,6],[93,26,73,7,"WINDOW"],[93,34,73,13],[93,35,73,13,"WINDOW"],[93,41,73,13],[93,42,73,14,"history"],[93,49,73,21],[93,51,73,23],[93,65,73,37],[93,67,73,39,"historyReplacementFunction"],[93,93,73,65],[93,94,73,66],[94,2,74,0],[95,2,76,0],[95,11,76,9,"getAbsoluteUrl"],[95,25,76,23,"getAbsoluteUrl"],[95,26,76,24,"urlOrPath"],[95,35,76,33],[95,37,76,35],[96,4,77,2],[96,8,77,6],[97,6,78,4],[97,10,78,10,"url"],[97,13,78,13],[97,16,78,16],[97,20,78,20,"URL"],[97,23,78,23],[97,24,78,24,"urlOrPath"],[97,33,78,33],[97,35,78,35,"WINDOW"],[97,43,78,41],[97,44,78,41,"WINDOW"],[97,50,78,41],[97,51,78,42,"location"],[97,59,78,50],[97,60,78,51,"origin"],[97,66,78,57],[97,67,78,58],[98,6,79,4],[98,13,79,11,"url"],[98,16,79,14],[98,17,79,15,"toString"],[98,25,79,23],[98,26,79,24],[98,27,79,25],[99,4,80,2],[99,5,80,3],[99,6,80,4],[99,12,80,10],[100,6,81,4],[101,6,82,4],[101,13,82,11,"urlOrPath"],[101,22,82,20],[102,4,83,2],[103,2,84,0],[104,0,84,1],[104,3]],"functionMap":{"names":["<global>","addHistoryInstrumentationHandler","instrumentHistory","WINDOW.addEventListener$argument_1","historyReplacementFunction","<anonymous>","getAbsoluteUrl"],"mappings":"AAA;ACa;CDI;AEK;sCCG;GDY;EEO;WCC;KDuB;GFC;CFI;AME;CNQ"},"hasCjsExports":false},"type":"js/module"}]}