{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":246,"index":246}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}},{"name":"./instrument.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":247},"end":{"line":2,"column":71,"index":318}}],"key":"/faGONMhKrqQj2KSLxxwco89Hvc=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":319},"end":{"line":3,"column":63,"index":382}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"_onElementTiming\", {\n    enumerable: true,\n    get: function () {\n      return _onElementTiming;\n    }\n  });\n  Object.defineProperty(exports, \"startTrackingElementTiming\", {\n    enumerable: true,\n    get: function () {\n      return startTrackingElementTiming;\n    }\n  });\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _sentryCore = require(_dependencyMap[1], \"@sentry/core\");\n  var _instrumentJs = require(_dependencyMap[2], \"./instrument.js\");\n  var _utilsJs = require(_dependencyMap[3], \"./utils.js\");\n  // ElementTiming interface based on the W3C spec\n\n  /**\n   * Start tracking ElementTiming performance entries.\n   */\n  function startTrackingElementTiming() {\n    var performance = (0, _utilsJs.getBrowserPerformanceAPI)();\n    if (performance && (0, _sentryCore.browserPerformanceTimeOrigin)()) {\n      return (0, _instrumentJs.addPerformanceInstrumentationHandler)('element', _onElementTiming);\n    }\n    return () => undefined;\n  }\n\n  /**\n   * exported only for testing\n   */\n  var _onElementTiming = _ref => {\n    var entries = _ref.entries;\n    var activeSpan = (0, _sentryCore.getActiveSpan)();\n    var rootSpan = activeSpan ? (0, _sentryCore.getRootSpan)(activeSpan) : undefined;\n    var transactionName = rootSpan ? (0, _sentryCore.spanToJSON)(rootSpan).description : (0, _sentryCore.getCurrentScope)().getScopeData().transactionName;\n    entries.forEach(entry => {\n      var elementEntry = entry;\n\n      // Skip entries without identifier (elementtiming attribute)\n      if (!elementEntry.identifier) {\n        return;\n      }\n\n      // `name` contains the type of the element paint. Can be `'image-paint'` or `'text-paint'`.\n      // https://developer.mozilla.org/en-US/docs/Web/API/PerformanceElementTiming#instance_properties\n      var paintType = elementEntry.name;\n      var renderTime = elementEntry.renderTime;\n      var loadTime = elementEntry.loadTime;\n\n      // starting the span at:\n      // - `loadTime` if available (should be available for all \"image-paint\" entries, 0 otherwise)\n      // - `renderTime` if available (available for all entries, except 3rd party images, but these should be covered by `loadTime`, 0 otherwise)\n      // - `timestampInSeconds()` as a safeguard\n      // see https://developer.mozilla.org/en-US/docs/Web/API/PerformanceElementTiming/renderTime#cross-origin_image_render_time\n      var _ref2 = loadTime ? [(0, _utilsJs.msToSec)(loadTime), 'load-time'] : renderTime ? [(0, _utilsJs.msToSec)(renderTime), 'render-time'] : [(0, _sentryCore.timestampInSeconds)(), 'entry-emission'],\n        _ref3 = (0, _slicedToArray.default)(_ref2, 2),\n        spanStartTime = _ref3[0],\n        spanStartTimeSource = _ref3[1];\n      var duration = paintType === 'image-paint' ?\n      // for image paints, we can acually get a duration because image-paint entries also have a `loadTime`\n      // and `renderTime`. `loadTime` is the time when the image finished loading and `renderTime` is the\n      // time when the image finished rendering.\n      (0, _utilsJs.msToSec)(Math.max(0, (renderTime ?? 0) - (loadTime ?? 0))) :\n      // for `'text-paint'` entries, we can't get a duration because the `loadTime` is always zero.\n      0;\n      var attributes = {\n        [_sentryCore.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]: 'auto.ui.browser.elementtiming',\n        [_sentryCore.SEMANTIC_ATTRIBUTE_SENTRY_OP]: 'ui.elementtiming',\n        // name must be user-entered, so we can assume low cardinality\n        [_sentryCore.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]: 'component',\n        // recording the source of the span start time, as it varies depending on available data\n        'sentry.span_start_time_source': spanStartTimeSource,\n        'sentry.transaction_name': transactionName,\n        'element.id': elementEntry.id,\n        'element.type': elementEntry.element?.tagName?.toLowerCase() || 'unknown',\n        'element.size': elementEntry.naturalWidth && elementEntry.naturalHeight ? `${elementEntry.naturalWidth}x${elementEntry.naturalHeight}` : undefined,\n        'element.render_time': renderTime,\n        'element.load_time': loadTime,\n        // `url` is `0`(number) for text paints (hence we fall back to undefined)\n        'element.url': elementEntry.url || undefined,\n        'element.identifier': elementEntry.identifier,\n        'element.paint_type': paintType\n      };\n      (0, _sentryCore.startSpan)({\n        name: `element[${elementEntry.identifier}]`,\n        attributes,\n        startTime: spanStartTime,\n        onlyIfParent: true\n      }, span => {\n        span.end(spanStartTime + duration);\n      });\n    });\n  };\n});","lineCount":108,"map":[[12,2,100,0,"Object"],[12,8,100,0],[12,9,100,0,"defineProperty"],[12,23,100,0],[12,24,100,0,"exports"],[12,31,100,0],[13,4,100,0,"enumerable"],[13,14,100,0],[14,4,100,0,"get"],[14,7,100,0],[14,18,100,0,"get"],[14,19,100,0],[15,6,100,0],[15,13,100,9,"_onElementTiming"],[15,29,100,25],[16,4,100,25],[17,2,100,25],[18,2,100,0,"Object"],[18,8,100,0],[18,9,100,0,"defineProperty"],[18,23,100,0],[18,24,100,0,"exports"],[18,31,100,0],[19,4,100,0,"enumerable"],[19,14,100,0],[20,4,100,0,"get"],[20,7,100,0],[20,18,100,0,"get"],[20,19,100,0],[21,6,100,0],[21,13,100,27,"startTrackingElementTiming"],[21,39,100,53],[22,4,100,53],[23,2,100,53],[24,2,100,56],[24,6,100,56,"_babelRuntimeHelpersSlicedToArray"],[24,39,100,56],[24,42,100,56,"require"],[24,49,100,56],[24,50,100,56,"_dependencyMap"],[24,64,100,56],[25,2,100,56],[25,6,100,56,"_slicedToArray"],[25,20,100,56],[25,23,100,56,"_interopDefault"],[25,38,100,56],[25,39,100,56,"_babelRuntimeHelpersSlicedToArray"],[25,72,100,56],[26,2,1,0],[26,6,1,0,"_sentryCore"],[26,17,1,0],[26,20,1,0,"require"],[26,27,1,0],[26,28,1,0,"_dependencyMap"],[26,42,1,0],[27,2,2,0],[27,6,2,0,"_instrumentJs"],[27,19,2,0],[27,22,2,0,"require"],[27,29,2,0],[27,30,2,0,"_dependencyMap"],[27,44,2,0],[28,2,3,0],[28,6,3,0,"_utilsJs"],[28,14,3,0],[28,17,3,0,"require"],[28,24,3,0],[28,25,3,0,"_dependencyMap"],[28,39,3,0],[29,2,5,0],[31,2,7,0],[32,0,8,0],[33,0,9,0],[34,2,10,0],[34,11,10,9,"startTrackingElementTiming"],[34,37,10,35,"startTrackingElementTiming"],[34,38,10,35],[34,40,10,38],[35,4,11,2],[35,8,11,8,"performance"],[35,19,11,19],[35,22,11,22],[35,26,11,22,"getBrowserPerformanceAPI"],[35,34,11,46],[35,35,11,46,"getBrowserPerformanceAPI"],[35,59,11,46],[35,61,11,47],[35,62,11,48],[36,4,12,2],[36,8,12,6,"performance"],[36,19,12,17],[36,23,12,21],[36,27,12,21,"browserPerformanceTimeOrigin"],[36,38,12,49],[36,39,12,49,"browserPerformanceTimeOrigin"],[36,67,12,49],[36,69,12,50],[36,70,12,51],[36,72,12,53],[37,6,13,4],[37,13,13,11],[37,17,13,11,"addPerformanceInstrumentationHandler"],[37,30,13,47],[37,31,13,47,"addPerformanceInstrumentationHandler"],[37,67,13,47],[37,69,13,48],[37,78,13,57],[37,80,13,59,"_onElementTiming"],[37,96,13,75],[37,97,13,76],[38,4,14,2],[39,4,16,2],[39,11,16,9],[39,17,16,15,"undefined"],[39,26,16,24],[40,2,17,0],[42,2,19,0],[43,0,20,0],[44,0,21,0],[45,2,22,0],[45,6,22,6,"_onElementTiming"],[45,22,22,22],[45,25,22,25,"_ref"],[45,29,22,25],[45,33,22,42],[46,4,22,42],[46,8,22,28,"entries"],[46,15,22,35],[46,18,22,35,"_ref"],[46,22,22,35],[46,23,22,28,"entries"],[46,30,22,35],[47,4,23,2],[47,8,23,8,"activeSpan"],[47,18,23,18],[47,21,23,21],[47,25,23,21,"getActiveSpan"],[47,36,23,34],[47,37,23,34,"getActiveSpan"],[47,50,23,34],[47,52,23,35],[47,53,23,36],[48,4,24,2],[48,8,24,8,"rootSpan"],[48,16,24,16],[48,19,24,19,"activeSpan"],[48,29,24,29],[48,32,24,32],[48,36,24,32,"getRootSpan"],[48,47,24,43],[48,48,24,43,"getRootSpan"],[48,59,24,43],[48,61,24,44,"activeSpan"],[48,71,24,54],[48,72,24,55],[48,75,24,58,"undefined"],[48,84,24,67],[49,4,25,2],[49,8,25,8,"transactionName"],[49,23,25,23],[49,26,25,26,"rootSpan"],[49,34,25,34],[49,37,26,6],[49,41,26,6,"spanToJSON"],[49,52,26,16],[49,53,26,16,"spanToJSON"],[49,63,26,16],[49,65,26,17,"rootSpan"],[49,73,26,25],[49,74,26,26],[49,75,26,27,"description"],[49,86,26,38],[49,89,27,6],[49,93,27,6,"getCurrentScope"],[49,104,27,21],[49,105,27,21,"getCurrentScope"],[49,120,27,21],[49,122,27,22],[49,123,27,23],[49,124,27,24,"getScopeData"],[49,136,27,36],[49,137,27,37],[49,138,27,38],[49,139,27,39,"transactionName"],[49,154,27,54],[50,4,29,2,"entries"],[50,11,29,9],[50,12,29,10,"forEach"],[50,19,29,17],[50,20,29,18,"entry"],[50,25,29,23],[50,29,29,27],[51,6,30,4],[51,10,30,10,"elementEntry"],[51,22,30,22],[51,25,30,25,"entry"],[51,30,30,30],[53,6,32,4],[54,6,33,4],[54,10,33,8],[54,11,33,9,"elementEntry"],[54,23,33,21],[54,24,33,22,"identifier"],[54,34,33,32],[54,36,33,34],[55,8,34,6],[56,6,35,4],[58,6,37,4],[59,6,38,4],[60,6,39,4],[60,10,39,10,"paintType"],[60,19,39,19],[60,22,39,22,"elementEntry"],[60,34,39,34],[60,35,39,35,"name"],[60,39,39,39],[61,6,41,4],[61,10,41,10,"renderTime"],[61,20,41,20],[61,23,41,23,"elementEntry"],[61,35,41,35],[61,36,41,36,"renderTime"],[61,46,41,46],[62,6,42,4],[62,10,42,10,"loadTime"],[62,18,42,18],[62,21,42,21,"elementEntry"],[62,33,42,33],[62,34,42,34,"loadTime"],[62,42,42,42],[64,6,44,4],[65,6,45,4],[66,6,46,4],[67,6,47,4],[68,6,48,4],[69,6,49,4],[69,10,49,4,"_ref2"],[69,15,49,4],[69,18,49,49,"loadTime"],[69,26,49,57],[69,29,50,8],[69,30,50,9],[69,34,50,9,"msToSec"],[69,42,50,16],[69,43,50,16,"msToSec"],[69,50,50,16],[69,52,50,17,"loadTime"],[69,60,50,25],[69,61,50,26],[69,63,50,28],[69,74,50,39],[69,75,50,40],[69,78,51,8,"renderTime"],[69,88,51,18],[69,91,52,10],[69,92,52,11],[69,96,52,11,"msToSec"],[69,104,52,18],[69,105,52,18,"msToSec"],[69,112,52,18],[69,114,52,19,"renderTime"],[69,124,52,29],[69,125,52,30],[69,127,52,32],[69,140,52,45],[69,141,52,46],[69,144,53,10],[69,145,53,11],[69,149,53,11,"timestampInSeconds"],[69,160,53,29],[69,161,53,29,"timestampInSeconds"],[69,179,53,29],[69,181,53,30],[69,182,53,31],[69,184,53,33],[69,200,53,49],[69,201,53,50],[70,8,53,50,"_ref3"],[70,13,53,50],[70,20,53,50,"_slicedToArray"],[70,34,53,50],[70,35,53,50,"default"],[70,42,53,50],[70,44,53,50,"_ref2"],[70,49,53,50],[71,8,49,11,"spanStartTime"],[71,21,49,24],[71,24,49,24,"_ref3"],[71,29,49,24],[72,8,49,26,"spanStartTimeSource"],[72,27,49,45],[72,30,49,45,"_ref3"],[72,35,49,45],[73,6,55,4],[73,10,55,10,"duration"],[73,18,55,18],[73,21,56,6,"paintType"],[73,30,56,15],[73,35,56,20],[73,48,56,33],[74,6,57,10],[75,6,58,10],[76,6,59,10],[77,6,60,10],[77,10,60,10,"msToSec"],[77,18,60,17],[77,19,60,17,"msToSec"],[77,26,60,17],[77,28,60,18,"Math"],[77,32,60,22],[77,33,60,23,"max"],[77,36,60,26],[77,37,60,27],[77,38,60,28],[77,40,60,30],[77,41,60,31,"renderTime"],[77,51,60,41],[77,55,60,45],[77,56,60,46],[77,61,60,51,"loadTime"],[77,69,60,59],[77,73,60,63],[77,74,60,64],[77,75,60,65],[77,76,60,66],[77,77,60,67],[78,6,61,10],[79,6,62,10],[79,7,62,11],[80,6,64,4],[80,10,64,10,"attributes"],[80,20,64,20],[80,23,64,23],[81,8,65,6],[81,9,65,7,"SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN"],[81,20,65,39],[81,21,65,39,"SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN"],[81,53,65,39],[81,56,65,42],[81,87,65,73],[82,8,66,6],[82,9,66,7,"SEMANTIC_ATTRIBUTE_SENTRY_OP"],[82,20,66,35],[82,21,66,35,"SEMANTIC_ATTRIBUTE_SENTRY_OP"],[82,49,66,35],[82,52,66,38],[82,70,66,56],[83,8,67,6],[84,8,68,6],[84,9,68,7,"SEMANTIC_ATTRIBUTE_SENTRY_SOURCE"],[84,20,68,39],[84,21,68,39,"SEMANTIC_ATTRIBUTE_SENTRY_SOURCE"],[84,53,68,39],[84,56,68,42],[84,67,68,53],[85,8,69,6],[86,8,70,6],[86,39,70,37],[86,41,70,39,"spanStartTimeSource"],[86,60,70,58],[87,8,71,6],[87,33,71,31],[87,35,71,33,"transactionName"],[87,50,71,48],[88,8,72,6],[88,20,72,18],[88,22,72,20,"elementEntry"],[88,34,72,32],[88,35,72,33,"id"],[88,37,72,35],[89,8,73,6],[89,22,73,20],[89,24,73,22,"elementEntry"],[89,36,73,34],[89,37,73,35,"element"],[89,44,73,42],[89,46,73,44,"tagName"],[89,53,73,51],[89,55,73,53,"toLowerCase"],[89,66,73,64],[89,67,73,65],[89,68,73,66],[89,72,73,70],[89,81,73,79],[90,8,74,6],[90,22,74,20],[90,24,75,8,"elementEntry"],[90,36,75,20],[90,37,75,21,"naturalWidth"],[90,49,75,33],[90,53,75,37,"elementEntry"],[90,65,75,49],[90,66,75,50,"naturalHeight"],[90,79,75,63],[90,82,76,12],[90,85,76,15,"elementEntry"],[90,97,76,27],[90,98,76,28,"naturalWidth"],[90,110,76,40],[90,114,76,44,"elementEntry"],[90,126,76,56],[90,127,76,57,"naturalHeight"],[90,140,76,70],[90,142,76,72],[90,145,77,12,"undefined"],[90,154,77,21],[91,8,78,6],[91,29,78,27],[91,31,78,29,"renderTime"],[91,41,78,39],[92,8,79,6],[92,27,79,25],[92,29,79,27,"loadTime"],[92,37,79,35],[93,8,80,6],[94,8,81,6],[94,21,81,19],[94,23,81,21,"elementEntry"],[94,35,81,33],[94,36,81,34,"url"],[94,39,81,37],[94,43,81,41,"undefined"],[94,52,81,50],[95,8,82,6],[95,28,82,26],[95,30,82,28,"elementEntry"],[95,42,82,40],[95,43,82,41,"identifier"],[95,53,82,51],[96,8,83,6],[96,28,83,26],[96,30,83,28,"paintType"],[97,6,84,4],[97,7,84,5],[98,6,86,4],[98,10,86,4,"startSpan"],[98,21,86,13],[98,22,86,13,"startSpan"],[98,31,86,13],[98,33,87,6],[99,8,88,8,"name"],[99,12,88,12],[99,14,88,14],[99,25,88,25,"elementEntry"],[99,37,88,37],[99,38,88,38,"identifier"],[99,48,88,48],[99,51,88,51],[100,8,89,8,"attributes"],[100,18,89,18],[101,8,90,8,"startTime"],[101,17,90,17],[101,19,90,19,"spanStartTime"],[101,32,90,32],[102,8,91,8,"onlyIfParent"],[102,20,91,20],[102,22,91,22],[103,6,92,6],[103,7,92,7],[103,9,93,6,"span"],[103,13,93,10],[103,17,93,14],[104,8,94,8,"span"],[104,12,94,12],[104,13,94,13,"end"],[104,16,94,16],[104,17,94,17,"spanStartTime"],[104,30,94,30],[104,33,94,33,"duration"],[104,41,94,41],[104,42,94,42],[105,6,95,6],[105,7,96,4],[105,8,96,5],[106,4,97,2],[106,5,97,3],[106,6,97,4],[107,2,98,0],[107,3,98,1],[108,0,98,2],[108,3]],"functionMap":{"names":["<global>","startTrackingElementTiming","<anonymous>","_onElementTiming","entries.forEach$argument_0","startSpan$argument_1"],"mappings":"AAA;ACS;SCM,eD;CDC;yBGK;kBCO;MCgE;ODE;GDE;CHC"},"hasCjsExports":false},"type":"js/module"}]}