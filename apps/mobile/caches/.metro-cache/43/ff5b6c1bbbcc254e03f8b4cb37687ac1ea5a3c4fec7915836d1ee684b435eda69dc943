{"dependencies":[{"name":"./embed-resources","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":51,"index":51}}],"key":"an95POZLwNIAm4JRTBp3xn47LjY=","exportNames":["*"],"imports":1}},{"name":"./util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":52},"end":{"line":2,"column":54,"index":106}}],"key":"1+hZBLc/k6i18AZJ4yHV73uDZHQ=","exportNames":["*"],"imports":1}},{"name":"./dataurl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":57,"index":164}}],"key":"YDncyeQvfBgB8K+AxXbrKq6ci9c=","exportNames":["*"],"imports":1}},{"name":"./mimes","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":165},"end":{"line":4,"column":38,"index":203}}],"key":"TEIwCaAktDlIPJQVs10BNF88RAg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.embedImages = embedImages;\n  var _embedResources = require(_dependencyMap[0], \"./embed-resources\");\n  var _util = require(_dependencyMap[1], \"./util\");\n  var _dataurl = require(_dependencyMap[2], \"./dataurl\");\n  var _mimes = require(_dependencyMap[3], \"./mimes\");\n  async function embedProp(propName, node, options) {\n    var _a;\n    const propValue = (_a = node.style) === null || _a === void 0 ? void 0 : _a.getPropertyValue(propName);\n    if (propValue) {\n      const cssString = await (0, _embedResources.embedResources)(propValue, null, options);\n      node.style.setProperty(propName, cssString, node.style.getPropertyPriority(propName));\n      return true;\n    }\n    return false;\n  }\n  async function embedBackground(clonedNode, options) {\n    ;\n    (await embedProp('background', clonedNode, options)) || (await embedProp('background-image', clonedNode, options));\n    (await embedProp('mask', clonedNode, options)) || (await embedProp('-webkit-mask', clonedNode, options)) || (await embedProp('mask-image', clonedNode, options)) || (await embedProp('-webkit-mask-image', clonedNode, options));\n  }\n  async function embedImageNode(clonedNode, options) {\n    const isImageElement = (0, _util.isInstanceOfElement)(clonedNode, HTMLImageElement);\n    if (!(isImageElement && !(0, _dataurl.isDataUrl)(clonedNode.src)) && !((0, _util.isInstanceOfElement)(clonedNode, SVGImageElement) && !(0, _dataurl.isDataUrl)(clonedNode.href.baseVal))) {\n      return;\n    }\n    const url = isImageElement ? clonedNode.src : clonedNode.href.baseVal;\n    const dataURL = await (0, _dataurl.resourceToDataURL)(url, (0, _mimes.getMimeType)(url), options);\n    await new Promise((resolve, reject) => {\n      clonedNode.onload = resolve;\n      clonedNode.onerror = options.onImageErrorHandler ? (...attributes) => {\n        try {\n          resolve(options.onImageErrorHandler(...attributes));\n        } catch (error) {\n          reject(error);\n        }\n      } : reject;\n      const image = clonedNode;\n      if (image.decode) {\n        image.decode = resolve;\n      }\n      if (image.loading === 'lazy') {\n        image.loading = 'eager';\n      }\n      if (isImageElement) {\n        clonedNode.srcset = '';\n        clonedNode.src = dataURL;\n      } else {\n        clonedNode.href.baseVal = dataURL;\n      }\n    });\n  }\n  async function embedChildren(clonedNode, options) {\n    const children = (0, _util.toArray)(clonedNode.childNodes);\n    const deferreds = children.map(child => embedImages(child, options));\n    await Promise.all(deferreds).then(() => clonedNode);\n  }\n  async function embedImages(clonedNode, options) {\n    if ((0, _util.isInstanceOfElement)(clonedNode, Element)) {\n      await embedBackground(clonedNode, options);\n      await embedImageNode(clonedNode, options);\n      await embedChildren(clonedNode, options);\n    }\n  }\n});","lineCount":70,"map":[[7,2,66,0,"exports"],[7,9,66,0],[7,10,66,0,"embedImages"],[7,21,66,0],[7,24,66,0,"embedImages"],[7,35,66,0],[8,2,1,0],[8,6,1,0,"_embedResources"],[8,21,1,0],[8,24,1,0,"require"],[8,31,1,0],[8,32,1,0,"_dependencyMap"],[8,46,1,0],[9,2,2,0],[9,6,2,0,"_util"],[9,11,2,0],[9,14,2,0,"require"],[9,21,2,0],[9,22,2,0,"_dependencyMap"],[9,36,2,0],[10,2,3,0],[10,6,3,0,"_dataurl"],[10,14,3,0],[10,17,3,0,"require"],[10,24,3,0],[10,25,3,0,"_dependencyMap"],[10,39,3,0],[11,2,4,0],[11,6,4,0,"_mimes"],[11,12,4,0],[11,15,4,0,"require"],[11,22,4,0],[11,23,4,0,"_dependencyMap"],[11,37,4,0],[12,2,5,0],[12,17,5,15,"embedProp"],[12,26,5,24,"embedProp"],[12,27,5,25,"propName"],[12,35,5,33],[12,37,5,35,"node"],[12,41,5,39],[12,43,5,41,"options"],[12,50,5,48],[12,52,5,50],[13,4,6,4],[13,8,6,8,"_a"],[13,10,6,10],[14,4,7,4],[14,10,7,10,"propValue"],[14,19,7,19],[14,22,7,22],[14,23,7,23,"_a"],[14,25,7,25],[14,28,7,28,"node"],[14,32,7,32],[14,33,7,33,"style"],[14,38,7,38],[14,44,7,44],[14,48,7,48],[14,52,7,52,"_a"],[14,54,7,54],[14,59,7,59],[14,64,7,64],[14,65,7,65],[14,68,7,68],[14,73,7,73],[14,74,7,74],[14,77,7,77,"_a"],[14,79,7,79],[14,80,7,80,"getPropertyValue"],[14,96,7,96],[14,97,7,97,"propName"],[14,105,7,105],[14,106,7,106],[15,4,8,4],[15,8,8,8,"propValue"],[15,17,8,17],[15,19,8,19],[16,6,9,8],[16,12,9,14,"cssString"],[16,21,9,23],[16,24,9,26],[16,30,9,32],[16,34,9,32,"embedResources"],[16,49,9,46],[16,50,9,46,"embedResources"],[16,64,9,46],[16,66,9,47,"propValue"],[16,75,9,56],[16,77,9,58],[16,81,9,62],[16,83,9,64,"options"],[16,90,9,71],[16,91,9,72],[17,6,10,8,"node"],[17,10,10,12],[17,11,10,13,"style"],[17,16,10,18],[17,17,10,19,"setProperty"],[17,28,10,30],[17,29,10,31,"propName"],[17,37,10,39],[17,39,10,41,"cssString"],[17,48,10,50],[17,50,10,52,"node"],[17,54,10,56],[17,55,10,57,"style"],[17,60,10,62],[17,61,10,63,"getPropertyPriority"],[17,80,10,82],[17,81,10,83,"propName"],[17,89,10,91],[17,90,10,92],[17,91,10,93],[18,6,11,8],[18,13,11,15],[18,17,11,19],[19,4,12,4],[20,4,13,4],[20,11,13,11],[20,16,13,16],[21,2,14,0],[22,2,15,0],[22,17,15,15,"embedBackground"],[22,32,15,30,"embedBackground"],[22,33,15,31,"clonedNode"],[22,43,15,41],[22,45,15,43,"options"],[22,52,15,50],[22,54,15,52],[23,4,16,4],[24,4,17,4],[24,5,17,5],[24,11,17,11,"embedProp"],[24,20,17,20],[24,21,17,21],[24,33,17,33],[24,35,17,35,"clonedNode"],[24,45,17,45],[24,47,17,47,"options"],[24,54,17,54],[24,55,17,55],[24,61,18,9],[24,67,18,15,"embedProp"],[24,76,18,24],[24,77,18,25],[24,95,18,43],[24,97,18,45,"clonedNode"],[24,107,18,55],[24,109,18,57,"options"],[24,116,18,64],[24,117,18,65],[24,118,18,66],[25,4,19,4],[25,5,19,5],[25,11,19,11,"embedProp"],[25,20,19,20],[25,21,19,21],[25,27,19,27],[25,29,19,29,"clonedNode"],[25,39,19,39],[25,41,19,41,"options"],[25,48,19,48],[25,49,19,49],[25,55,20,9],[25,61,20,15,"embedProp"],[25,70,20,24],[25,71,20,25],[25,85,20,39],[25,87,20,41,"clonedNode"],[25,97,20,51],[25,99,20,53,"options"],[25,106,20,60],[25,107,20,61],[25,108,20,62],[25,113,21,9],[25,119,21,15,"embedProp"],[25,128,21,24],[25,129,21,25],[25,141,21,37],[25,143,21,39,"clonedNode"],[25,153,21,49],[25,155,21,51,"options"],[25,162,21,58],[25,163,21,59],[25,164,21,60],[25,169,22,9],[25,175,22,15,"embedProp"],[25,184,22,24],[25,185,22,25],[25,205,22,45],[25,207,22,47,"clonedNode"],[25,217,22,57],[25,219,22,59,"options"],[25,226,22,66],[25,227,22,67],[25,228,22,68],[26,2,23,0],[27,2,24,0],[27,17,24,15,"embedImageNode"],[27,31,24,29,"embedImageNode"],[27,32,24,30,"clonedNode"],[27,42,24,40],[27,44,24,42,"options"],[27,51,24,49],[27,53,24,51],[28,4,25,4],[28,10,25,10,"isImageElement"],[28,24,25,24],[28,27,25,27],[28,31,25,27,"isInstanceOfElement"],[28,36,25,46],[28,37,25,46,"isInstanceOfElement"],[28,56,25,46],[28,58,25,47,"clonedNode"],[28,68,25,57],[28,70,25,59,"HTMLImageElement"],[28,86,25,75],[28,87,25,76],[29,4,26,4],[29,8,26,8],[29,10,26,10,"isImageElement"],[29,24,26,24],[29,28,26,28],[29,29,26,29],[29,33,26,29,"isDataUrl"],[29,41,26,38],[29,42,26,38,"isDataUrl"],[29,51,26,38],[29,53,26,39,"clonedNode"],[29,63,26,49],[29,64,26,50,"src"],[29,67,26,53],[29,68,26,54],[29,69,26,55],[29,73,27,8],[29,75,27,10],[29,79,27,10,"isInstanceOfElement"],[29,84,27,29],[29,85,27,29,"isInstanceOfElement"],[29,104,27,29],[29,106,27,30,"clonedNode"],[29,116,27,40],[29,118,27,42,"SVGImageElement"],[29,133,27,57],[29,134,27,58],[29,138,28,12],[29,139,28,13],[29,143,28,13,"isDataUrl"],[29,151,28,22],[29,152,28,22,"isDataUrl"],[29,161,28,22],[29,163,28,23,"clonedNode"],[29,173,28,33],[29,174,28,34,"href"],[29,178,28,38],[29,179,28,39,"baseVal"],[29,186,28,46],[29,187,28,47],[29,188,28,48],[29,190,28,50],[30,6,29,8],[31,4,30,4],[32,4,31,4],[32,10,31,10,"url"],[32,13,31,13],[32,16,31,16,"isImageElement"],[32,30,31,30],[32,33,31,33,"clonedNode"],[32,43,31,43],[32,44,31,44,"src"],[32,47,31,47],[32,50,31,50,"clonedNode"],[32,60,31,60],[32,61,31,61,"href"],[32,65,31,65],[32,66,31,66,"baseVal"],[32,73,31,73],[33,4,32,4],[33,10,32,10,"dataURL"],[33,17,32,17],[33,20,32,20],[33,26,32,26],[33,30,32,26,"resourceToDataURL"],[33,38,32,43],[33,39,32,43,"resourceToDataURL"],[33,56,32,43],[33,58,32,44,"url"],[33,61,32,47],[33,63,32,49],[33,67,32,49,"getMimeType"],[33,73,32,60],[33,74,32,60,"getMimeType"],[33,85,32,60],[33,87,32,61,"url"],[33,90,32,64],[33,91,32,65],[33,93,32,67,"options"],[33,100,32,74],[33,101,32,75],[34,4,33,4],[34,10,33,10],[34,14,33,14,"Promise"],[34,21,33,21],[34,22,33,22],[34,23,33,23,"resolve"],[34,30,33,30],[34,32,33,32,"reject"],[34,38,33,38],[34,43,33,43],[35,6,34,8,"clonedNode"],[35,16,34,18],[35,17,34,19,"onload"],[35,23,34,25],[35,26,34,28,"resolve"],[35,33,34,35],[36,6,35,8,"clonedNode"],[36,16,35,18],[36,17,35,19,"onerror"],[36,24,35,26],[36,27,35,29,"options"],[36,34,35,36],[36,35,35,37,"onImageErrorHandler"],[36,54,35,56],[36,57,36,14],[36,58,36,15],[36,61,36,18,"attributes"],[36,71,36,28],[36,76,36,33],[37,8,37,16],[37,12,37,20],[38,10,38,20,"resolve"],[38,17,38,27],[38,18,38,28,"options"],[38,25,38,35],[38,26,38,36,"onImageErrorHandler"],[38,45,38,55],[38,46,38,56],[38,49,38,59,"attributes"],[38,59,38,69],[38,60,38,70],[38,61,38,71],[39,8,39,16],[39,9,39,17],[39,10,40,16],[39,17,40,23,"error"],[39,22,40,28],[39,24,40,30],[40,10,41,20,"reject"],[40,16,41,26],[40,17,41,27,"error"],[40,22,41,32],[40,23,41,33],[41,8,42,16],[42,6,43,12],[42,7,43,13],[42,10,44,14,"reject"],[42,16,44,20],[43,6,45,8],[43,12,45,14,"image"],[43,17,45,19],[43,20,45,22,"clonedNode"],[43,30,45,32],[44,6,46,8],[44,10,46,12,"image"],[44,15,46,17],[44,16,46,18,"decode"],[44,22,46,24],[44,24,46,26],[45,8,47,12,"image"],[45,13,47,17],[45,14,47,18,"decode"],[45,20,47,24],[45,23,47,27,"resolve"],[45,30,47,34],[46,6,48,8],[47,6,49,8],[47,10,49,12,"image"],[47,15,49,17],[47,16,49,18,"loading"],[47,23,49,25],[47,28,49,30],[47,34,49,36],[47,36,49,38],[48,8,50,12,"image"],[48,13,50,17],[48,14,50,18,"loading"],[48,21,50,25],[48,24,50,28],[48,31,50,35],[49,6,51,8],[50,6,52,8],[50,10,52,12,"isImageElement"],[50,24,52,26],[50,26,52,28],[51,8,53,12,"clonedNode"],[51,18,53,22],[51,19,53,23,"srcset"],[51,25,53,29],[51,28,53,32],[51,30,53,34],[52,8,54,12,"clonedNode"],[52,18,54,22],[52,19,54,23,"src"],[52,22,54,26],[52,25,54,29,"dataURL"],[52,32,54,36],[53,6,55,8],[53,7,55,9],[53,13,56,13],[54,8,57,12,"clonedNode"],[54,18,57,22],[54,19,57,23,"href"],[54,23,57,27],[54,24,57,28,"baseVal"],[54,31,57,35],[54,34,57,38,"dataURL"],[54,41,57,45],[55,6,58,8],[56,4,59,4],[56,5,59,5],[56,6,59,6],[57,2,60,0],[58,2,61,0],[58,17,61,15,"embedChildren"],[58,30,61,28,"embedChildren"],[58,31,61,29,"clonedNode"],[58,41,61,39],[58,43,61,41,"options"],[58,50,61,48],[58,52,61,50],[59,4,62,4],[59,10,62,10,"children"],[59,18,62,18],[59,21,62,21],[59,25,62,21,"toArray"],[59,30,62,28],[59,31,62,28,"toArray"],[59,38,62,28],[59,40,62,29,"clonedNode"],[59,50,62,39],[59,51,62,40,"childNodes"],[59,61,62,50],[59,62,62,51],[60,4,63,4],[60,10,63,10,"deferreds"],[60,19,63,19],[60,22,63,22,"children"],[60,30,63,30],[60,31,63,31,"map"],[60,34,63,34],[60,35,63,36,"child"],[60,40,63,41],[60,44,63,46,"embedImages"],[60,55,63,57],[60,56,63,58,"child"],[60,61,63,63],[60,63,63,65,"options"],[60,70,63,72],[60,71,63,73],[60,72,63,74],[61,4,64,4],[61,10,64,10,"Promise"],[61,17,64,17],[61,18,64,18,"all"],[61,21,64,21],[61,22,64,22,"deferreds"],[61,31,64,31],[61,32,64,32],[61,33,64,33,"then"],[61,37,64,37],[61,38,64,38],[61,44,64,44,"clonedNode"],[61,54,64,54],[61,55,64,55],[62,2,65,0],[63,2,66,7],[63,17,66,22,"embedImages"],[63,28,66,33,"embedImages"],[63,29,66,34,"clonedNode"],[63,39,66,44],[63,41,66,46,"options"],[63,48,66,53],[63,50,66,55],[64,4,67,4],[64,8,67,8],[64,12,67,8,"isInstanceOfElement"],[64,17,67,27],[64,18,67,27,"isInstanceOfElement"],[64,37,67,27],[64,39,67,28,"clonedNode"],[64,49,67,38],[64,51,67,40,"Element"],[64,58,67,47],[64,59,67,48],[64,61,67,50],[65,6,68,8],[65,12,68,14,"embedBackground"],[65,27,68,29],[65,28,68,30,"clonedNode"],[65,38,68,40],[65,40,68,42,"options"],[65,47,68,49],[65,48,68,50],[66,6,69,8],[66,12,69,14,"embedImageNode"],[66,26,69,28],[66,27,69,29,"clonedNode"],[66,37,69,39],[66,39,69,41,"options"],[66,46,69,48],[66,47,69,49],[67,6,70,8],[67,12,70,14,"embedChildren"],[67,25,70,27],[67,26,70,28,"clonedNode"],[67,36,70,38],[67,38,70,40,"options"],[67,45,70,47],[67,46,70,48],[68,4,71,4],[69,2,72,0],[70,0,72,1],[70,3]],"functionMap":{"names":["<global>","embedProp","embedBackground","embedImageNode","Promise$argument_0","<anonymous>","embedChildren","children.map$argument_0","Promise.all.then$argument_0","embedImages"],"mappings":"AAA;ACI;CDS;AEC;CFQ;AGC;sBCS;cCG;aDO;KDgB;CHC;AMC;mCCE,sCD;sCEC,gBF;CNC;OSC;CTM"},"hasCjsExports":false},"type":"js/module"}]}