{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":36,"index":36}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-navigation/native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":37},"end":{"line":2,"column":58,"index":95}}],"key":"yKhyWCfwa1gXEwEbMKnWHykYbZ4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useMessagesAutoRefresh = useMessagesAutoRefresh;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNavigationNative = require(_dependencyMap[1], \"@react-navigation/native\");\n  function useMessagesAutoRefresh({\n    user,\n    closedRows,\n    loadMatches,\n    markMatchesSeen,\n    refreshCredits,\n    hasCredits,\n    attemptRestoreCredits\n  }) {\n    // Refresh when returning to tab\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) return;\n\n      // Keep these cheap and non-blocking\n      markMatchesSeen(user.id);\n      loadMatches(user.id);\n      refreshCredits(user.id);\n\n      // NEW: if they're locked but they just completed a purchase,\n      // try a one-shot restore+claim here so they don't get stuck.\n      if (!hasCredits && typeof attemptRestoreCredits === \"function\") {\n        attemptRestoreCredits(user.id).catch(() => null);\n      }\n    }, [attemptRestoreCredits, hasCredits, loadMatches, markMatchesSeen, refreshCredits, user?.id]));\n\n    // Auto-refresh if we have terminal rows (so they auto-dismiss)\n    (0, _reactNavigationNative.useFocusEffect)((0, _react.useCallback)(() => {\n      if (!user?.id) return;\n      const hasTerminal = (closedRows?.length || 0) > 0;\n      if (!hasTerminal) return;\n      const id = setTimeout(() => {\n        loadMatches(user.id);\n      }, 4000);\n      return () => clearTimeout(id);\n    }, [closedRows?.length, loadMatches, user?.id]));\n  }\n});","lineCount":46,"map":[[7,2,4,0,"exports"],[7,9,4,0],[7,10,4,0,"useMessagesAutoRefresh"],[7,32,4,0],[7,35,4,0,"useMessagesAutoRefresh"],[7,57,4,0],[8,2,1,0],[8,6,1,0,"_react"],[8,12,1,0],[8,15,1,0,"require"],[8,22,1,0],[8,23,1,0,"_dependencyMap"],[8,37,1,0],[9,2,2,0],[9,6,2,0,"_reactNavigationNative"],[9,28,2,0],[9,31,2,0,"require"],[9,38,2,0],[9,39,2,0,"_dependencyMap"],[9,53,2,0],[10,2,4,7],[10,11,4,16,"useMessagesAutoRefresh"],[10,33,4,38,"useMessagesAutoRefresh"],[10,34,4,39],[11,4,5,2,"user"],[11,8,5,6],[12,4,6,2,"closedRows"],[12,14,6,12],[13,4,7,2,"loadMatches"],[13,15,7,13],[14,4,8,2,"markMatchesSeen"],[14,19,8,17],[15,4,9,2,"refreshCredits"],[15,18,9,16],[16,4,10,2,"hasCredits"],[16,14,10,12],[17,4,11,2,"attemptRestoreCredits"],[18,2,12,0],[18,3,12,1],[18,5,12,3],[19,4,13,2],[20,4,14,2],[20,8,14,2,"useFocusEffect"],[20,30,14,16],[20,31,14,16,"useFocusEffect"],[20,45,14,16],[20,47,15,4],[20,51,15,4,"useCallback"],[20,57,15,15],[20,58,15,15,"useCallback"],[20,69,15,15],[20,71,15,16],[20,77,15,22],[21,6,16,6],[21,10,16,10],[21,11,16,11,"user"],[21,15,16,15],[21,17,16,17,"id"],[21,19,16,19],[21,21,16,21],[23,6,18,6],[24,6,19,6,"markMatchesSeen"],[24,21,19,21],[24,22,19,22,"user"],[24,26,19,26],[24,27,19,27,"id"],[24,29,19,29],[24,30,19,30],[25,6,20,6,"loadMatches"],[25,17,20,17],[25,18,20,18,"user"],[25,22,20,22],[25,23,20,23,"id"],[25,25,20,25],[25,26,20,26],[26,6,21,6,"refreshCredits"],[26,20,21,20],[26,21,21,21,"user"],[26,25,21,25],[26,26,21,26,"id"],[26,28,21,28],[26,29,21,29],[28,6,23,6],[29,6,24,6],[30,6,25,6],[30,10,25,10],[30,11,25,11,"hasCredits"],[30,21,25,21],[30,25,25,25],[30,32,25,32,"attemptRestoreCredits"],[30,53,25,53],[30,58,25,58],[30,68,25,68],[30,70,25,70],[31,8,26,8,"attemptRestoreCredits"],[31,29,26,29],[31,30,26,30,"user"],[31,34,26,34],[31,35,26,35,"id"],[31,37,26,37],[31,38,26,38],[31,39,26,39,"catch"],[31,44,26,44],[31,45,26,45],[31,51,26,51],[31,55,26,55],[31,56,26,56],[32,6,27,6],[33,4,28,4],[33,5,28,5],[33,7,28,7],[33,8,29,6,"attemptRestoreCredits"],[33,29,29,27],[33,31,30,6,"hasCredits"],[33,41,30,16],[33,43,31,6,"loadMatches"],[33,54,31,17],[33,56,32,6,"markMatchesSeen"],[33,71,32,21],[33,73,33,6,"refreshCredits"],[33,87,33,20],[33,89,34,6,"user"],[33,93,34,10],[33,95,34,12,"id"],[33,97,34,14],[33,98,35,5],[33,99,36,2],[33,100,36,3],[35,4,38,2],[36,4,39,2],[36,8,39,2,"useFocusEffect"],[36,30,39,16],[36,31,39,16,"useFocusEffect"],[36,45,39,16],[36,47,40,4],[36,51,40,4,"useCallback"],[36,57,40,15],[36,58,40,15,"useCallback"],[36,69,40,15],[36,71,40,16],[36,77,40,22],[37,6,41,6],[37,10,41,10],[37,11,41,11,"user"],[37,15,41,15],[37,17,41,17,"id"],[37,19,41,19],[37,21,41,21],[38,6,42,6],[38,12,42,12,"hasTerminal"],[38,23,42,23],[38,26,42,26],[38,27,42,27,"closedRows"],[38,37,42,37],[38,39,42,39,"length"],[38,45,42,45],[38,49,42,49],[38,50,42,50],[38,54,42,54],[38,55,42,55],[39,6,43,6],[39,10,43,10],[39,11,43,11,"hasTerminal"],[39,22,43,22],[39,24,43,24],[40,6,45,6],[40,12,45,12,"id"],[40,14,45,14],[40,17,45,17,"setTimeout"],[40,27,45,27],[40,28,45,28],[40,34,45,34],[41,8,46,8,"loadMatches"],[41,19,46,19],[41,20,46,20,"user"],[41,24,46,24],[41,25,46,25,"id"],[41,27,46,27],[41,28,46,28],[42,6,47,6],[42,7,47,7],[42,9,47,9],[42,13,47,13],[42,14,47,14],[43,6,49,6],[43,13,49,13],[43,19,49,19,"clearTimeout"],[43,31,49,31],[43,32,49,32,"id"],[43,34,49,34],[43,35,49,35],[44,4,50,4],[44,5,50,5],[44,7,50,7],[44,8,50,8,"closedRows"],[44,18,50,18],[44,20,50,20,"length"],[44,26,50,26],[44,28,50,28,"loadMatches"],[44,39,50,39],[44,41,50,41,"user"],[44,45,50,45],[44,47,50,47,"id"],[44,49,50,49],[44,50,50,50],[44,51,51,2],[44,52,51,3],[45,2,52,0],[46,0,52,1],[46,3]],"functionMap":{"names":["<global>","useMessagesAutoRefresh","useFocusEffect$argument_0","attemptRestoreCredits._catch$argument_0","setTimeout$argument_0","<anonymous>"],"mappings":"AAA;OCG;gBCW;6CCW,UD;KDE;gBCY;4BEK;OFE;aGE,sBH;KDC;CDE"},"hasCjsExports":false},"type":"js/module"}]}