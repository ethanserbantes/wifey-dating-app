{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"../../utils/object.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":45,"index":45}}],"key":"RQrRGqbksOCD9OzK2x3a4ahzdIU=","exportNames":["*"],"imports":1}},{"name":"./handlers.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":46},"end":{"line":2,"column":51,"index":97}}],"key":"KucQFengibIO2FPJs66kwgxrI08=","exportNames":["*"],"imports":1}},{"name":"./transport.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":98},"end":{"line":3,"column":117,"index":215}}],"key":"EpyMzzuR/FbwDpvh9f/hZSyWf2c=","exportNames":["*"],"imports":1}},{"name":"./validation.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":216},"end":{"line":4,"column":60,"index":276}}],"key":"wSuRSTlWQJOdJulOWcNvpmeJHkU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"wrapMcpServerWithSentry\", {\n    enumerable: true,\n    get: function () {\n      return wrapMcpServerWithSentry;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _utilsObjectJs = require(_dependencyMap[1], \"../../utils/object.js\");\n  var _handlersJs = require(_dependencyMap[2], \"./handlers.js\");\n  var _transportJs = require(_dependencyMap[3], \"./transport.js\");\n  var _validationJs = require(_dependencyMap[4], \"./validation.js\");\n  /**\n   * Tracks wrapped MCP server instances to prevent double-wrapping\n   * @internal\n   */\n  var wrappedMcpServerInstances = new WeakSet();\n\n  /**\n   * Wraps a MCP Server instance from the `@modelcontextprotocol/sdk` package with Sentry instrumentation.\n   *\n   * Compatible with versions `^1.9.0` of the `@modelcontextprotocol/sdk` package.\n   * Automatically instruments transport methods and handler functions for comprehensive monitoring.\n   *\n   * @example\n   * ```typescript\n   * import * as Sentry from '@sentry/core';\n   * import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js';\n   * import { StreamableHTTPServerTransport } from '@modelcontextprotocol/sdk/server/streamableHttp.js';\n   *\n   * const server = Sentry.wrapMcpServerWithSentry(\n   *   new McpServer({ name: \"my-server\", version: \"1.0.0\" })\n   * );\n   *\n   * const transport = new StreamableHTTPServerTransport();\n   * await server.connect(transport);\n   * ```\n   *\n   * @param mcpServerInstance - MCP server instance to instrument\n   * @returns Instrumented server instance (same reference)\n   */\n  function wrapMcpServerWithSentry(mcpServerInstance) {\n    if (wrappedMcpServerInstances.has(mcpServerInstance)) {\n      return mcpServerInstance;\n    }\n    if (!(0, _validationJs.validateMcpServerInstance)(mcpServerInstance)) {\n      return mcpServerInstance;\n    }\n    var serverInstance = mcpServerInstance;\n    (0, _utilsObjectJs.fill)(serverInstance, 'connect', originalConnect => {\n      return /*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (transport) {\n          for (var _len = arguments.length, restArgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            restArgs[_key - 1] = arguments[_key];\n          }\n          var result = yield originalConnect.call(this, transport, ...restArgs);\n          (0, _transportJs.wrapTransportOnMessage)(transport);\n          (0, _transportJs.wrapTransportSend)(transport);\n          (0, _transportJs.wrapTransportOnClose)(transport);\n          (0, _transportJs.wrapTransportError)(transport);\n          return result;\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }();\n    });\n    (0, _handlersJs.wrapAllMCPHandlers)(serverInstance);\n    wrappedMcpServerInstances.add(mcpServerInstance);\n    return mcpServerInstance;\n  }\n});","lineCount":83,"map":[[12,2,69,0,"Object"],[12,8,69,0],[12,9,69,0,"defineProperty"],[12,23,69,0],[12,24,69,0,"exports"],[12,31,69,0],[13,4,69,0,"enumerable"],[13,14,69,0],[14,4,69,0,"get"],[14,7,69,0],[14,18,69,0,"get"],[14,19,69,0],[15,6,69,0],[15,13,69,9,"wrapMcpServerWithSentry"],[15,36,69,32],[16,4,69,32],[17,2,69,32],[18,2,69,35],[18,6,69,35,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,69,35],[18,45,69,35,"require"],[18,52,69,35],[18,53,69,35,"_dependencyMap"],[18,67,69,35],[19,2,69,35],[19,6,69,35,"_asyncToGenerator"],[19,23,69,35],[19,26,69,35,"_interopDefault"],[19,41,69,35],[19,42,69,35,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,69,35],[20,2,1,0],[20,6,1,0,"_utilsObjectJs"],[20,20,1,0],[20,23,1,0,"require"],[20,30,1,0],[20,31,1,0,"_dependencyMap"],[20,45,1,0],[21,2,2,0],[21,6,2,0,"_handlersJs"],[21,17,2,0],[21,20,2,0,"require"],[21,27,2,0],[21,28,2,0,"_dependencyMap"],[21,42,2,0],[22,2,3,0],[22,6,3,0,"_transportJs"],[22,18,3,0],[22,21,3,0,"require"],[22,28,3,0],[22,29,3,0,"_dependencyMap"],[22,43,3,0],[23,2,4,0],[23,6,4,0,"_validationJs"],[23,19,4,0],[23,22,4,0,"require"],[23,29,4,0],[23,30,4,0,"_dependencyMap"],[23,44,4,0],[24,2,6,0],[25,0,7,0],[26,0,8,0],[27,0,9,0],[28,2,10,0],[28,6,10,6,"wrappedMcpServerInstances"],[28,31,10,31],[28,34,10,34],[28,38,10,38,"WeakSet"],[28,45,10,45],[28,46,10,46],[28,47,10,47],[30,2,12,0],[31,0,13,0],[32,0,14,0],[33,0,15,0],[34,0,16,0],[35,0,17,0],[36,0,18,0],[37,0,19,0],[38,0,20,0],[39,0,21,0],[40,0,22,0],[41,0,23,0],[42,0,24,0],[43,0,25,0],[44,0,26,0],[45,0,27,0],[46,0,28,0],[47,0,29,0],[48,0,30,0],[49,0,31,0],[50,0,32,0],[51,0,33,0],[52,0,34,0],[53,2,35,0],[53,11,35,9,"wrapMcpServerWithSentry"],[53,34,35,32,"wrapMcpServerWithSentry"],[53,35,35,33,"mcpServerInstance"],[53,52,35,50],[53,54,35,52],[54,4,36,2],[54,8,36,6,"wrappedMcpServerInstances"],[54,33,36,31],[54,34,36,32,"has"],[54,37,36,35],[54,38,36,36,"mcpServerInstance"],[54,55,36,53],[54,56,36,54],[54,58,36,56],[55,6,37,4],[55,13,37,11,"mcpServerInstance"],[55,30,37,28],[56,4,38,2],[57,4,40,2],[57,8,40,6],[57,9,40,7],[57,13,40,7,"validateMcpServerInstance"],[57,26,40,32],[57,27,40,32,"validateMcpServerInstance"],[57,52,40,32],[57,54,40,33,"mcpServerInstance"],[57,71,40,50],[57,72,40,51],[57,74,40,53],[58,6,41,4],[58,13,41,11,"mcpServerInstance"],[58,30,41,28],[59,4,42,2],[60,4,44,2],[60,8,44,8,"serverInstance"],[60,22,44,22],[60,25,44,25,"mcpServerInstance"],[60,42,44,42],[61,4,46,2],[61,8,46,2,"fill"],[61,22,46,6],[61,23,46,6,"fill"],[61,27,46,6],[61,29,46,7,"serverInstance"],[61,43,46,21],[61,45,46,23],[61,54,46,32],[61,56,46,34,"originalConnect"],[61,71,46,49],[61,75,46,53],[62,6,47,4],[63,8,47,4],[63,12,47,4,"_ref"],[63,16,47,4],[63,23,47,4,"_asyncToGenerator"],[63,40,47,4],[63,41,47,4,"default"],[63,48,47,4],[63,50,47,11],[63,61,47,28,"transport"],[63,70,47,37],[63,72,47,52],[64,10,47,52],[64,19,47,52,"_len"],[64,23,47,52],[64,26,47,52,"arguments"],[64,35,47,52],[64,36,47,52,"length"],[64,42,47,52],[64,44,47,42,"restArgs"],[64,52,47,50],[64,59,47,50,"Array"],[64,64,47,50],[64,65,47,50,"_len"],[64,69,47,50],[64,76,47,50,"_len"],[64,80,47,50],[64,91,47,50,"_key"],[64,95,47,50],[64,101,47,50,"_key"],[64,105,47,50],[64,108,47,50,"_len"],[64,112,47,50],[64,114,47,50,"_key"],[64,118,47,50],[65,12,47,42,"restArgs"],[65,20,47,50],[65,21,47,50,"_key"],[65,25,47,50],[65,33,47,50,"arguments"],[65,42,47,50],[65,43,47,50,"_key"],[65,47,47,50],[66,10,47,50],[67,10,48,6],[67,14,48,12,"result"],[67,20,48,18],[67,29,48,28,"originalConnect"],[67,44,48,43],[67,45,48,46,"call"],[67,49,48,50],[67,50,49,8],[67,54,49,12],[67,56,50,8,"transport"],[67,65,50,17],[67,67,51,8],[67,70,51,11,"restArgs"],[67,78,52,6],[67,79,52,7],[68,10,54,6],[68,14,54,6,"wrapTransportOnMessage"],[68,26,54,28],[68,27,54,28,"wrapTransportOnMessage"],[68,49,54,28],[68,51,54,29,"transport"],[68,60,54,38],[68,61,54,39],[69,10,55,6],[69,14,55,6,"wrapTransportSend"],[69,26,55,23],[69,27,55,23,"wrapTransportSend"],[69,44,55,23],[69,46,55,24,"transport"],[69,55,55,33],[69,56,55,34],[70,10,56,6],[70,14,56,6,"wrapTransportOnClose"],[70,26,56,26],[70,27,56,26,"wrapTransportOnClose"],[70,47,56,26],[70,49,56,27,"transport"],[70,58,56,36],[70,59,56,37],[71,10,57,6],[71,14,57,6,"wrapTransportError"],[71,26,57,24],[71,27,57,24,"wrapTransportError"],[71,45,57,24],[71,47,57,25,"transport"],[71,56,57,34],[71,57,57,35],[72,10,59,6],[72,17,59,13,"result"],[72,23,59,19],[73,8,60,4],[73,9,60,5],[74,8,60,5],[74,25,60,5,"_x"],[74,27,60,5],[75,10,60,5],[75,17,60,5,"_ref"],[75,21,60,5],[75,22,60,5,"apply"],[75,27,60,5],[75,34,60,5,"arguments"],[75,43,60,5],[76,8,60,5],[77,6,60,5],[78,4,61,2],[78,5,61,3],[78,6,61,4],[79,4,63,2],[79,8,63,2,"wrapAllMCPHandlers"],[79,19,63,20],[79,20,63,20,"wrapAllMCPHandlers"],[79,38,63,20],[79,40,63,21,"serverInstance"],[79,54,63,35],[79,55,63,36],[80,4,65,2,"wrappedMcpServerInstances"],[80,29,65,27],[80,30,65,28,"add"],[80,33,65,31],[80,34,65,32,"mcpServerInstance"],[80,51,65,49],[80,52,65,50],[81,4,66,2],[81,11,66,9,"mcpServerInstance"],[81,28,66,26],[82,2,67,0],[83,0,67,1],[83,3]],"functionMap":{"names":["<global>","wrapMcpServerWithSentry","fill$argument_2","<anonymous>"],"mappings":"AAA;ACkC;kCCW;WCC;KDa;GDC;CDM"},"hasCjsExports":false},"type":"js/module"}]}