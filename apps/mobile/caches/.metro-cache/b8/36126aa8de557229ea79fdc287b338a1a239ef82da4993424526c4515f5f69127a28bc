{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"./attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":334,"index":334}}],"key":"UMlNobrmssIvLA9C9D03xjrDrQE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"filterMcpPiiFromSpanData\", {\n    enumerable: true,\n    get: function () {\n      return filterMcpPiiFromSpanData;\n    }\n  });\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _attributesJs = require(_dependencyMap[1], \"./attributes.js\");\n  /**\n   * PII attributes that should be removed when sendDefaultPii is false\n   * @internal\n   */\n  var PII_ATTRIBUTES = new Set([_attributesJs.CLIENT_ADDRESS_ATTRIBUTE, _attributesJs.CLIENT_PORT_ATTRIBUTE, _attributesJs.MCP_LOGGING_MESSAGE_ATTRIBUTE, _attributesJs.MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE, _attributesJs.MCP_PROMPT_RESULT_MESSAGE_CONTENT_ATTRIBUTE, _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE, _attributesJs.MCP_TOOL_RESULT_CONTENT_ATTRIBUTE]);\n\n  /**\n   * Checks if an attribute key should be considered PII.\n   *\n   * Returns true for:\n   * - Explicit PII attributes (client.address, client.port, mcp.logging.message, etc.)\n   * - All request arguments (mcp.request.argument.*)\n   * - Tool and prompt result content (mcp.tool.result.*, mcp.prompt.result.*) except metadata\n   *\n   * Preserves metadata attributes ending with _count, _error, or .is_error as they don't contain sensitive data.\n   *\n   * @param key - Attribute key to evaluate\n   * @returns true if the attribute should be filtered out (is PII), false if it should be preserved\n   * @internal\n   */\n  function isPiiAttribute(key) {\n    if (PII_ATTRIBUTES.has(key)) {\n      return true;\n    }\n    if (key.startsWith(`${_attributesJs.MCP_REQUEST_ARGUMENT}.`)) {\n      return true;\n    }\n    if (key.startsWith(`${_attributesJs.MCP_TOOL_RESULT_PREFIX}.`) || key.startsWith(`${_attributesJs.MCP_PROMPT_RESULT_PREFIX}.`)) {\n      if (!key.endsWith('_count') && !key.endsWith('_error') && !key.endsWith('.is_error')) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Removes PII attributes from span data when sendDefaultPii is false\n   * @param spanData - Raw span attributes\n   * @param sendDefaultPii - Whether to include PII data\n   * @returns Filtered span attributes\n   */\n  function filterMcpPiiFromSpanData(spanData, sendDefaultPii) {\n    if (sendDefaultPii) {\n      return spanData;\n    }\n    return Object.entries(spanData).reduce((acc, _ref) => {\n      var _ref2 = (0, _slicedToArray.default)(_ref, 2),\n        key = _ref2[0],\n        value = _ref2[1];\n      if (!isPiiAttribute(key)) {\n        acc[key] = value;\n      }\n      return acc;\n    }, {});\n  }\n});","lineCount":76,"map":[[12,2,74,0,"Object"],[12,8,74,0],[12,9,74,0,"defineProperty"],[12,23,74,0],[12,24,74,0,"exports"],[12,31,74,0],[13,4,74,0,"enumerable"],[13,14,74,0],[14,4,74,0,"get"],[14,7,74,0],[14,18,74,0,"get"],[14,19,74,0],[15,6,74,0],[15,13,74,9,"filterMcpPiiFromSpanData"],[15,37,74,33],[16,4,74,33],[17,2,74,33],[18,2,74,36],[18,6,74,36,"_babelRuntimeHelpersSlicedToArray"],[18,39,74,36],[18,42,74,36,"require"],[18,49,74,36],[18,50,74,36,"_dependencyMap"],[18,64,74,36],[19,2,74,36],[19,6,74,36,"_slicedToArray"],[19,20,74,36],[19,23,74,36,"_interopDefault"],[19,38,74,36],[19,39,74,36,"_babelRuntimeHelpersSlicedToArray"],[19,72,74,36],[20,2,1,0],[20,6,1,0,"_attributesJs"],[20,19,1,0],[20,22,1,0,"require"],[20,29,1,0],[20,30,1,0,"_dependencyMap"],[20,44,1,0],[21,2,3,0],[22,0,4,0],[23,0,5,0],[24,0,6,0],[25,2,7,0],[25,6,7,6,"PII_ATTRIBUTES"],[25,20,7,20],[25,23,7,23],[25,27,7,27,"Set"],[25,30,7,30],[25,31,7,31],[25,32,8,2,"CLIENT_ADDRESS_ATTRIBUTE"],[25,45,8,26],[25,46,8,26,"CLIENT_ADDRESS_ATTRIBUTE"],[25,70,8,26],[25,72,9,2,"CLIENT_PORT_ATTRIBUTE"],[25,85,9,23],[25,86,9,23,"CLIENT_PORT_ATTRIBUTE"],[25,107,9,23],[25,109,10,2,"MCP_LOGGING_MESSAGE_ATTRIBUTE"],[25,122,10,31],[25,123,10,31,"MCP_LOGGING_MESSAGE_ATTRIBUTE"],[25,152,10,31],[25,154,11,2,"MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE"],[25,167,11,41],[25,168,11,41,"MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE"],[25,207,11,41],[25,209,12,2,"MCP_PROMPT_RESULT_MESSAGE_CONTENT_ATTRIBUTE"],[25,222,12,45],[25,223,12,45,"MCP_PROMPT_RESULT_MESSAGE_CONTENT_ATTRIBUTE"],[25,266,12,45],[25,268,13,2,"MCP_RESOURCE_URI_ATTRIBUTE"],[25,281,13,28],[25,282,13,28,"MCP_RESOURCE_URI_ATTRIBUTE"],[25,308,13,28],[25,310,14,2,"MCP_TOOL_RESULT_CONTENT_ATTRIBUTE"],[25,323,14,35],[25,324,14,35,"MCP_TOOL_RESULT_CONTENT_ATTRIBUTE"],[25,357,14,35],[25,358,15,1],[25,359,15,2],[27,2,17,0],[28,0,18,0],[29,0,19,0],[30,0,20,0],[31,0,21,0],[32,0,22,0],[33,0,23,0],[34,0,24,0],[35,0,25,0],[36,0,26,0],[37,0,27,0],[38,0,28,0],[39,0,29,0],[40,0,30,0],[41,2,31,0],[41,11,31,9,"isPiiAttribute"],[41,25,31,23,"isPiiAttribute"],[41,26,31,24,"key"],[41,29,31,27],[41,31,31,29],[42,4,32,2],[42,8,32,6,"PII_ATTRIBUTES"],[42,22,32,20],[42,23,32,21,"has"],[42,26,32,24],[42,27,32,25,"key"],[42,30,32,28],[42,31,32,29],[42,33,32,31],[43,6,33,4],[43,13,33,11],[43,17,33,15],[44,4,34,2],[45,4,36,2],[45,8,36,6,"key"],[45,11,36,9],[45,12,36,10,"startsWith"],[45,22,36,20],[45,23,36,21],[45,26,36,24,"MCP_REQUEST_ARGUMENT"],[45,39,36,44],[45,40,36,44,"MCP_REQUEST_ARGUMENT"],[45,60,36,44],[45,63,36,47],[45,64,36,48],[45,66,36,50],[46,6,37,4],[46,13,37,11],[46,17,37,15],[47,4,38,2],[48,4,40,2],[48,8,40,6,"key"],[48,11,40,9],[48,12,40,10,"startsWith"],[48,22,40,20],[48,23,40,21],[48,26,40,24,"MCP_TOOL_RESULT_PREFIX"],[48,39,40,46],[48,40,40,46,"MCP_TOOL_RESULT_PREFIX"],[48,62,40,46],[48,65,40,49],[48,66,40,50],[48,70,40,54,"key"],[48,73,40,57],[48,74,40,58,"startsWith"],[48,84,40,68],[48,85,40,69],[48,88,40,72,"MCP_PROMPT_RESULT_PREFIX"],[48,101,40,96],[48,102,40,96,"MCP_PROMPT_RESULT_PREFIX"],[48,126,40,96],[48,129,40,99],[48,130,40,100],[48,132,40,102],[49,6,41,4],[49,10,41,8],[49,11,41,9,"key"],[49,14,41,12],[49,15,41,13,"endsWith"],[49,23,41,21],[49,24,41,22],[49,32,41,30],[49,33,41,31],[49,37,41,35],[49,38,41,36,"key"],[49,41,41,39],[49,42,41,40,"endsWith"],[49,50,41,48],[49,51,41,49],[49,59,41,57],[49,60,41,58],[49,64,41,62],[49,65,41,63,"key"],[49,68,41,66],[49,69,41,67,"endsWith"],[49,77,41,75],[49,78,41,76],[49,89,41,87],[49,90,41,88],[49,92,41,90],[50,8,42,6],[50,15,42,13],[50,19,42,17],[51,6,43,4],[52,4,44,2],[53,4,46,2],[53,11,46,9],[53,16,46,14],[54,2,47,0],[56,2,49,0],[57,0,50,0],[58,0,51,0],[59,0,52,0],[60,0,53,0],[61,0,54,0],[62,2,55,0],[62,11,55,9,"filterMcpPiiFromSpanData"],[62,35,55,33,"filterMcpPiiFromSpanData"],[62,36,56,2,"spanData"],[62,44,56,10],[62,46,57,2,"sendDefaultPii"],[62,60,57,16],[62,62,58,2],[63,4,59,2],[63,8,59,6,"sendDefaultPii"],[63,22,59,20],[63,24,59,22],[64,6,60,4],[64,13,60,11,"spanData"],[64,21,60,19],[65,4,61,2],[66,4,63,2],[66,11,63,9,"Object"],[66,17,63,15],[66,18,63,16,"entries"],[66,25,63,23],[66,26,63,24,"spanData"],[66,34,63,32],[66,35,63,33],[66,36,63,34,"reduce"],[66,42,63,40],[66,43,64,4],[66,44,64,5,"acc"],[66,47,64,8],[66,49,64,8,"_ref"],[66,53,64,8],[66,58,64,27],[67,6,64,27],[67,10,64,27,"_ref2"],[67,15,64,27],[67,22,64,27,"_slicedToArray"],[67,36,64,27],[67,37,64,27,"default"],[67,44,64,27],[67,46,64,27,"_ref"],[67,50,64,27],[68,8,64,11,"key"],[68,11,64,14],[68,14,64,14,"_ref2"],[68,19,64,14],[69,8,64,16,"value"],[69,13,64,21],[69,16,64,21,"_ref2"],[69,21,64,21],[70,6,65,6],[70,10,65,10],[70,11,65,11,"isPiiAttribute"],[70,25,65,25],[70,26,65,26,"key"],[70,29,65,29],[70,30,65,30],[70,32,65,32],[71,8,66,8,"acc"],[71,11,66,11],[71,12,66,12,"key"],[71,15,66,15],[71,16,66,16],[71,19,66,19,"value"],[71,24,66,24],[72,6,67,6],[73,6,68,6],[73,13,68,13,"acc"],[73,16,68,16],[74,4,69,4],[74,5,69,5],[74,7,70,4],[74,8,70,5],[74,9,71,2],[74,10,71,3],[75,2,72,0],[76,0,72,1],[76,3]],"functionMap":{"names":["<global>","isPiiAttribute","filterMcpPiiFromSpanData","Object.entries.reduce$argument_0"],"mappings":"AAA;AC8B;CDgB;AEQ;ICS;KDK;CFG"},"hasCjsExports":false},"type":"js/module"}]}