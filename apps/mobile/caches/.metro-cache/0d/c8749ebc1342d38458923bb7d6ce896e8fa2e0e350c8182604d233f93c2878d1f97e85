{"dependencies":[{"name":"../../error/GraphQLError.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":60,"index":60}}],"key":"bmIpo7jOJABVILoymQcjQyoT3Bc=","exportNames":["*"],"imports":1}},{"name":"../../language/kinds.mjs","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":61},"end":{"line":2,"column":48,"index":109}}],"key":"Pst0V1b6vjNwQXmeu75q8aBhbiU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.MaxIntrospectionDepthRule = MaxIntrospectionDepthRule;\n  var _errorGraphQLErrorMjs = require(_dependencyMap[0]);\n  var _languageKindsMjs = require(_dependencyMap[1]);\n  var MAX_LISTS_DEPTH = 3;\n  function MaxIntrospectionDepthRule(context) {\n    /**\n     * Counts the depth of list fields in \"__Type\" recursively and\n     * returns `true` if the limit has been reached.\n     */\n    function checkDepth(node) {\n      var visitedFragments = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Object.create(null);\n      var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      if (node.kind === _languageKindsMjs.Kind.FRAGMENT_SPREAD) {\n        var fragmentName = node.name.value;\n        if (visitedFragments[fragmentName] === true) {\n          // Fragment cycles are handled by `NoFragmentCyclesRule`.\n          return false;\n        }\n        var fragment = context.getFragment(fragmentName);\n        if (!fragment) {\n          // Missing fragments checks are handled by `KnownFragmentNamesRule`.\n          return false;\n        } // Rather than following an immutable programming pattern which has\n        // significant memory and garbage collection overhead, we've opted to\n        // take a mutable approach for efficiency's sake. Importantly visiting a\n        // fragment twice is fine, so long as you don't do one visit inside the\n        // other.\n\n        try {\n          visitedFragments[fragmentName] = true;\n          return checkDepth(fragment, visitedFragments, depth);\n        } finally {\n          visitedFragments[fragmentName] = undefined;\n        }\n      }\n      if (node.kind === _languageKindsMjs.Kind.FIELD && (\n      // check all introspection lists\n      node.name.value === 'fields' || node.name.value === 'interfaces' || node.name.value === 'possibleTypes' || node.name.value === 'inputFields')) {\n        // eslint-disable-next-line no-param-reassign\n        depth++;\n        if (depth >= MAX_LISTS_DEPTH) {\n          return true;\n        }\n      } // handles fields and inline fragments\n\n      if ('selectionSet' in node && node.selectionSet) {\n        for (var child of node.selectionSet.selections) {\n          if (checkDepth(child, visitedFragments, depth)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n    return {\n      Field(node) {\n        if (node.name.value === '__schema' || node.name.value === '__type') {\n          if (checkDepth(node)) {\n            context.reportError(new _errorGraphQLErrorMjs.GraphQLError('Maximum introspection depth exceeded', {\n              nodes: [node]\n            }));\n            return false;\n          }\n        }\n      }\n    };\n  }\n});","lineCount":74,"map":[[7,2,4,0,"exports"],[7,9,4,0],[7,10,4,0,"MaxIntrospectionDepthRule"],[7,35,4,0],[7,38,4,0,"MaxIntrospectionDepthRule"],[7,63,4,0],[8,2,1,0],[8,6,1,0,"_errorGraphQLErrorMjs"],[8,27,1,0],[8,30,1,0,"require"],[8,37,1,0],[8,38,1,0,"_dependencyMap"],[8,52,1,0],[9,2,2,0],[9,6,2,0,"_languageKindsMjs"],[9,23,2,0],[9,26,2,0,"require"],[9,33,2,0],[9,34,2,0,"_dependencyMap"],[9,48,2,0],[10,2,3,0],[10,6,3,6,"MAX_LISTS_DEPTH"],[10,21,3,21],[10,24,3,24],[10,25,3,25],[11,2,4,7],[11,11,4,16,"MaxIntrospectionDepthRule"],[11,36,4,41,"MaxIntrospectionDepthRule"],[11,37,4,42,"context"],[11,44,4,49],[11,46,4,51],[12,4,5,2],[13,0,6,0],[14,0,7,0],[15,0,8,0],[16,4,9,2],[16,13,9,11,"checkDepth"],[16,23,9,21,"checkDepth"],[16,24,9,22,"node"],[16,28,9,26],[16,30,9,79],[17,6,9,79],[17,10,9,28,"visitedFragments"],[17,26,9,44],[17,29,9,44,"arguments"],[17,38,9,44],[17,39,9,44,"length"],[17,45,9,44],[17,53,9,44,"arguments"],[17,62,9,44],[17,70,9,44,"undefined"],[17,79,9,44],[17,82,9,44,"arguments"],[17,91,9,44],[17,97,9,47,"Object"],[17,103,9,53],[17,104,9,54,"create"],[17,110,9,60],[17,111,9,61],[17,115,9,65],[17,116,9,66],[18,6,9,66],[18,10,9,68,"depth"],[18,15,9,73],[18,18,9,73,"arguments"],[18,27,9,73],[18,28,9,73,"length"],[18,34,9,73],[18,42,9,73,"arguments"],[18,51,9,73],[18,59,9,73,"undefined"],[18,68,9,73],[18,71,9,73,"arguments"],[18,80,9,73],[18,86,9,76],[18,87,9,77],[19,6,10,4],[19,10,10,8,"node"],[19,14,10,12],[19,15,10,13,"kind"],[19,19,10,17],[19,24,10,22,"Kind"],[19,41,10,26],[19,42,10,26,"Kind"],[19,46,10,26],[19,47,10,27,"FRAGMENT_SPREAD"],[19,62,10,42],[19,64,10,44],[20,8,11,6],[20,12,11,12,"fragmentName"],[20,24,11,24],[20,27,11,27,"node"],[20,31,11,31],[20,32,11,32,"name"],[20,36,11,36],[20,37,11,37,"value"],[20,42,11,42],[21,8,13,6],[21,12,13,10,"visitedFragments"],[21,28,13,26],[21,29,13,27,"fragmentName"],[21,41,13,39],[21,42,13,40],[21,47,13,45],[21,51,13,49],[21,53,13,51],[22,10,14,8],[23,10,15,8],[23,17,15,15],[23,22,15,20],[24,8,16,6],[25,8,18,6],[25,12,18,12,"fragment"],[25,20,18,20],[25,23,18,23,"context"],[25,30,18,30],[25,31,18,31,"getFragment"],[25,42,18,42],[25,43,18,43,"fragmentName"],[25,55,18,55],[25,56,18,56],[26,8,20,6],[26,12,20,10],[26,13,20,11,"fragment"],[26,21,20,19],[26,23,20,21],[27,10,21,8],[28,10,22,8],[28,17,22,15],[28,22,22,20],[29,8,23,6],[29,9,23,7],[29,10,23,8],[30,8,24,6],[31,8,25,6],[32,8,26,6],[33,8,27,6],[35,8,29,6],[35,12,29,10],[36,10,30,8,"visitedFragments"],[36,26,30,24],[36,27,30,25,"fragmentName"],[36,39,30,37],[36,40,30,38],[36,43,30,41],[36,47,30,45],[37,10,31,8],[37,17,31,15,"checkDepth"],[37,27,31,25],[37,28,31,26,"fragment"],[37,36,31,34],[37,38,31,36,"visitedFragments"],[37,54,31,52],[37,56,31,54,"depth"],[37,61,31,59],[37,62,31,60],[38,8,32,6],[38,9,32,7],[38,18,32,16],[39,10,33,8,"visitedFragments"],[39,26,33,24],[39,27,33,25,"fragmentName"],[39,39,33,37],[39,40,33,38],[39,43,33,41,"undefined"],[39,52,33,50],[40,8,34,6],[41,6,35,4],[42,6,37,4],[42,10,38,6,"node"],[42,14,38,10],[42,15,38,11,"kind"],[42,19,38,15],[42,24,38,20,"Kind"],[42,41,38,24],[42,42,38,24,"Kind"],[42,46,38,24],[42,47,38,25,"FIELD"],[42,52,38,30],[43,6,38,34],[44,6,39,7,"node"],[44,10,39,11],[44,11,39,12,"name"],[44,15,39,16],[44,16,39,17,"value"],[44,21,39,22],[44,26,39,27],[44,34,39,35],[44,38,40,8,"node"],[44,42,40,12],[44,43,40,13,"name"],[44,47,40,17],[44,48,40,18,"value"],[44,53,40,23],[44,58,40,28],[44,70,40,40],[44,74,41,8,"node"],[44,78,41,12],[44,79,41,13,"name"],[44,83,41,17],[44,84,41,18,"value"],[44,89,41,23],[44,94,41,28],[44,109,41,43],[44,113,42,8,"node"],[44,117,42,12],[44,118,42,13,"name"],[44,122,42,17],[44,123,42,18,"value"],[44,128,42,23],[44,133,42,28],[44,146,42,41],[44,147,42,42],[44,149,43,6],[45,8,44,6],[46,8,45,6,"depth"],[46,13,45,11],[46,15,45,13],[47,8,47,6],[47,12,47,10,"depth"],[47,17,47,15],[47,21,47,19,"MAX_LISTS_DEPTH"],[47,36,47,34],[47,38,47,36],[48,10,48,8],[48,17,48,15],[48,21,48,19],[49,8,49,6],[50,6,50,4],[50,7,50,5],[50,8,50,6],[52,6,52,4],[52,10,52,8],[52,24,52,22],[52,28,52,26,"node"],[52,32,52,30],[52,36,52,34,"node"],[52,40,52,38],[52,41,52,39,"selectionSet"],[52,53,52,51],[52,55,52,53],[53,8,53,6],[53,13,53,11],[53,17,53,17,"child"],[53,22,53,22],[53,26,53,26,"node"],[53,30,53,30],[53,31,53,31,"selectionSet"],[53,43,53,43],[53,44,53,44,"selections"],[53,54,53,54],[53,56,53,56],[54,10,54,8],[54,14,54,12,"checkDepth"],[54,24,54,22],[54,25,54,23,"child"],[54,30,54,28],[54,32,54,30,"visitedFragments"],[54,48,54,46],[54,50,54,48,"depth"],[54,55,54,53],[54,56,54,54],[54,58,54,56],[55,12,55,10],[55,19,55,17],[55,23,55,21],[56,10,56,8],[57,8,57,6],[58,6,58,4],[59,6,60,4],[59,13,60,11],[59,18,60,16],[60,4,61,2],[61,4,63,2],[61,11,63,9],[62,6,64,4,"Field"],[62,11,64,9,"Field"],[62,12,64,10,"node"],[62,16,64,14],[62,18,64,16],[63,8,65,6],[63,12,65,10,"node"],[63,16,65,14],[63,17,65,15,"name"],[63,21,65,19],[63,22,65,20,"value"],[63,27,65,25],[63,32,65,30],[63,42,65,40],[63,46,65,44,"node"],[63,50,65,48],[63,51,65,49,"name"],[63,55,65,53],[63,56,65,54,"value"],[63,61,65,59],[63,66,65,64],[63,74,65,72],[63,76,65,74],[64,10,66,8],[64,14,66,12,"checkDepth"],[64,24,66,22],[64,25,66,23,"node"],[64,29,66,27],[64,30,66,28],[64,32,66,30],[65,12,67,10,"context"],[65,19,67,17],[65,20,67,18,"reportError"],[65,31,67,29],[65,32,68,12],[65,36,68,16,"GraphQLError"],[65,57,68,28],[65,58,68,28,"GraphQLError"],[65,70,68,28],[65,71,68,29],[65,109,68,67],[65,111,68,69],[66,14,69,14,"nodes"],[66,19,69,19],[66,21,69,21],[66,22,69,22,"node"],[66,26,69,26],[67,12,70,12],[67,13,70,13],[67,14,71,10],[67,15,71,11],[68,12,72,10],[68,19,72,17],[68,24,72,22],[69,10,73,8],[70,8,74,6],[71,6,75,4],[72,4,76,2],[72,5,76,3],[73,2,77,0],[74,0,77,1],[74,3]],"functionMap":{"names":["<global>","MaxIntrospectionDepthRule","checkDepth","Field"],"mappings":"AAA;OCG;ECK;GDoD;IEG;KFW;CDE"},"hasCjsExports":false},"type":"js/module"}]}